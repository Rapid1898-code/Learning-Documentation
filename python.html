<h1 id="python">PYTHON</h1>
<hr />
<h4 id="module-general-jump-to">MODULE, GENERAL <a href="#module-general">jump to...</a></h4>
<h4 id="virtualenv-jump-to">VIRTUALENV <a href="#virtualenv">jump to...</a></h4>
<h4 id="pip-jump-to">PIP <a href="#pip">jump to...</a></h4>
<h4 id="shortcuts-vscode-jump-to">SHORTCUTS VSCODE <a href="#shortcuts-vscode">jump to...</a></h4>
<h4 id="shortcuts-intellij-idea-ide-chrome-windows-jump-to">SHORTCUTS INTELLIJ IDEA IDE, CHROME, WINDOWS <a href="#shortcuts-intellij-idea-ide-chrome-windows">jump to...</a></h4>
<h4 id="operators-inputs-outputs-arguments-jump-to">OPERATORS, INPUTS, OUTPUTS, ARGUMENTS <a href="#operators-inputs-outputs-arguments">jump to...</a></h4>
<h4 id="random-secrets-jump-to">RANDOM, SECRETS <a href="#random-secrets">jump to...</a></h4>
<h4 id="string-jump-to">STRING <a href="#string">jump to...</a></h4>
<h4 id="regex-jump-to">REGEX <a href="#regex">jump to...</a></h4>
<h4 id="list-jump-to">LIST <a href="#list">jump to...</a></h4>
<h4 id="tupel-jump-to">TUPEL <a href="#tupel">jump to...</a></h4>
<h4 id="dictionary-jump-to">DICTIONARY <a href="#dictionary">jump to...</a></h4>
<h4 id="sets-jump-to">SETS <a href="#sets">jump to...</a></h4>
<h4 id="control-structures-and-iterations-jump-to">CONTROL STRUCTURES and ITERATIONS <a href="#control-structures-and-iterations">jump to...</a></h4>
<h4 id="functions-decorators-jump-to">FUNCTIONS, DECORATORS <a href="#functions-decorators">jump to...</a></h4>
<h4 id="generators-yield-jump-to">GENERATORS, YIELD <a href="#generators-yield">jump to...</a></h4>
<h4 id="lambda-map-filter-jump-to">LAMBDA, MAP, FILTER <a href="#lambda-map-filter">jump to...</a></h4>
<h4 id="classes-dataclasses-jump-to">CLASSES, DATACLASSES <a href="#classes-dataclasses">jump to...</a></h4>
<h4 id="txt-files-jump-to">TXT FILES <a href="#txt-files">jump to...</a></h4>
<h4 id="json-format-jump-to">JSON FORMAT <a href="#json-format">jump to...</a></h4>
<h4 id="xml-format-jump-to">XML FORMAT <a href="#xml-format">jump to...</a></h4>
<h4 id="urllib-jump-to">URLLIB <a href="#urllib">jump to...</a></h4>
<h4 id="module---csv-jump-to">MODULE - CSV <a href="#module---csv">jump to...</a></h4>
<h4 id="moudle---zipfile---handling-zip-files-jump-to">MOUDLE - ZIPFILE - handling ZIP files <a href="#moudle---zipfile---handling-zip-files">jump to...</a></h4>
<h4 id="module---gspread---api-for-google-sheets-jump-to">MODULE - GSPREAD - API for Google Sheets <a href="#module---gspread---api-for-google-sheets">jump to...</a></h4>
<h4 id="module---openpyxl---working-with-excel-worksheets-jump-to">MODULE - OPENPYXL - working with excel worksheets <a href="#module---openpyxl---working-with-excel-worksheets">jump to...</a></h4>
<h4 id="module---xlwings---working-on-the-fly-with-open-excel-worksheets-jump-to">MODULE - XLWINGS - working on the fly with open excel worksheets <a href="#module---xlwings---working-on-the-fly-with-open-excel-worksheets">jump to...</a></h4>
<h4 id="module---python-docx---working-with-word-docx-jump-to">MODULE - PYTHON-DOCX - working with word docx <a href="#module---python-docx---working-with-word-docx">jump to...</a></h4>
<h4 id="module---win32com---creating-worksheets-as-pdf-from-xlsx-jump-to">MODULE - WIN32COM - creating worksheets as pdf from xlsx <a href="#module---win32com---creating-worksheets-as-pdf-from-xlsx">jump to...</a></h4>
<h4 id="module---pypdf2---working-with-pdfs-jump-to">MODULE - PyPDF2 - working with pdfs <a href="#module---pypdf2---working-with-pdfs">jump to...</a></h4>
<h4 id="mysql---mariadb---heidisql-jump-to">MYSQL - MARIADB - HEIDISQL <a href="#mysql---mariadb---heidisql">jump to...</a></h4>
<h4 id="mysql---mariadb---sql-jump-to">MYSQL - MARIADB - SQL <a href="#mysql---mariadb---sql">jump to...</a></h4>
<h4 id="mysql---mysqlconnector-jump-to">MYSQL - MYSQL.CONNECTOR <a href="#mysql---mysql.connector">jump to...</a></h4>
<h4 id="sql-alchemy-jump-to">SQL ALCHEMY <a href="#sql-alchemy">jump to...</a></h4>
<h4 id="sqlite3-sql-jump-to">SQLITE3 SQL <a href="#sqlite3-sql">jump to...</a></h4>
<h4 id="modules---dates-datetime-calendar-timeit-time-sys-ctypes-jump-to">MODULES - DATES, DATETIME, CALENDAR, TIMEIT, TIME, SYS, CTYPES <a href="#modules---dates-datetime-calendar-timeit-time-sys-ctypes">jump to...</a></h4>
<h4 id="module---currencyconverter---currency-conversion-jump-to">MODULE - CURRENCYCONVERTER - currency conversion <a href="#module---currencyconverter---currency-conversion">jump to...</a></h4>
<h4 id="module---pycountry---countries-currency-language-jump-to">MODULE - PYCOUNTRY - Countries, Currency, Language <a href="#module---pycountry---countries-currency-language">jump to...</a></h4>
<h4 id="modules---smtplib-mimetext---sending-emails-jump-to">MODULES - SMTPLIB, MIMEText - sending emails <a href="#modules---smtplib-mimetext---sending-emails">jump to...</a></h4>
<h4 id="module---pathlib---interacting-with-the-operating-system-jump-to">MODULE - PATHLIB - interacting with the operating system <a href="#module---pathlib---interacting-with-the-operating-system">jump to...</a></h4>
<h4 id="module---os-shutil-filecmp-dircmp---interacting-with-the-operating-system-jump-to">MODULE - OS, SHUTIL, FILECMP, DIRCMP - interacting with the operating system <a href="#module---os-shutil-filecmp-dircmp---interacting-with-the-operating-system">jump to...</a></h4>
<h4 id="module---logging-jump-to">MODULE - LOGGING <a href="#module---logging">jump to...</a></h4>
<h4 id="module---unittest-jump-to">MODULE - UNITTEST <a href="#module---unittest">jump to...</a></h4>
<h4 id="module---dotenv---hide-environment-informations-jump-to">MODULE - DOTENV - hide environment informations <a href="#module---dotenv---hide-environment-informations">jump to...</a></h4>
<h4 id="module---collections---counter-defaultdic-jump-to">MODULE - COLLECTIONS - counter, defaultdic <a href="#module---collections---counter-defaultdic">jump to...</a></h4>
<h4 id="module---itertools---products-combinations-jump-to">MODULE - ITERTOOLS - products, combinations <a href="#module---itertools---products-combinations">jump to...</a></h4>
<h4 id="module---numpy---basis-for-different-other-modules-jump-to">MODULE - NUMPY - basis for different other modules <a href="#module---numpy---basis-for-different-other-modules">jump to...</a></h4>
<h4 id="module---pandas---analyzing-and-working-with-data-jump-to">MODULE - PANDAS - analyzing and working with data <a href="#module---pandas---analyzing-and-working-with-data">jump to...</a></h4>
<h4 id="module---matplotlib---working-with-charts-jump-to">MODULE - MATPLOTLIB - working with charts <a href="#module---matplotlib---working-with-charts">jump to...</a></h4>
<h4 id="module---selenium---browser-automatization-jump-to">MODULE - SELENIUM - browser automatization <a href="#module---selenium---browser-automatization">jump to...</a></h4>
<h4 id="module---beautiful-soap---webscraping-jump-to">MODULE - BEAUTIFUL SOAP - webscraping <a href="#module---beautiful-soap---webscraping">jump to...</a></h4>
<h4 id="module---requests---workings-with-apis-jump-to">MODULE - REQUESTS - workings with APIs <a href="#module---requests---workings-with-apis">jump to...</a></h4>
<h4 id="module---scrapy---webscraping-using-spiders-jump-to">MODULE - SCRAPY - webscraping using spiders <a href="#module---scrapy---webscraping-using-spiders">jump to...</a></h4>
<h4 id="module---pyqt---making-guis-jump-to">MODULE - PYQT - making GUIs <a href="#module---pyqt---making-guis">jump to...</a></h4>
<h4 id="module---tkinter---making-guis-jump-to">MODULE - TKINTER - making GUIs <a href="#module---tkinter---making-guis">jump to...</a></h4>
<h4 id="mouule---kivy---making-guis-jump-to">MOUULE - KIVY - making GUIs <a href="#mouule---kivy---making-guis">jump to...</a></h4>
<h4 id="module---pygame---making-games-jump-to">MODULE - PYGAME - making games <a href="#module---pygame---making-games">jump to...</a></h4>
<h4 id="module---pythoncom---make-new-formula-in-excel-with-python-function-jump-to">MODULE - PYTHONCOM - make new formula in excel with python-function <a href="#module---pythoncom---make-new-formula-in-excel-with-python-function">jump to...</a></h4>
<h4 id="module---flask-zappa-aws---making-an-api-jump-to">MODULE - FLASK, ZAPPA, AWS - making an API <a href="#module---flask-zappa-aws---making-an-api">jump to...</a></h4>
<h4 id="module---flask-heroku-gunicorn----making-an-api-jump-to">MODULE - FLASK, HEROKU, GUNICORN  - making an API <a href="#module---flask-heroku-gunicorn----making-an-api">jump to...</a></h4>
<h4 id="module---fastpi-uvicorn---making-an-api-jump-to">MODULE - FASTPI, UVICORN - making an API <a href="#module---fastpi-uvicorn---making-an-api">jump to...</a></h4>
<h4 id="module---icecream---print-for-debugging-jump-to">MODULE - ICECREAM - print for debugging <a href="#module---icecream---print-for-debugging">jump to...</a></h4>
<h4 id="module---ta-lib---technical-analysis-of-financial-market-jump-to">MODULE - TA-LIB - technical analysis of financial market <a href="#module---ta-lib---technical-analysis-of-financial-market">jump to...</a></h4>
<h4 id="module---yfinance---date-from-yahoo-finance-jump-to">MODULE - YFINANCE - date from Yahoo Finance <a href="#module---yfinance---date-from-yahoo-finance">jump to...</a></h4>
<h4 id="module---plotly---data-visualization-jump-to">MODULE - PLOTLY - data visualization <a href="#module---plotly---data-visualization">jump to...</a></h4>
<h4 id="module---django---framework-for-webdevelopment-jump-to">MODULE - DJANGO - framework for webdevelopment <a href="#module---django---framework-for-webdevelopment">jump to...</a></h4>
<h4 id="dolt---databases-like-repos-jump-to">DOLT - Databases like Repos <a href="#dolt---databases-like-repos">jump to...</a></h4>
<h4 id="pyinstaller-inno-setup-compiler---generate-python-programs-to-executables-jump-to">PYINSTALLER, INNO SETUP COMPILER - generate python programs to executables <a href="#pyinstaller-inno-setup-compiler---generate-python-programs-to-executables">jump to...</a></h4>
<h4 id="pythonanywhere---run-python-scripts-in-the-cloud-jump-to">PYTHONANYWHERE - run python scripts in the cloud <a href="#pythonanywhere---run-python-scripts-in-the-cloud">jump to...</a></h4>
<h4 id="heroku---run-python-scripts-in-the-cloud-jump-to">HEROKU - run python scripts in the cloud <a href="#heroku---run-python-scripts-in-the-cloud">jump to...</a></h4>
<hr />
<h2 id="module-general">MODULE, GENERAL</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import python module</p>
<pre><code class="language-markdown">import math
</code></pre>
<p>Import specific function of a module</p>
<pre><code class="language-markdown">from math import ceil
</code></pre>
<p>Import a module with abbreviation</p>
<pre><code class="language-markdown">import numpy as np
</code></pre>
<p>When directly called - programm is running from here</p>
<pre><code class="language-markdown">if __name__ == '__main__':
</code></pre>
<p>Check which python version is installed</p>
<pre><code class="language-markdown">python --version
</code></pre>
<p><br>Use modules / functions from other folder
(not working with eg. yahoocrawler.py and rapidtechtools.py - all modules, wether they are needed or not have to
imported in the program...)</p>
<pre><code class="language-markdown">import sys, os
sys.path.append(os.path.join('C:/', 'Users\path_to_module'))	# Create Path to module
import RapidTechTools as rtt        # Import Module RapidTechTools
</code></pre>
<hr />
<h2 id="virtualenv">VIRTUALENV</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Install virtualenv</p>
<pre><code class="language-markdown">pip install virtualenv
</code></pre>
<p>Global packages installed</p>
<pre><code class="language-markdown">pip list
</code></pre>
<p>Shows where the python-file is (Windows)</p>
<pre><code class="language-markdown">where python
</code></pre>
<p>Shows where the python-file is (Linux)</p>
<pre><code class="language-markdown">which python
</code></pre>
<p>Create new virtual environment pj1_env</p>
<pre><code class="language-markdown">virtualenv env OR python -m virtualenv env
</code></pre>
<p><br>Activate environment</p>
<pre><code class="language-markdown">venv\Scripts\activate
    when activated: pip list    #  Now only shows the installed modules for the virtual environment
    pip install package         #  Only installs in the activated virtual environment
</code></pre>
<p><br>Extracts all the modules / dependencies to a txt-file</p>
<pre><code class="language-markdown">pip freeze --local &gt; requirements.txt
</code></pre>
<p>Go back to the global environment</p>
<pre><code class="language-markdown">deactivate
</code></pre>
<p>Create new virtual env with specific python-version</p>
<pre><code class="language-markdown">virtualenv -p C:\..path to..\Python37\python.exe py37_env
</code></pre>
<p>Activate new virtual env named py37_env</p>
<pre><code class="language-markdown">py37_env\Scripts\activate
</code></pre>
<p>Shows the used python version in the virtual env</p>
<pre><code class="language-markdown">python --version
</code></pre>
<p>Install all the packages from requirements.txt</p>
<pre><code class="language-markdown">pip install -r requirements.txt
</code></pre>
<p><br>install virtual environment with specific python-version</p>
<pre><code class="language-markdown">download and install the python-version - Important: remember the path to the python.exe
create a venv with: virtualenv envName -p path\to\new_python.exe
</code></pre>
<hr />
<h2 id="pip">PIP</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>install module</p>
<pre><code class="language-markdown">pip install moduleXY
</code></pre>
<p>upgrade module</p>
<pre><code class="language-markdown">pip install moduleXY --upgrade
</code></pre>
<p>uninstall module XY</p>
<pre><code class="language-markdown">pip uninstall module XY
</code></pre>
<p>show installed modules in actual environment</p>
<pre><code class="language-markdown">pip list
</code></pre>
<p>output modules in requirements.txt</p>
<pre><code class="language-markdown">pip freeze &gt; requirements.txt
</code></pre>
<p>install modules from requirements.txt</p>
<pre><code class="language-markdown">pip install -r requirements.txt
</code></pre>
<hr />
<h2 id="shortcuts-vscode">SHORTCUTS VSCODE</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Comment / Uncomment selected lines (&quot;/&quot; on numblock) (commenting in VS Code)</p>
<pre><code class="language-markdown">Ctrl K Ctrl C
</code></pre>
<p>Comment / Uncomment selected lines (&quot;/&quot; on numblock) (commenting in VS Code)</p>
<pre><code class="language-markdown">Ctrl K Ctrl U
</code></pre>
<p>Find in File</p>
<pre><code class="language-markdown">Ctrl F
</code></pre>
<p>Search in all files</p>
<pre><code class="language-markdown">Ctrl Shift f
</code></pre>
<p>Replace in File</p>
<pre><code class="language-markdown">Ctrl H
</code></pre>
<p>Replace in Path (in all Files)</p>
<pre><code class="language-markdown">Ctrl Shift H
</code></pre>
<p>Jump to the next error</p>
<pre><code class="language-markdown">F8
</code></pre>
<p>Jump to the next error (backwards)</p>
<pre><code class="language-markdown">Shift + F8
</code></pre>
<p>Find next</p>
<pre><code class="language-markdown">F3
</code></pre>
<p>Goto line</p>
<pre><code class="language-markdown">Ctrl G
</code></pre>
<p>Copy / Duplicate lines</p>
<pre><code class="language-markdown">Shift Alt Up/Down
</code></pre>
<p>Move line</p>
<pre><code class="language-markdown">Alt Up/Down
</code></pre>
<p>Recent opened files</p>
<pre><code class="language-markdown">Ctrl E1
</code></pre>
<p>Switch windows in IDE</p>
<pre><code class="language-markdown">Ctrl K Left/Right
</code></pre>
<p>Suggestions for fix error, function informations</p>
<pre><code class="language-markdown">Alt Enter
</code></pre>
<p>Open the project windows (on the left side)</p>
<pre><code class="language-markdown">Alt 1
</code></pre>
<p>Show usage of the variable, function, class</p>
<pre><code class="language-markdown">Alt F7
</code></pre>
<p>Focus back on the editor window</p>
<pre><code class="language-markdown">Esc
</code></pre>
<p>Collapse everything</p>
<pre><code class="language-markdown">Ctrl K Ctrl 0
</code></pre>
<p>Exapnds everything</p>
<pre><code class="language-markdown">Ctrl K Ctrl J
</code></pre>
<p>Collapse block (&quot;-&quot; on numblock)</p>
<pre><code class="language-markdown">Ctrl K Ctrl L
</code></pre>
<p>Expand block (&quot;+&quot; on numblock)</p>
<pre><code class="language-markdown">Ctrl K Ctrl L
</code></pre>
<p>Select whole file</p>
<pre><code class="language-markdown">Ctrl A
</code></pre>
<p>Undo (backwards) / Redo (forwards)</p>
<pre><code class="language-markdown">Ctrl (Shift) Z
</code></pre>
<p>Select word to the beginning</p>
<pre><code class="language-markdown">Ctrl Shift Left
</code></pre>
<p>Select word to the end</p>
<pre><code class="language-markdown">Ctrl Shift Right
</code></pre>
<p>Go one word left</p>
<pre><code class="language-markdown">Ctrl Left / Right
</code></pre>
<p>Delete current line</p>
<pre><code class="language-markdown">Ctrl Shift K
</code></pre>
<p>Delete to end of word</p>
<pre><code class="language-markdown">Ctrl Del
</code></pre>
<p>Delete to beginning of word</p>
<pre><code class="language-markdown">Ctrl Background
</code></pre>
<p>Hide/Show sidebar</p>
<pre><code class="language-markdown">Ctrl B
</code></pre>
<p>Hide/Show terminal</p>
<pre><code class="language-markdown">Ctrl J
</code></pre>
<p>Show command line (eg. open a file where the name is known)</p>
<pre><code class="language-markdown">Ctrl P
</code></pre>
<p>Open the the command panel</p>
<pre><code class="language-markdown">Ctrl Shift P
</code></pre>
<p>Toggle through the open files in the editor</p>
<pre><code class="language-markdown">Ctrl TAB
</code></pre>
<p>Close File</p>
<pre><code class="language-markdown">Ctrl WARNING
</code></pre>
<p>MultiCursor - Select more cursors in rows for multiple change in rows</p>
<pre><code class="language-markdown">Ctrl Alt Up/Down (click Left)
</code></pre>
<p>MultiCursor - Select Cursor at multiple positions for the same name</p>
<pre><code class="language-markdown">Ctrl D
</code></pre>
<p>Select all occurences of this word in the document and change all with one change</p>
<pre><code class="language-markdown">Ctrl Shift L
</code></pre>
<p>Select whole word</p>
<pre><code class="language-markdown">Ctrl D
</code></pre>
<p>Jump to the function definition</p>
<pre><code class="language-markdown">Ctrl Click
</code></pre>
<p>Close Tab</p>
<pre><code class="language-markdown">Ctrl W
</code></pre>
<p>Show suggestions for the actual code function / method</p>
<pre><code class="language-markdown">Ctrl Space
</code></pre>
<hr />
<h2 id="shortcuts-intellij-idea-ide-chrome-windows">SHORTCUTS INTELLIJ IDEA IDE, CHROME, WINDOWS</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://www.shortcutfoo.com/app/dojos/intellij-idea-win/cheatsheet">https://www.shortcutfoo.com/app/dojos/intellij-idea-win/cheatsheet</a></p>
<pre><code class="language-markdown">Ctrl / 				# Comment / Uncomment selected lines (&quot;/&quot; on numblock) (commenting in VS Code)
Ctrl / 				# Comment / Uncomment selected lines (&quot;/&quot; on numblock) (commenting in VS Code)
Ctrl Alt F7 	    # Find usages
Ctrl F    		   	# Find in File
Ctrl R         	   	# Replace in File
Ctrl Shift R 		# Replace in Path (in all Files)
F2            		# Jump to the next error
F3        			# Find next
Ctrl G      		# Goto line
Ctrl D 			    # Copy / Duplicate lines
Alt Shift Down/Up 	# Move line
Ctrl E       		# Recent opened files
Ctrl TAB            # Switch windows in IDE
Ctrl (Shift) W      # Select / deselect parts of the code step by step
Alt Enter			# Suggestions for fix error, function informations
Alt 1				# Open the project windows (on the left side)
Alt F7				# Show usage of the variable, function, class
Esc					# Focus back on the editor window
Ctrl Shift -    	# Collapse everything
Ctrl Shift +        # Exapnds everything
Ctrl - 				# Collapse block (&quot;-&quot; on numblock)
Ctrl + 				# Expand block (&quot;+&quot; on numblock)
Ctrl A         		# Select whole file
Ctrl (Shift) Z 		# Undo (backwards) / Redo (forwards)
Ctrl Shift Left 	# Select word to the beginning
Ctrl Shift Right 	# Select word to the end
Ctrl Left / Right 	# Go one word left
Ctrl Y              # Delete current line
Ctrl Del            # Delete to end of word
Ctrl Backspace      # Delete to beginning of word
lorem + TAB         # Create lorem text for html-code
p&gt;lorem + TAB       # Create lorem text inside &lt;p&gt;-tags
</code></pre>
<p><br>Shortcuts Chrome
<br>https://www.makeuseof.com/tag/google-chrome-shortcuts-pdf/</p>
<pre><code class="language-markdown">F5                  # Refresh site
Ctrl Tab            # Go tab right
Ctrl Shift Tab      # Go tab left
Ctrl F5             # Clear Cache and reload page
</code></pre>
<p><br>Shortcuts Win10
<br>https://fossbytes.com/windows-keyboard-shortcuts-cheat-sheet-for-windows-10/</p>
<pre><code class="language-markdown">Alt Tab         # Focus on other window
Ctrl C          # Copy
Ctrl X          # Cut
Ctrl VALUES     # Paste
</code></pre>
<p><br>Enable pushing with ssh-key in Idea and VSCode</p>
<pre><code class="language-markdown">Enable open ssh agent: https://dev.to/aka_anoop/how-to-enable-openssh-agent-to-access-your-github-repositories-on-windows-powershell-1ab8
Run commands: https://stackoverflow.com/questions/56490194/vs-code-bitbucket-ssh-permission-denied-publickey
</code></pre>
<hr />
<h2 id="operators-inputs-outputs-arguments-pprint">OPERATORS, INPUTS, OUTPUTS, ARGUMENTS, PPRINT</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import module for math calculations</p>
<pre><code class="language-markdown">import math
</code></pre>
<p>Import module for reading arguments from the command line</p>
<pre><code class="language-markdown">import sys
</code></pre>
<p>Using some numpy functions</p>
<pre><code class="language-markdown">import statistics as stat
</code></pre>
<p>Result without Decimals (=&gt; 2)</p>
<pre><code class="language-markdown">5 // 2
</code></pre>
<p>Modulo / Rest of the division (=&gt; 1)</p>
<pre><code class="language-markdown">7 % 2
</code></pre>
<p>Assigment of several varaibles</p>
<pre><code class="language-markdown">d,e,f = 4,5,6
</code></pre>
<p>Change / swap 2 values</p>
<pre><code class="language-markdown">a,b = b,a
</code></pre>
<p>Increase value by one</p>
<pre><code class="language-markdown">a += 1
</code></pre>
<p>For better readability - &quot;_&quot; are possible using long num-values (will be ignored)</p>
<pre><code class="language-markdown">i = 1_000_000
</code></pre>
<p>Value is rounded to two decimal places ⇒ 77.23</p>
<pre><code class="language-markdown">round (77.2321, 2)
</code></pre>
<p>Conversion to String / Float / Int</p>
<pre><code class="language-markdown">str(5), float(&quot;5&quot;), int(&quot;5&quot;)
</code></pre>
<p>Outputs absolute value ⇒ 2</p>
<pre><code class="language-markdown">abs(-2)
</code></pre>
<p>Wait for pressing ENTER (or a keyboard stroke) to follow along</p>
<pre><code class="language-markdown">input(&quot;ENTER to continue&quot;)
</code></pre>
<p>Input age and change to int</p>
<pre><code class="language-markdown">int(input(&quot;Alter?&quot;))
</code></pre>
<p>Returns the type of a variable</p>
<pre><code class="language-markdown">type(var)
</code></pre>
<p>Shows all available methods and attributes for the object as list</p>
<pre><code class="language-markdown">dir(var)
</code></pre>
<p>Check if x has type format float (others: str,int,list,tuple,range,dict,set,bool)</p>
<pre><code class="language-markdown">isinstance(x,float)
</code></pre>
<p>Set var to max-value (float infinite)</p>
<pre><code class="language-markdown">x = float(&quot;inf&quot;)
</code></pre>
<p>Calculates the sqrt of the value ⇒ i3</p>
<pre><code class="language-markdown">math.sqrt(9)
</code></pre>
<p>Check if a variable exists</p>
<pre><code class="language-markdown">if &quot;myVar&quot; in locals():
</code></pre>
<p>Check for argument which is given when starting the program</p>
<pre><code class="language-markdown">sys.argv[1:].upper()
</code></pre>
<p>Print &quot;Text&quot; (with a linebreak \n at the end)</p>
<pre><code class="language-markdown">print(&quot;Text&quot;)
</code></pre>
<p>Print with end-statement (next print will be in the same line</p>
<pre><code class="language-markdown">print(&quot;Text&quot;, end=&quot;-&quot;)
</code></pre>
<p>Print text with linebreaks \n etc</p>
<pre><code class="language-markdown">print(repr(&quot;xyz\n&quot;))
</code></pre>
<p>python test.py arg1 arg2 arg3</p>
<pre><code class="language-markdown">example starting program
</code></pre>
<p>Show the arguments from the command line when starting the program eg. ['test.py', 'arg1', 'arg2', 'arg3']</p>
<pre><code class="language-markdown">str(sys.argv)
</code></pre>
<p>Len of the arguments - eg. 4 (program test.py itself and 3 arguments following)</p>
<pre><code class="language-markdown">len(sys.argv)
</code></pre>
<p>Find the minimum value ⇒ 3</p>
<pre><code class="language-markdown">min(3,5,7)
</code></pre>
<p>Find the maximum value ⇒ 7</p>
<pre><code class="language-markdown">max(3,5,7)
</code></pre>
<p>Find the mean value ⇒ 5 (with statistic-module - input must be given as list)</p>
<pre><code class="language-markdown">stat.mean([3,5,7])
</code></pre>
<p>Stop program at this point (helpful in test-situations)</p>
<pre><code class="language-markdown">exit()
</code></pre>
<p>Calculate the change from an old value to a new value in percent</p>
<pre><code class="language-markdown">(newVal-oldVal)/oldVal * 100
</code></pre>
<p>Import pretty print functionality</p>
<pre><code class="language-markdown">import pprint as pp
</code></pre>
<p>pretty print dict line by line</p>
<pre><code class="language-markdown">pp.pprint(dict)
</code></pre>
<p>pretty print with max line-length 30</p>
<pre><code class="language-markdown">pp.pprint(dict, width=30)
</code></pre>
<p>pretty print only level 1 of nested list eg. ['level1', [...]]</p>
<pre><code class="language-markdown">pp.pprint(nestedList,depth=1)
</code></pre>
<p>pretty print only level 2 of nested list eg. ['level1', ['level2', [...]]]</p>
<pre><code class="language-markdown">pp.pprint(nestedList,depth=2)
</code></pre>
<p>convert binary value to decimal</p>
<pre><code class="language-markdown">int(&quot;1010&quot;,2)
</code></pre>
<hr />
<h2 id="random-secrets">RANDOM, SECRETS</h2>
<p><a href="#python">jump to top...</a><br><br>
random: unsecure, reproducable with seeds
secret: secure, not reproducable<br>
Import random module - fast, but not very secure</p>
<pre><code class="language-markdown">import random
</code></pre>
<p>Random int number between 1 and 6 like a cube</p>
<pre><code class="language-markdown">random.randint(1,6)
</code></pre>
<p>Random float number between 1 and 3</p>
<pre><code class="language-markdown">&lt;random.uniform(1,3)&gt;
</code></pre>
<p>Random value between 0 and 1 in float format - eg. 0.16394553</p>
<pre><code class="language-markdown">random.random()
</code></pre>
<p>Random float in the range from 1 to 10</p>
<pre><code class="language-markdown">random.uniform(1,10)
</code></pre>
<p>Random value for standard deviation</p>
<pre><code class="language-markdown">random.normal(0,1)
</code></pre>
<p>Choose random entry from a list</p>
<pre><code class="language-markdown">random.choice(list)
</code></pre>
<p>Choose 3 random (unique) entries from the list</p>
<pre><code class="language-markdown">random.sample(list,3)
</code></pre>
<p>Choose 3 random entries from the list (possible to be the same)</p>
<pre><code class="language-markdown">random.choices(list,k=3)
</code></pre>
<p>Shuffle the content of a list</p>
<pre><code class="language-markdown">random.shuffle(l)
</code></pre>
<p>Can reproduce the same results (unsecure)</p>
<pre><code class="language-markdown">random.seed(1)
</code></pre>
<p>generate a random uppercase 6-char string</p>
<pre><code class="language-markdown">&quot;&quot;.join(random.choices(string.ascii_uppercase, k=6))
</code></pre>
<p>Import secrets module - for security reasons (is slower)</p>
<pre><code class="language-markdown">import secrets
</code></pre>
<p>Random int in the range from 0-10 (10 excluded)</p>
<pre><code class="language-markdown">secrets.randbelow(10)
</code></pre>
<p>Random int with 4 bits (highest possible value is 15 - 1111)</p>
<pre><code class="language-markdown">secrets.randbits(4)
</code></pre>
<p>Random choice (which is not reproducable)</p>
<pre><code class="language-markdown">secrets.choice(l)
</code></pre>
<hr />
<h2 id="string">STRING</h2>
<p><a href="#python">jump to top...</a><br><br>
ordered, immutable, text representation
s = &quot;this is a test&quot;							# Define a string
s = &quot;this \n text&quot;								# String with linebreak \n
s = &quot;this \t text&quot; 								# String with tab between the words</p>
<p><br>Define string over more lines in editor with</p>
<pre><code class="language-markdown">s = '''this \
	and this'''
</code></pre>
<p><br>first char of a string</p>
<pre><code class="language-markdown">c = s[0]
</code></pre>
<p>last char of a string</p>
<pre><code class="language-markdown">c = s[-1]
</code></pre>
<p>Insert variable in string oldest method (%s for string, %i for int, %f for float, %.2f for 2 decimals)</p>
<pre><code class="language-markdown">s = &quot;text %s bla&quot; % var
</code></pre>
<p>Insert variable in string old method (:.2f for 2 decimals)</p>
<pre><code class="language-markdown">s = &quot;text {} bla&quot;.format(var)
</code></pre>
<p>Insert variable in string new method</p>
<pre><code class="language-markdown">s = f&quot;text {var} bla&quot;
</code></pre>
<p>Multiple use</p>
<pre><code class="language-markdown">&quot;{0} like, {0} especially {0} but {1}&quot;.format(&quot;Joe&quot;, &quot;noodles&quot;)
</code></pre>
<p>Returns the index where the text is found</p>
<pre><code class="language-markdown">s.find (&quot;ist&quot;)
</code></pre>
<p>Counts the occurrence of a text</p>
<pre><code class="language-markdown">s.count (&quot;i&quot;)
</code></pre>
<p>Return all findings of the search string (&quot;/&quot;) in the other string (txt)</p>
<pre><code class="language-markdown">[n for n in range(len(txt)) if txt.find('/', n) == n]
</code></pre>
<p>Returns all indexwa as a list (needs import re)</p>
<pre><code class="language-markdown">[x.start() for x in re.finditer('ist', s)]
</code></pre>
<p>Lowercase the whole string</p>
<pre><code class="language-markdown">s = s.lower()
</code></pre>
<p>Capitalize the whole string</p>
<pre><code class="language-markdown">s = s.upper()
</code></pre>
<p>Capitalize the first char</p>
<pre><code class="language-markdown">s = s.capitalize()
</code></pre>
<p>Capitalize the first char of all words</p>
<pre><code class="language-markdown">s = s.title()
</code></pre>
<p>Check if the string is starting with char &quot;H&quot;</p>
<pre><code class="language-markdown">s.startswith(&quot;H&quot;)
</code></pre>
<p>Check if the string is ending with char &quot;H&quot;</p>
<pre><code class="language-markdown">s.endswith(&quot;H&quot;)
</code></pre>
<p>Split the words in a list</p>
<pre><code class="language-markdown">s.split()
</code></pre>
<p>', 1)[0]								              ⇒ Split till the first occurence of &quot;=&gt;&quot;</p>
<pre><code class="language-markdown">s.split('
</code></pre>
<p>Split sentences after line breaks</p>
<pre><code class="language-markdown">s.splitlines()
</code></pre>
<p>Delete all whitespaces at the beginning and the end</p>
<pre><code class="language-markdown">s = s.strip()
</code></pre>
<p>Remove all duplicate spaces in a string</p>
<pre><code class="language-markdown">s = &quot; &quot;.join(s.split())
</code></pre>
<p>Replacement of two strings</p>
<pre><code class="language-markdown">s = s.replace(&quot;e&quot;,&quot;X&quot;)
</code></pre>
<p>Replace several chars in a string</p>
<pre><code class="language-markdown">s = re.sub(&quot;[e0fi]&quot;, &quot;X&quot;, s)
</code></pre>
<p>Replace several chars in a string (get back a tupple: 1st changed string, 2nd: count of changed chars)</p>
<pre><code class="language-markdown">s = re.subn(&quot;[e0fi]&quot;, &quot;X&quot;, s)
</code></pre>
<p>TRUE if the whole string are digits</p>
<pre><code class="language-markdown">s.isdigit()
</code></pre>
<p>True if the whole string are no digits</p>
<pre><code class="language-markdown">s.isalpha()
</code></pre>
<p>TRUE if string2 is in strings1</p>
<pre><code class="language-markdown">s2 in s
</code></pre>
<p>Change string to list with all single chars</p>
<pre><code class="language-markdown">l = list(s)
</code></pre>
<p>Convert char to ASCII value</p>
<pre><code class="language-markdown">ord(char)
</code></pre>
<p>Convert ASCII value to char (eg. 65=A, 97=a)</p>
<pre><code class="language-markdown">chr(ascii)
</code></pre>
<p>Outputs hashvalue oif the string (needs import hashlib)</p>
<pre><code class="language-markdown">hashlib.md5(s).encode('utf-8')).hexdigest()
</code></pre>
<p>Execute statement in a string ⇒ hello</p>
<pre><code class="language-markdown">exec(print(&quot;hello&quot;))
</code></pre>
<p>Gives the value of an expression ⇒ 4 (dangerous - can used for sql-injections)</p>
<pre><code class="language-markdown">eval(&quot;2+2&quot;)
</code></pre>
<p>Reverse a string</p>
<pre><code class="language-markdown">my_string[::-1]
</code></pre>
<p>Print string with special characters</p>
<pre><code class="language-markdown">repr(s)
</code></pre>
<p><br>check if any string is in another string or all strings are in another string</p>
<pre><code class="language-markdown">checkString = &quot;A string is more than its parts!&quot;
checks = [&quot;more&quot;, &quot;blabla&quot;, &quot;nothing&quot;]
if any(x in checkstring for x in checks):         # check if any elems from checks is in checkstring
if all(x in checkstring for x in checks):         # check if all elems from checks is in checkstring
</code></pre>
<hr />
<h2 id="regex">REGEX</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>import regex module</p>
<pre><code class="language-markdown">import re
</code></pre>
<p>Information about regex handling</p>
<pre><code class="language-markdown">https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285
</code></pre>
<p>Find str with 4xdigits + &quot;-&quot;char + 2xdigits</p>
<pre><code class="language-markdown">pattern = re.compile(&quot;^[0-9]{4}-[0-9]{2}$&quot;)
</code></pre>
<p>Check if pattern matches - &lt;&gt; None when matches</p>
<pre><code class="language-markdown">pattern.match(s)
</code></pre>
<p>Find str with 4xdigits + &quot;-&quot;char + 2xdigits</p>
<pre><code class="language-markdown">pattern2 = re.compile(&quot;[0-9]{4}-[0-9]{2}&quot;)
</code></pre>
<p>Find str with 3 to 4 xdigits + &quot;-&quot;char + 2xdigits</p>
<pre><code class="language-markdown">pattern2 = re.compile(&quot;[0-9]{3,4}-[0-9]{2}&quot;)
</code></pre>
<p>Check with fullmatch (^ and $ not necessary) - &lt;&gt; None when matches</p>
<pre><code class="language-markdown">pattern.fullmatch(s)
</code></pre>
<p>Char &quot;.&quot; has to cherck with &quot;\n&quot; (is a wildcard letter in regex)</p>
<pre><code class="language-markdown">pattern3 = re.compile (&quot;[0-9]{1}\.[0-9]{3}&quot;)
</code></pre>
<p>Replace all digits in string with blank</p>
<pre><code class="language-markdown">re.sub(&quot;\d&quot;,&quot;&quot;,s)
</code></pre>
<p>Insert blank before every capitalized word eg. &quot;CostOfRevenue&quot; ⇒ &quot;Cost Of Revenue&quot;</p>
<pre><code class="language-markdown">re.sub(r'([a-z](?=[A-Z])|[A-Z](?=[A-Z][a-z]))', r'\1 ', &quot;txt&quot;)
</code></pre>
<p>Read string an try to match with groups<br>
Define pattern ⇒ as many digits (endless) + &quot; &quot; + one lowercase cahr + &quot;:&quot; + as many digits (endless)</p>
<pre><code class="language-markdown">pattern = &quot;([0-9]+) ([a-z]:([a-z]+)&quot;
</code></pre>
<p>Check if elem fits the pattern ⇒ returns &lt;re.Match object; span=(0, 19), match=&quot;3 n: nnnlncrnnnnn&quot;&gt;</p>
<pre><code class="language-markdown">match = re.search(pattern, elem)
</code></pre>
<p>Assign the value of the first group ⇒ 3</p>
<pre><code class="language-markdown">value = match.group(1)
</code></pre>
<p>Show the full string ⇒ &quot;3 n: nnnlncrnnnnn&quot;</p>
<pre><code class="language-markdown">all = match.group(0)
</code></pre>
<hr />
<h2 id="list">LIST</h2>
<p><a href="#python">jump to top...</a><br><br>
ordered, mutable, allows duplicate elements<br>
Define several empty lists (NOT use l1=l=l3=[] ⇒ this would be the SAME list)</p>
<pre><code class="language-markdown">l1,l2,l3,l4 = ([] for i in range(4))
</code></pre>
<p>check for True if list has an element</p>
<pre><code class="language-markdown">if l
</code></pre>
<p>check for False if list is empty (same would be if l == []</p>
<pre><code class="language-markdown">if not l
</code></pre>
<p>Define list with content</p>
<pre><code class="language-markdown">l = [4,5,6]
</code></pre>
<p>Define list - content is list from 0 to 19</p>
<pre><code class="language-markdown">l = list(range(20))
</code></pre>
<p>Define list with 8 empyt strings</p>
<pre><code class="language-markdown">l = [&quot;&quot; for x in range(8)]
</code></pre>
<p>Uppercase the whole list</p>
<pre><code class="language-markdown">l = [x.upper(for x in l)]
</code></pre>
<p>Define a nested list with 5x5</p>
<pre><code class="language-markdown">l = [[&quot;&quot; for x in range(5)] for x in range(5)]
</code></pre>
<p>Add both lists together (to a new list)</p>
<pre><code class="language-markdown">l1 + l2
</code></pre>
<p>Add 1 element to the list at the back</p>
<pre><code class="language-markdown">l.append(1)
</code></pre>
<p>Add several elements to the list at the back</p>
<pre><code class="language-markdown">l.extend([6,5,4])
</code></pre>
<p>Insert an element at the index-position 3</p>
<pre><code class="language-markdown">l.insert(3, &quot;xyz&quot;)
</code></pre>
<p>Returns first index position of element &quot;xyz&quot;</p>
<pre><code class="language-markdown">l.index(&quot;xzy&quot;)
</code></pre>
<p>Delete last element from list</p>
<pre><code class="language-markdown">l.pop()
</code></pre>
<p>Delete first element from list</p>
<pre><code class="language-markdown">l.pop(0)
</code></pre>
<p>Sort list ascending</p>
<pre><code class="language-markdown">l.sort()
</code></pre>
<p>Sort list descending</p>
<pre><code class="language-markdown">l.sort(reverse=True)
</code></pre>
<p>Sort list and store it in a different independent list</p>
<pre><code class="language-markdown">l_sort = sorted(l)
</code></pre>
<p>Sort list descending and store it in a different independent list</p>
<pre><code class="language-markdown">l_sort = sorted(l, reverse=True)
</code></pre>
<p>Check if a list is sorted (by ascending)</p>
<pre><code class="language-markdown">if sorted(l) == l
</code></pre>
<p>Check if a list is sorted by descending</p>
<pre><code class="language-markdown">if sorted(l, reverse=True) == l
</code></pre>
<p>Sort list by len of elements</p>
<pre><code class="language-markdown">l.sort(key=len)
</code></pre>
<p>Define nested list</p>
<pre><code class="language-markdown">l = [[1,4,3], [2,2,4], [3,1,5]]
</code></pre>
<p>Sort nested list for the 2nd element ascending</p>
<pre><code class="language-markdown">l.sort(key=lambda x: x[1])
</code></pre>
<p>Sort nested list 1st for the 1st elem, then for the 2nd elem</p>
<pre><code class="language-markdown">inpItems.sort(key=lambda x: (x[0], x[1]))
</code></pre>
<p>Sort nested list for the 2nd element descending</p>
<pre><code class="language-markdown">l.sort(key=lambda x: x[1], reverse=True)
</code></pre>
<p>Reverse the complete list</p>
<pre><code class="language-markdown">l.reverse()
</code></pre>
<p>Reverse complete list and store it in different independent list</p>
<pre><code class="language-markdown">l_reverse = list(reversed(l))
</code></pre>
<p>Delete element at index position 2</p>
<pre><code class="language-markdown">del l[2]
</code></pre>
<p>Delete first element with this value from the list</p>
<pre><code class="language-markdown">l.remove(&quot;abc&quot;)
</code></pre>
<p>Delete complete content of the list (same as l = [])</p>
<pre><code class="language-markdown">l.clear()
</code></pre>
<p>Find smallest element in the list</p>
<pre><code class="language-markdown">min(l)
</code></pre>
<p>Find greatest element in the list</p>
<pre><code class="language-markdown">max(l)
</code></pre>
<p>Find longest string in the list</p>
<pre><code class="language-markdown">max(mylist, key=len)
</code></pre>
<p>Find lenght of longest string in the list</p>
<pre><code class="language-markdown">len(max(mylist, key=len))
</code></pre>
<p>Sum of all elements in the list</p>
<pre><code class="language-markdown">sum(l)
</code></pre>
<p>Pair Sorting from 2 lists (1 with 1, 2 with 2, 3 mit 3, aso.)</p>
<pre><code class="language-markdown">2xls_sum  = [sum(pair) for pair in zip(l1, l2)]
</code></pre>
<p>Count of elements in list</p>
<pre><code class="language-markdown">len(l)
</code></pre>
<p>Count of occurence of the element &quot;a&quot; in the list</p>
<pre><code class="language-markdown">l.count(&quot;a&quot;)
</code></pre>
<p>No seperate copy of the list (updates in both lists)</p>
<pre><code class="language-markdown">l2 = l1
</code></pre>
<p>Separate individual copy of the list (no updates in both lists)</p>
<pre><code class="language-markdown">l2 = l.copy()
</code></pre>
<p>Separate individual copy of the list - 2nd variant</p>
<pre><code class="language-markdown">l2 = l[:]
</code></pre>
<p>Separate individual copy of the list - 3rd variant</p>
<pre><code class="language-markdown">l2 = list(l)
</code></pre>
<p>First element</p>
<pre><code class="language-markdown">l[0]
</code></pre>
<p>Last element</p>
<pre><code class="language-markdown">l[-1]
</code></pre>
<p>Last 3 elements</p>
<pre><code class="language-markdown">l[-3:]
</code></pre>
<p>Elements from index position 2 to 3</p>
<pre><code class="language-markdown">l[2:4]
</code></pre>
<p>Elements from 0 to 1 (exclusive index position 2)</p>
<pre><code class="language-markdown">l[:2]
</code></pre>
<p>Elements from index position 2 to the end of the list</p>
<pre><code class="language-markdown">l[2:]
</code></pre>
<p>Every second element [start:end:step]</p>
<pre><code class="language-markdown">l[::2]
</code></pre>
<p>Check if element is in list</p>
<pre><code class="language-markdown">9 in l
</code></pre>
<p>Check if any elements from the list are in the string</p>
<pre><code class="language-markdown">if any(x in string for x in [&quot;ab&quot;,&quot;cd&quot;,&quot;de&quot;]):
</code></pre>
<p>Check if all elements from the list are in the string</p>
<pre><code class="language-markdown">if all(x in string for x in [&quot;ab&quot;,&quot;cd&quot;,&quot;de&quot;]):
</code></pre>
<p>Check if all elements from the list are NOT in the string</p>
<pre><code class="language-markdown">if all(x not in string for x in [&quot;ab&quot;,&quot;cd&quot;&quot;]):
</code></pre>
<p>Iterate through list content</p>
<pre><code class="language-markdown">for i in l:
</code></pre>
<p>Iterate through list with index</p>
<pre><code class="language-markdown">for i in range(len(l)):
</code></pre>
<p>Iterate through list with index and content</p>
<pre><code class="language-markdown">for idx, cont in enumerate(l):
</code></pre>
<p>Iterate through 2 lists pair-wise (stops when the shorter list is reached)</p>
<pre><code class="language-markdown">for x,y in zip(l1,l2):
</code></pre>
<p>Create string with elements joined together with &quot;, &quot; eg. [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;] ⇒ a, b, c</p>
<pre><code class="language-markdown">', '.join(l)
</code></pre>
<p>Define list</p>
<pre><code class="language-markdown">a = [1,2,3,4,5]
</code></pre>
<p>List is mapped with the lambda function ⇒ [2,4,6,8,10]</p>
<pre><code class="language-markdown">list(map(lambda x: x*2, [1,2,3,4,5]))
</code></pre>
<p>Also possible with list comprehension ⇒ [2,4,6,8,10]</p>
<pre><code class="language-markdown">l=[x*2 for x in [1,2,3,4,5]]
</code></pre>
<p>Also possible with list comprehension ⇒ [2,4]</p>
<pre><code class="language-markdown">l=[x for x in [1,2,3,4,5] if x%2==0]
</code></pre>
<p>List comprehension with if and else</p>
<pre><code class="language-markdown">l=[x*2 if x.isdigit() else x for x in [1,&quot;A&quot;,2]]
</code></pre>
<p>List is filtered with lambda for even numbers ⇒ [2,4]</p>
<pre><code class="language-markdown">list(filter(lambda x: x%2==0, [1,2,3,4,5]))
</code></pre>
<p>Build paris as tuple ⇒ (1,4),(2,5),(3,6)</p>
<pre><code class="language-markdown">zip([1,2,3],[4,5,6])
</code></pre>
<p>Remove duplicates from a list</p>
<pre><code class="language-markdown">list(set(x))
</code></pre>
<p>Change elements in list to int</p>
<pre><code class="language-markdown">list(map(int,l))
</code></pre>
<p><br>rotate list for n places</p>
<pre><code class="language-markdown">def rotate(l, n):
    return l[-n:] + l[:-n]
</code></pre>
<p><br>Iterate over 2 lists at the same time using zip</p>
<pre><code class="language-markdown">animal = ['Cat', 'Dog', 'Fish', 'Goat']
age = [1, 2, 2, 6]
z = zip(animal, age)
for animal, age in z: ...
</code></pre>
<hr />
<h2 id="tupel">TUPEL</h2>
<p><a href="#python">jump to top...</a><br><br>
ordered, immutable, allows duplicate elements
working can be more efficient than with lists - especially with big data - regarding space and runtime<br>
Create a tuple</p>
<pre><code class="language-markdown">t = (4,5,6)
</code></pre>
<p>Create a tuple from a list</p>
<pre><code class="language-markdown">t = tuple([3,4,4]
</code></pre>
<p>Selection / slicing of elements - same as with lists</p>
<pre><code class="language-markdown">t[]
</code></pre>
<p>Change tuple to list</p>
<pre><code class="language-markdown">l = list(t)
</code></pre>
<p>Change list to tuples</p>
<pre><code class="language-markdown">t = tuple(l)
</code></pre>
<p>Assigning vars to tuple-elements (a=0, b=1, c=2)</p>
<pre><code class="language-markdown">a,b,c = (0,1,2)
</code></pre>
<p>Assigning to tuple-values (f=0, m=[1,2,3], l=4)</p>
<pre><code class="language-markdown">f,*m,l = (0,1,2,3,4)
</code></pre>
<hr />
<h2 id="dictionary">DICTIONARY</h2>
<p><a href="#python">jump to top...</a><br><br>
key-value pairs, unordered (till version 3.7), mutable<br>
Define empty dict</p>
<pre><code class="language-markdown">d = {}
</code></pre>
<p>Define dict with content</p>
<pre><code class="language-markdown">d = {&quot;one&quot;: 1, &quot;two&quot;: 2, &quot;three&quot;: 3}
</code></pre>
<p>2nd way to defince a dict with content</p>
<pre><code class="language-markdown">d = dict(one=1,two=2,three=3)
</code></pre>
<p>Define dict with content (with dupels)</p>
<pre><code class="language-markdown">d = dict([(&quot;one&quot;,1),(&quot;two&quot;,2),(&quot;three&quot;,3)])
</code></pre>
<p>Define dict with content (with pairs in nested list)</p>
<pre><code class="language-markdown">d = dict([[&quot;one&quot;,1],[&quot;two&quot;,2],[&quot;three&quot;,3]])
</code></pre>
<p>Define dict with 2 different lists (1x keys and 1x values)</p>
<pre><code class="language-markdown">d = dict(zip([&quot;one&quot;,&quot;two&quot;,&quot;three&quot;], [1,2,3]))
</code></pre>
<p>Access value with key element (error when the key is not in the dict)</p>
<pre><code class="language-markdown">d[&quot;two&quot;]
</code></pre>
<p>BETTER: Acesss value with get for key element (no error when the key is not in the dict - returns second parameter instead)</p>
<pre><code class="language-markdown">d.get(&quot;two&quot;,&quot;N/A&quot;)
</code></pre>
<p>Access value - same as get - but also initialize the key when it is not in the dict - with the second parameter)</p>
<pre><code class="language-markdown">d.setdefault(&quot;two&quot;,&quot;N/A&quot;)
</code></pre>
<p>Find key for specific value (v) in dict</p>
<pre><code class="language-markdown">key = list(d.keys())[list(d.values()).index(v)]
</code></pre>
<p>Read keys from dict to list</p>
<pre><code class="language-markdown">list(d.keys())
</code></pre>
<p>Read values from dict to list</p>
<pre><code class="language-markdown">list(d.values())
</code></pre>
<p>Count of entries in dict</p>
<pre><code class="language-markdown">len(d)
</code></pre>
<p>Check if key is in dict (true / false)</p>
<pre><code class="language-markdown">&quot;three&quot; in d
</code></pre>
<p>New entry for dict (key = &quot;four&quot;, value = 4)</p>
<pre><code class="language-markdown">d[&quot;four&quot;] = 4
</code></pre>
<p>Delete specific key in dict</p>
<pre><code class="language-markdown">del d[&quot;one&quot;]
</code></pre>
<p>Rename dict-keyname</p>
<pre><code class="language-markdown">mydict[new_key] = mydict.pop(old_key)
</code></pre>
<p>Combine 2 dicts (if key is in both dicts - the second value will be taken)</p>
<pre><code class="language-markdown">combined_dict = {**d1, **d2}
</code></pre>
<p>Check if key is in dict</p>
<pre><code class="language-markdown">if &quot;xyz&quot; in d:
</code></pre>
<p>Copying a dict (all changes will be made in BOTH dicts)</p>
<pre><code class="language-markdown">d2 = d
</code></pre>
<p>Copying a dict (dicts will be handled seperate)</p>
<pre><code class="language-markdown">d2 = d.copy()
</code></pre>
<p>Copying a dict 2nd method (dicts will be handled seperate)</p>
<pre><code class="language-markdown">d2 = dict(d)
</code></pre>
<p>Dict d get updated with d2 (all existing keys are overwritten - and new added)</p>
<pre><code class="language-markdown">d.update(d2)
</code></pre>
<p>Iterate through dict keys</p>
<pre><code class="language-markdown">for key in d.keys():
</code></pre>
<p>Iterate through sorted dict keys ascending</p>
<pre><code class="language-markdown">for key in sorted(d.keys()):
</code></pre>
<p>Iterate through sorted dict keys descending</p>
<pre><code class="language-markdown">for key in sorted(d.keys(),reverse=True):
</code></pre>
<p>Iterate through dict values</p>
<pre><code class="language-markdown">for val in d.values():
</code></pre>
<p>Iterate through keys and values of the dict</p>
<pre><code class="language-markdown">for key, val in d.items():
</code></pre>
<p>Sort dict descending according to values (=item[1])</p>
<pre><code class="language-markdown">d = {k: v for k, v in sorted(d.items(), key=lambda item: item[1], reverse=True)}
</code></pre>
<p>Sort dict ascending according to keys (=item[0])</p>
<pre><code class="language-markdown">d = {k: v for k, v in sorted(d.items(), key=lambda item: item[0])}
</code></pre>
<p>Dict sorted: 1st value-desc (x[0]) - 2nd key-ascnd (-x[0])</p>
<pre><code class="language-markdown">d = {k: v for k, v in sorted(d.items(), key=lambda x: (-x[1],x[0]))}
</code></pre>
<p>Sort dict and output list, sorted according to the 3rd element of the list in the dict</p>
<pre><code class="language-markdown">l = sorted(d.items(), key=lambda e: e[1][2])
</code></pre>
<p>Sort dict and output list, sorted according to the 3rd element of the list in the dict - descending</p>
<pre><code class="language-markdown">l = sorted(d.items(), key=lambda e: e[1][2], reverse=True)
</code></pre>
<hr />
<h2 id="sets">SETS</h2>
<p><a href="#python">jump to top...</a><br><br>
unordered, mutable, no duplicates<br>
Define empty set - {} would define a dict and not a set</p>
<pre><code class="language-markdown">s=set()
</code></pre>
<p>Define set with content</p>
<pre><code class="language-markdown">s = {1,1,2,2,3,4}
</code></pre>
<p>Define empty set - returns: {&quot;o&quot;,&quot;l&quot;,&quot;H&quot;,&quot;e&quot;}</p>
<pre><code class="language-markdown">s = set(&quot;Hello&quot;)
</code></pre>
<p>Define second set</p>
<pre><code class="language-markdown">s2 = {1,7,8}
</code></pre>
<p>Add element in set1</p>
<pre><code class="language-markdown">s.add(5)
</code></pre>
<p>Add several elements to set1</p>
<pre><code class="language-markdown">s.update([10,11,12])
</code></pre>
<p>Intersection of 2 sets (same as: s.intersection(s2))</p>
<pre><code class="language-markdown">s &amp; s2
</code></pre>
<p>Untion of 2 sets (same as: s.union(s2))</p>
<pre><code class="language-markdown">s | s2
</code></pre>
<p>Difference of 2 sets (same as: s.difference(s2))</p>
<pre><code class="language-markdown">s - s2
</code></pre>
<p>True if s is subset from s2 (same as: s.issubset(s2))</p>
<pre><code class="language-markdown">s &lt;= s2
</code></pre>
<p>Check if element is in set</p>
<pre><code class="language-markdown">3 in s
</code></pre>
<p>Clear the set</p>
<pre><code class="language-markdown">s.clear()
</code></pre>
<p>Delete lowest elmeent in set</p>
<pre><code class="language-markdown">s.pop()
</code></pre>
<p>Delete element 5 from set - but key error possible</p>
<pre><code class="language-markdown">s.remove(5)
</code></pre>
<p>Delete element 5 from set - NO key error possible</p>
<pre><code class="language-markdown">s.discard(5)
</code></pre>
<p>Iterate through set content</p>
<pre><code class="language-markdown">for i in s:
</code></pre>
<p>Copying a set (all changes will be made in BOTH sets)</p>
<pre><code class="language-markdown">s2 = s1
</code></pre>
<p>Copying a set (set will be handled seperate)</p>
<pre><code class="language-markdown">s2 = s.copy()
</code></pre>
<p>Copying a set 2nd method (set will be handled seperate)</p>
<pre><code class="language-markdown">s2 = set(s)
</code></pre>
<p>Define a frozenset - no changes are possible in the set - union, intersection aso. will work</p>
<pre><code class="language-markdown">s = frozenset(1,2,3)
</code></pre>
<hr />
<h2 id="control-structures-and-iterations">CONTROL STRUCTURES and ITERATIONS</h2>
<p><a href="#python">jump to top...</a><br><br>
If / elif / else</p>
<pre><code class="language-markdown">if x &gt; 10: pass
elif x &gt; 10: pass
else: pass
</code></pre>
<p><br>Use 2 conditions in one line (instead of (a&gt;10 and a&lt;20)</p>
<pre><code class="language-markdown">if (10 &lt; a &lt; 20)...
</code></pre>
<p>Connecting different control structures with logical and &amp;</p>
<pre><code class="language-markdown">if a&lt;10 &amp; b&gt;10 &amp; c==4...
</code></pre>
<p><br>5 iterations from 0 to 4</p>
<pre><code class="language-markdown">for i in range(5):
</code></pre>
<p>5 iterations from 0 to 4 (start, end, step)</p>
<pre><code class="language-markdown">for i in range(0, 5, 1)
</code></pre>
<p>Iterations descending from 4 to 0</p>
<pre><code class="language-markdown">for i in range(4, -1, -1)
</code></pre>
<p><br>While loop with break condition</p>
<pre><code class="language-markdown">while x &lt; 4:
</code></pre>
<p>Endless while loop - has to be exited with break</p>
<pre><code class="language-markdown">while True:
</code></pre>
<p>Break loop completely</p>
<pre><code class="language-markdown">break
</code></pre>
<p>Break actual loop run - continue with next loop run</p>
<pre><code class="language-markdown">continue
</code></pre>
<hr />
<h2 id="functions-decorators">FUNCTIONS, DECORATORS</h2>
<p><a href="#python">jump to top...</a><br><br>
description of the function in form of a docstring</p>
<pre><code class="language-markdown">def printNumAbbr(value):
'''
eg. Make abbreviaton for numeric value in thousands (K), millions (M), billions (B) or trillions (T)
:param value: numeric value which should be abbreviated
:return: string value with maximum possible abbreviation
'''
</code></pre>
<p><br>Define function - with default value 0 if no input is given</p>
<pre><code class="language-markdown">def add(x=0,y=0):
    erg = x+y                   	# Calculation in function
    return erg                  	# Return value from the function
</code></pre>
<p><br>Optional argument in the funtction (first element is must - second optional)</p>
<pre><code class="language-markdown">def pet (animal,n1=None,n2=&quot;x&quot;)
pet(&quot;Cat&quot;)                      	# Calling function with n1=None and n2 = &quot;x&quot;
pet(&quot;Cat&quot;,&quot;name&quot;)					# Calling function with n1=name and n2 = &quot;X&quot;
pet(&quot;Cat&quot;,n2=&quot;xyz&quot;) 				# Calling function with n1=None and n2 = &quot;xyz&quot; (third parameter has to be named when calling)
</code></pre>
<p><br>Function with infinite arguments</p>
<pre><code class="language-markdown">def varargs(*args): print(args)
varargs(1,2,3)                  	# Outputs (1,2,3)

def keyword_args(**kwargs):
    print(kwargs)
keyword_args(&quot;a&quot;=3, &quot;b&quot;=4)      	# Outputs {&quot;a&quot;:3, &quot;b&quot;:4}
</code></pre>
<p><br>decorator template</p>
<pre><code class="language-markdown">def my_decorator(func):				# Define decorator
  @functools.wraps(func)
  def wrapper(*args,**kwargs):		# Decorator with * arguments
	  #Do...					 	# Do something before the functions
	  result=func(*args,**kwargs)	# Run the function
	  #Do...					 	# Do something after the functions
	  return result					# Return the results from the function
  return wrapper
</code></pre>
<p><br>decorator</p>
<pre><code class="language-markdown">extend behaviour of a function with a decorators
def start_end_decorator(func):		# Define the decorator with function &quot;func&quot; as input-parameter
	def wrapper():					# Inside the decorator a wrapper function has to be defined
		print(&quot;Start&quot;)				# Decorated code which is executed before the core code from the function
		func()						# Calling the function itself
		print(&quot;End&quot;)				# Decorated code which is executed after the core code from the function
	return wrapper					# Results from the decorator have to be given back
@start_end_decorator				# Defines this decorator for the following function &quot;print_name&quot;
def print_name():					# Normal content of the function
	print(&quot;xyz&quot;)					# Core functionality of the function
print_name()						# Now when the function is executed - outputs not only &quot;xyz&quot; - also &quot;Start&quot; before and &quot;End&quot; after
</code></pre>
<p><br>decorator with function arguments</p>
<pre><code class="language-markdown">def start_end_decorator(func):		# Define the decorator with function &quot;func&quot; as input-parameter
	def wrapper(*args,**kwargs):	# Inside the decorator a wrapper function has to be defined
		print(&quot;Start&quot;)				# Decorated code which is executed before the core code from the function
		result = (*args,**kwargs)	# Calling the function itself
		print(&quot;End &quot;)				# Decorated code which is executed after the core code from the function
		return result
	return wrapper					# Results from the decorator have to be given back
@start_end_decorator				# Defines this decorator for the following function &quot;add5&quot;
def add5(x):						# Normal content of the function with one argument
	return x + 5					# Core functionality of the function
result = add5(10)					# Outputs &quot;Start&quot; =&gt; &quot;End&quot; =&gt; 15
print(result)
</code></pre>
<hr />
<h2 id="generators-yield">GENERATORS, YIELD</h2>
<p><a href="#python">jump to top...</a><br><br>
very memory efficient
<br>Defines the generator with 3 yield statements</p>
<pre><code class="language-markdown">def mygenerator():
	yield 3
	yield 2
	yield 1
</code></pre>
<p><br>Creates the generator and stores in g (=generator type)</p>
<pre><code class="language-markdown">g = mygenerator()
</code></pre>
<p>Outputs 3,2,1</p>
<pre><code class="language-markdown">for i in g: print(i)
</code></pre>
<p>Outputs 3</p>
<pre><code class="language-markdown">print(next(g))
</code></pre>
<p>Outputs 2</p>
<pre><code class="language-markdown">print(next(g))
</code></pre>
<p>Sum-Function can also use a generator ⇒ result is 6</p>
<pre><code class="language-markdown">sum(g)
</code></pre>
<p>Sorted-Function can use generator ⇒ returns list with sorted elements [1,2,3]</p>
<pre><code class="language-markdown">sorted(g)
</code></pre>
<hr />
<h2 id="exceptions">EXCEPTIONS</h2>
<p><a href="#python">jump to top...</a><br><br>
try / except</p>
<pre><code class="language-markdown">try:
	a = 5 / 0
except Exception as e:
	print(&quot;Exception: &quot;,e)						# Prints exception &quot;division by zero&quot;
</code></pre>
<p><br>assert / raise</p>
<pre><code class="language-markdown">x = -5
assert (x&gt;=0), &quot;x is not positive&quot;				# Checks / Assert some condition =&gt; prints &quot;x is not positive&quot;
if x&lt;0: raise Exception(&quot;x should positive&quot;)	# Raises an exception =&gt; prints &quot;Exception: x should be positive&quot;
</code></pre>
<hr />
<h2 id="lambda-map-filter">LAMBDA, MAP, FILTER</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>functions with one argument - add10(5) ⇒ 15</p>
<pre><code class="language-markdown">add10 = lambda x: x+10
</code></pre>
<p>functions with two arguments for multiplying - mult(2,7) ⇒ 14</p>
<pre><code class="language-markdown">mult = lambda x,y: x*y
</code></pre>
<p>p = [(1,2),(15,1),(5,-1),(10,4)]<br>
output is sorted with first element then second element ⇒ [(1,2),(5,-1),(10,4),(15,1)]</p>
<pre><code class="language-markdown">sorted(p)
</code></pre>
<p>output is sorted by the second element ⇒ [(5,-1),(15,1),(1,2),(10,4)]</p>
<pre><code class="language-markdown">sorted(p,key=lambda x:x[1])
</code></pre>
<p>output is sorted by the sum of both ⇒ [(1,2),(5,-1),(10,4),(15,1)]</p>
<pre><code class="language-markdown">sorted(p,key=lambda x:x[0]+x[1])
</code></pre>
<p>a = [1,2,3,4,5]<br>
list is mapped with the lambda function ⇒ [2,4,6,8,10]</p>
<pre><code class="language-markdown">list(map(lambda x: x*2,a))
</code></pre>
<p>also possible with list comprehension ⇒ [2,4,6,8,10]</p>
<pre><code class="language-markdown">c=[x*2 for x in a]
</code></pre>
<p>list is filtered with lambda for even numbers ⇒ [2,4]</p>
<pre><code class="language-markdown">list(filter(lambda x: x%2==0,a))
</code></pre>
<p>also possible with list comprehension ⇒ [2,4]</p>
<pre><code class="language-markdown">c=[x for x in a if x%2==0]
</code></pre>
<hr />
<h2 id="classes-dataclasses">CLASSES, DATACLASSES</h2>
<p><a href="#python">jump to top...</a><br><br>
Define a class</p>
<pre><code class="language-markdown">class Human(object):
  species = &quot;Homo Sapiens&quot;    # Fix variable / class variable for all instances of the class
  def __init__(self,name):    # Constructor - automatically applied when an instance is created
      self.name = name		  # Name is assigned to the instance of the classe (self.)
	  self.tresor = []		  # Tresor is assigned as list to the instance of the class (self.)
  def say(self, msg):         # Methode of the class
      return &quot;{name}: {message}&quot;.format(name=self.name, message=msg)
	  elf.tresor.append(msg)  # Tesor of the instance gets a new value in the list
  @classmethod                # Class methode - is used by all instances
  def get_species(cls):
      return cls.species
  @staticmethod               # Static methode - is called without class or method
  def grunt():
      return &quot;*grunt*&quot;
</code></pre>
<p><br>Create instance of the class</p>
<pre><code class="language-markdown">i = Human(name=&quot;Ian&quot;)
</code></pre>
<p>Call the methode of the class (output: &quot;Ian: Hi&quot;)</p>
<pre><code class="language-markdown">print(i.say(&quot;Hi&quot;))
</code></pre>
<p>Create additonal instance of the class</p>
<pre><code class="language-markdown">j = Human(name=&quot;Joel&quot;)
</code></pre>
<p>Call the methode of the class (output: &quot;Joel: Hallo&quot;)</p>
<pre><code class="language-markdown">print(i.say(&quot;Hallo&quot;))
</code></pre>
<p>Output &quot;Homo Sapiens&quot;</p>
<pre><code class="language-markdown">i.get_species()
</code></pre>
<p>Same output  &quot;Homo Sapiens&quot;</p>
<pre><code class="language-markdown">j.get_species()
</code></pre>
<p>Change of the class variable - applies for all instances</p>
<pre><code class="language-markdown">Human.species = &quot;Was Neues&quot;
</code></pre>
<p>Aufruf der statischen Methode ⇒ Ausgabe: &quot;<em>grunt</em>&quot;</p>
<pre><code class="language-markdown">Human.grunt()
</code></pre>
<p><br>Dataclasses</p>
<pre><code class="language-markdown">from dataclasses import dataclass		# import dataclass necessary
@dataclass								# define a dataclass
class Coordinate:						# class is defined an need NO __init__, __repr__, __eq__
    x: int								# __init__ no necessary - values get assigned automatically
    y: int = 10							# __repr__ print for the string-represantion is automatic =&gt; Coordinate(x=4, y=5)
a = Coordinate(4, 5)
@dataclass (frozen=True)				# defines a unmutable instance
asdict(dc)								# converts the dataclass to a dict
astuple(dc)								# converts the dataclass to a tuple
</code></pre>
<hr />
<h2 id="txt-files">TXT FILES</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Read textfile - and print it</p>
<pre><code class="language-markdown">with open (&quot;fn.txt&quot;,&quot;r&quot;) as f: print(f.read()
</code></pre>
<p>Open File for Read and Write</p>
<pre><code class="language-markdown">with open (&quot;fn.txt&quot;,&quot;r+&quot;) as f: print(f.read()
</code></pre>
<p><br>Read textfile - stored in list per line</p>
<pre><code class="language-markdown">with open(&quot;fn.txt&quot;,&quot;r&quot;) as f:
    lines = [x.strip() for x in f.readlines()]          # Whitespaces are eliminated with strip()
</code></pre>
<p><br>Writing in textfile</p>
<pre><code class="language-markdown">with open(&quot;fn.txt&quot;,&quot;w&quot;) as obj: obj.write(&quot;Ein neuer Text&quot;)
</code></pre>
<p>Append text in the next line</p>
<pre><code class="language-markdown">with open(&quot;fn.txt&quot;,&quot;a&quot;) as obj: obj.write(&quot;\nNoch ein Text&quot;)
</code></pre>
<p>Check if file allready exists</p>
<pre><code class="language-markdown">if os.path.exists(fn) == False:
</code></pre>
<p>Create and initialize file when not exisiting</p>
<pre><code class="language-markdown">with open (fn,&quot;a&quot;) as f: f.write(&quot;init&quot;)
</code></pre>
<p>Read content to string</p>
<pre><code class="language-markdown">f.read()
</code></pre>
<p>Set the current postion in the file to beginning</p>
<pre><code class="language-markdown">f.seek(0)
</code></pre>
<p>Write s to the f-file opened</p>
<pre><code class="language-markdown">f.write(s)
</code></pre>
<p><br>Try/Except - checks if file can be saved</p>
<pre><code class="language-markdown">while True:
try:                         							# otherwise outputs a error message
    writer.save ()
    break
except Exception as e:
    print (&quot;Error: &quot;, e)
	traceback.print_exc()                               # Outputs the detailed error message
    input (&quot;File Open not possible - pls close and press &lt;Enter&gt;&quot;)
</code></pre>
<hr />
<h2 id="json-format">JSON FORMAT</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import json-module</p>
<pre><code class="language-markdown">import json
</code></pre>
<p>Assign JSON-filename</p>
<pre><code class="language-markdown">fn = &quot;numbers.json&quot;
</code></pre>
<p>Reading informations in json-format</p>
<pre><code class="language-markdown">with open(fn) as data: info = json.loads(data)
</code></pre>
<p>Convert / Encode a dict to a json-file (with indent for better reading)</p>
<pre><code class="language-markdown">json_format = json.dumps(d,indent=2)
</code></pre>
<p>Convert / Encode a dict to a json-file (with sorting the keys)</p>
<pre><code class="language-markdown">json_format = json.dumps(d,sort_keys=True)
</code></pre>
<p>Writing information in json-format (e.g. after updating the values/format)</p>
<pre><code class="language-markdown">with open(fn,&quot;w&quot;) as data: json.dump(person, data)
</code></pre>
<p>Convert / Decode a json-file to a dict</p>
<pre><code class="language-markdown">person = json.loads(json_format)
</code></pre>
<p>Reading information in json-format</p>
<pre><code class="language-markdown">with open(fn.json,&quot;r&quot;) as data: d=json.load(file)
</code></pre>
<p>Pretty-Print formatted json-file</p>
<pre><code class="language-markdown">print(json.dumps(erg, indent=4, sort_keys=True))
</code></pre>
<p><br>read JSON from file
<br>ignoring errors and handles multiple json-objects</p>
<pre><code class="language-markdown">with open(fnJSON, errors=&quot;ignore&quot;) as f:
  data = [json.loads(line) for line in f]
</code></pre>
<p><br>read JSON from website
<br>ignoring errors and handles multiple json-objects</p>
<pre><code class="language-markdown">r = requests.get(tmpJSONWord)
jsonStrList = r.text.split(&quot;\n&quot;)
jsonList = [json.loads(j, errors=&quot;ignore&quot;) for j in jsonStrList if j != '']
</code></pre>
<p><br>Example for json-file</p>
<pre><code class="language-markdown">{
	&quot;firstName&quot; : &quot;Chuck&quot;,
	&quot;lastName&quot; : &quot;Doe&quot;,
	&quot;hobbies&quot;: [&quot;running&quot;,&quot;swimming&quot;,&quot;singing&quot;],
	&quot;age&quot;: 28,
	&quot;hasChildren&quot;: true
	&quot;children&quot; = [
		{
			&quot;firstName&quot; : &quot;Alex&quot;
			&quot;age&quot; : 5
		},
		{
			&quot;firstName&quot; : &quot;Bob&quot;
			&quot;age&quot; : 7
		}
	]
}
</code></pre>
<p><br>Read name value ⇒ &quot;Chuck&quot;</p>
<pre><code class="language-markdown">info[&quot;firstName&quot;]
</code></pre>
<p>Iterate trough the json-file (eg. many children)</p>
<pre><code class="language-markdown">for item in children:
</code></pre>
<hr />
<h2 id="xml-format">XML FORMAT</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import xml-module</p>
<pre><code class="language-markdown">import xml.etree.ElementTree as ET
</code></pre>
<p><br>Example for xml-file</p>
<pre><code class="language-markdown">&lt;persons&gt;
	&lt;person&gt;
		&lt;name&gt;Chuck&lt;/name&gt;
		&lt;phone type=&quot;int1&quot;&gt; +1 734 555&quot;&lt;/phone&gt;
		&lt;email hide=&quot;yes&quot;/&gt;
	&lt;/person&gt;
	...
&lt;/persons&gt;
</code></pre>
<p><br>Read xml-file into tree</p>
<pre><code class="language-markdown">tree = ET.fromstring(data)
</code></pre>
<p>Read name text ⇒ &quot;Chuck&quot;</p>
<pre><code class="language-markdown">tree.find(&quot;name&quot;).text
</code></pre>
<p>Read hide value from email ⇒ yes</p>
<pre><code class="language-markdown">tree.find(&quot;email&quot;.get(&quot;hide&quot;))
</code></pre>
<p><br>Iterate trough xml-file (eg. many persons)</p>
<pre><code class="language-markdown">lst = persons.findall(&quot;persons/person&quot;)
for item in lst:
</code></pre>
<hr />
<h2 id="urllib">URLLIB</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://pymotw.com/2/urlparse/">https://pymotw.com/2/urlparse/</a><br>
Import Module for URL parsing</p>
<pre><code class="language-markdown">import from urllib.parse import urlparse
</code></pre>
<p><a href="https://docs.python.org/3/library/urllib.request.html#module-urllib.request">https://docs.python.org/3/library/urllib.request.html#module-urllib.request</a><br>
Import Module for request</p>
<pre><code class="language-markdown">import urllib.request
</code></pre>
<p>Parse HTML-link1</p>
<pre><code class="language-markdown">u = urlparse(&quot;http://google.com/search&quot;)
</code></pre>
<p>Returns &quot;http&quot;</p>
<pre><code class="language-markdown">u.scheme
</code></pre>
<p>Returns &quot;/search&quot;</p>
<pre><code class="language-markdown">u.path
</code></pre>
<p>Returns &quot;google.com&quot;</p>
<pre><code class="language-markdown">u.netloc
</code></pre>
<p><br>Download picture from a url</p>
<pre><code class="language-markdown">  opener = urllib.request.URLopener()
  opener.addheader('User-Agent', &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36&quot;)
  filename, headers = opener.retrieve(url, 'Test.jpg')
</code></pre>
<hr />
<h2 id="module---csv">MODULE - CSV</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import CSV-Module</p>
<pre><code class="language-markdown">import csv
</code></pre>
<p><br>Open csv-file in writemode</p>
<pre><code class="language-markdown">with open(&quot;test.csv&quot;,&quot;w&quot;,newline=&quot; &quot;) as fp:
    a = csv.writer (fp, delimiter=&quot;,&quot;)                    # Define csv-writer with &quot;,&quot;-delimiter
    data = [[&quot;A&quot;, &quot;B&quot;],[&quot;100&quot;, &quot;24&quot;],[&quot;120&quot;, &quot;33&quot;]]       # Data for writing in nested list form
    a.writerows (data)                                    # Writing individual rows
</code></pre>
<p><br>Read csv-data from a HTML-link</p>
<pre><code class="language-markdown">import urllib.request
import codecs
url = link                                                      # direct link to a csv html file
ftpstream = urllib.request.urlopen(url)
csvfile = csv.reader(codecs.iterdecode(ftpstream, 'utf-8'))     # output is nested list
</code></pre>
<hr />
<h2 id="moudle---zipfile---handling-zip-files">MOUDLE - ZIPFILE - handling ZIP files</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import zip module</p>
<pre><code class="language-markdown">import zipfile
</code></pre>
<p>Read Zip-File</p>
<pre><code class="language-markdown">zf = zipfile.ZipFile('example.zip', 'r')
</code></pre>
<p>List of string with the names of the files in the Zip-File</p>
<pre><code class="language-markdown">zf.namelist()
</code></pre>
<p>Open file vom Zip-File (eg. CSV-File which is in the Zip-File)</p>
<pre><code class="language-markdown">zf.open (file_name)
</code></pre>
<hr />
<h2 id="module---gspread---api-for-google-sheets">MODULE - GSPREAD - API for Google Sheets</h2>
<p><a href="#python">jump to top...</a><br><br>
see also Python-Diverses / GSpread
<br>API for GoogleSheets / Tutorial explaining handling
<br>https://techwithtim.net/tutorials/google-sheets-python-api-tutorial/</p>
<pre><code class="language-markdown"># Create a project on https://console.cloud.google.com/
# select name + click create + select project
# 3 lines upper/left - API/Services - Library
# search for google drive API + enable it
# search for google sheets api + enable it
# 3 lines upper/left - API/Services - Credentials
# create credentials for Service Accounts + define name + press Continue
# choose role &quot;editor&quot; + press Continue + press Done
# press on created service account + press keys + Add Key + Create New Key
# select json + and store json-file with name creds.json
# copy client_email entry from the json-file
# in google sheets - got to share in the document
# paste the email from above + press send
</code></pre>
<p><br>Hosting and Scheduling on Google Cloud Platform groupcollide
<br>https://jrizmal.medium.com/deploying-a-python-web-scraper-on-google-cloud-platform-12fe24e57bb0</p>
<pre><code class="language-markdown"># select project  (in titlebar right from Google Cloud Platform)
# create a function (search for cloud functions)
# set trigger (Cloud Pub/Sub) and create/select topic
# files needed for hosting: main.py (inside def hello_pubsub), requirements.txt, creds.json
# create schedule (search for cloud scheduler)
</code></pre>
<p><br>See further setup in tutorial</p>
<pre><code class="language-markdown">import gspread                                                      # import module
import oauth2client                                                 # import module
from oauth2client.service_account import ServiceAccountCredentials  # import module for account credentials
from pprint import pprint                                           # import module for better output formatting
scope = [&quot;https://spreadsheets.google.com/feeds&quot;,
         'https://www.googleapis.com/auth/spreadsheets',
         &quot;https://www.googleapis.com/auth/drive.file&quot;,
         &quot;https://www.googleapis.com/auth/drive&quot;]
creds = ServiceAccountCredentials.from_json_keyfile_name
    (&quot;creds.json&quot;, scope)
</code></pre>
<p><br>Credentials Mgmt for GoogleSheets</p>
<pre><code class="language-markdown">gc = gspread.authorize(creds)
</code></pre>
<p>Open the Google Sheet</p>
<pre><code class="language-markdown">wb1 = gc.open(&quot;NameOfSheet)
</code></pre>
<p>Open the first worksheet in the Google Sheet</p>
<pre><code class="language-markdown">ws1 = wb1.get_worksheet(0)
</code></pre>
<p>Get all worksheets as worksheet-objects</p>
<pre><code class="language-markdown">listWS = wb1.worksheets()
</code></pre>
<p>Get all worksheets by n</p>
<pre><code class="language-markdown">listWS = [x.title for x in wb1.worksheets()]
</code></pre>
<p>Open the spreadhseet</p>
<pre><code class="language-markdown">sheet = client.open(&quot;testpython&quot;).sheet1
</code></pre>
<p>Get a list of all records</p>
<pre><code class="language-markdown">dataList = ws1.get_all_values()
</code></pre>
<p>Get specific areaw</p>
<pre><code class="language-markdown">data = ws1.get('B5:K8')
</code></pre>
<p>Get formula of a cell</p>
<pre><code class="language-markdown">ws1.acell('B1', value_render_option='FORMULA').value
</code></pre>
<p>Update cell range with nested list</p>
<pre><code class="language-markdown">ws1.update('A1:Z10', [[1, 2], [3, 4]])
</code></pre>
<p>Insert new row at row number 2</p>
<pre><code class="language-markdown">ws1.insert_row([&quot;new1&quot;,&quot;new2&quot;,&quot;new3&quot;],2)
</code></pre>
<p>Append new row at the end</p>
<pre><code class="language-markdown">ws1.append_row([&quot;new1&quot;,&quot;new2&quot;,&quot;new3&quot;])
</code></pre>
<p>Sorting the sheet (Range + col1 asc + col2 desc)</p>
<pre><code class="language-markdown">ws1.sort((1, 'asc'), (2, 'des'), range='A2:G20')
</code></pre>
<p>Get row 3 (starts counting from 1 - not 0)</p>
<pre><code class="language-markdown">row = sheet.row_values(3)
</code></pre>
<p>Get col E (starts counting from 1 - not 0)</p>
<pre><code class="language-markdown">col = sheet.col_values(5)
</code></pre>
<p>Get values from col B rows 4 and 5</p>
<pre><code class="language-markdown">col = sheet.col_values(2)[3:5]
</code></pre>
<p>Get the value from row 1 and col B</p>
<pre><code class="language-markdown">cell = sheet.cell(1,2).value
</code></pre>
<p>Update cell from row 2 and col B</p>
<pre><code class="language-markdown">ws1.update_cell(2,2, &quot;CHANGED&quot;)
</code></pre>
<p>Define cell area / cell row</p>
<pre><code class="language-markdown">cell_list = worksheet.range('A1:G1')
</code></pre>
<p>Define new values for area / row</p>
<pre><code class="language-markdown">new_values = [1,2,3,4,5]
</code></pre>
<p><br>Gspread Formatting
<br>https://pypi.org/project/gspread-formatting/</p>
<pre><code class="language-markdown"># Set format for area:
	from gspread_formatting import *
	fmt = cellFormat(
		backgroundColor=color(1, 0.9, 0.9),
		textFormat=textFormat(bold=True, foregroundColor=color(1, 0, 1)),
		horizontalAlignment='CENTER'
		)
	format_cell_range(worksheet, 'A1:J1', fmt)
# Conditional formatting
	from gspread_formatting import *
	worksheet = some_spreadsheet.worksheet('My Worksheet')
	rule = ConditionalFormatRule(
		ranges=[GridRange.from_a1_range('A1:A2000', worksheet)],
		booleanRule=BooleanRule(
			condition=BooleanCondition('NUMBER_GREATER', ['100']),
			format=CellFormat(textFormat=textFormat(bold=True), backgroundColor=Color(1,0,0))
		)
	)
	rules = get_conditional_format_rules(worksheet)
	rules.append(rule)
	rules.save()

	# or, to replace any existing rules with just your single rule:
	rules.clear()
	rules.append(rule)
	rules.save()
</code></pre>
<hr />
<h2 id="module---openpyxl---working-with-excel-worksheets">MODULE - OPENPYXL - working with excel worksheets</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.PAPERSIZE_A3</p>
<pre><code class="language-markdown">Documentation:
</code></pre>
<p>Import module for loading a workbook</p>
<pre><code class="language-markdown">from openpyxl import load_workbook
</code></pre>
<p>Import module for creating a workbook</p>
<pre><code class="language-markdown">from openpyxl import Workbook
</code></pre>
<p>Load xlsx</p>
<pre><code class="language-markdown">wb = load_workbook((&quot;Test.xlsx&quot;))
</code></pre>
<p>Load xlsm</p>
<pre><code class="language-markdown">wb = load_workbook(filename=&quot;Test.xlsm&quot;,
</code></pre>
<p>read_only=False,
keep_vba=True)
<br>Create new workbook</p>
<pre><code class="language-markdown">wb = openpyxl.Workbook()
</code></pre>
<p>Create new worksheet (at the end)</p>
<pre><code class="language-markdown">wb.create_sheet(&quot;ws&quot;)
</code></pre>
<p>Create new worksheet (at the beginning)</p>
<pre><code class="language-markdown">wb.create_sheet(&quot;ws&quot;,0)
</code></pre>
<p>Create new worksheet (at the second last position)</p>
<pre><code class="language-markdown">wb.create_sheet(&quot;ws&quot;,-2)
</code></pre>
<p>All worksheets from the</p>
<pre><code class="language-markdown">wb.sheetnames
</code></pre>
<p>Select specific worksheet in workbook</p>
<pre><code class="language-markdown">ws = wb[&quot;sheet1&quot;]
</code></pre>
<p>Select active worksheet from workbook</p>
<pre><code class="language-markdown">ws = wb.active
</code></pre>
<p>Change worksheet name</p>
<pre><code class="language-markdown">ws.title = &quot;xyz&quot;
</code></pre>
<p>Value from specific cell</p>
<pre><code class="language-markdown">ws[&quot;A1&quot;].value
</code></pre>
<p>Value from specific cell (other method)</p>
<pre><code class="language-markdown">ws.cell(row=1, column=1).value
</code></pre>
<p>Assign value to specific cell</p>
<pre><code class="language-markdown">ws[&quot;A1&quot;] = 97
</code></pre>
<p>Assign formula to specific cell (only english names for function and arguments must be sepearted by &quot;,&quot; and not &quot;;&quot;)</p>
<pre><code class="language-markdown">ws[&quot;A1&quot;] = &quot;=SUBTOTAL(1,I6:I10000)&quot;
</code></pre>
<p>Save workbook to xlsx</p>
<pre><code class="language-markdown">wb.save(&quot;Test2.xlsx&quot;)
</code></pre>
<p>Sort worksheets in workbook</p>
<pre><code class="language-markdown">wb._sheets.sort(key=lambda ws: ws.title)
</code></pre>
<p>Copy worksheet in workbook</p>
<pre><code class="language-markdown">wb.copy_worksheet(ws)
</code></pre>
<p><br>Loop trough specific area and print the cell values</p>
<pre><code class="language-markdown">for row in ws[&quot;A1&quot;:&quot;C3&quot;]:
    for cell in row: print(cell.value)
</code></pre>
<p><br>Loop trough specific column and print the cell values</p>
<pre><code class="language-markdown">for cell in ws[&quot;C&quot;]: print(cell.value)
</code></pre>
<p>Insert column before col 3</p>
<pre><code class="language-markdown">ws.insert_cols(3)
</code></pre>
<p>Insert 2 columns before col 3</p>
<pre><code class="language-markdown">ws.insert_cols(3,2)
</code></pre>
<p>Insert row before row 7</p>
<pre><code class="language-markdown">ws.insert_rows(7)
</code></pre>
<p>Insert 5 rows before row 10</p>
<pre><code class="language-markdown">ws.insert_rows(10,5)
</code></pre>
<p>Delete column C</p>
<pre><code class="language-markdown">ws.delete_cols(3)
</code></pre>
<p>Delete column F to H</p>
<pre><code class="language-markdown">ws.delete_cols(6,3)
</code></pre>
<p>Delete row 5</p>
<pre><code class="language-markdown">ws.delete_rows(5)
</code></pre>
<p>Delete row 5 to 7</p>
<pre><code class="language-markdown">ws.delete_rows(5,3)
</code></pre>
<p>Move the cells from D4:F10 up one row and right two columns</p>
<pre><code class="language-markdown">ws.move_range(&quot;D4:F10&quot;, rows=-1, cols=2)
</code></pre>
<p>Append the values at the bottom of the sheet</p>
<pre><code class="language-markdown">ws.append([1,&quot;A&quot;,2,&quot;C&quot;])
</code></pre>
<p>Returns dimension of the worksheet eg. &quot;A1:M24&quot;</p>
<pre><code class="language-markdown">ws.dimensions
</code></pre>
<p>Returns max column / row count of the worksheet</p>
<pre><code class="language-markdown">ws.max_column / ws.max_row
</code></pre>
<p>Returns min column / row count of the worksheet (which contains data)</p>
<pre><code class="language-markdown">ws.min_column / ws.min_row
</code></pre>
<p>Rows 1:3 to be printed at the top of every page</p>
<pre><code class="language-markdown">ws.print_title_rows(1:3)
</code></pre>
<p>Delete worksheet in workbook</p>
<pre><code class="language-markdown">del wb[&quot;sheet4&quot;]
</code></pre>
<p>Define filters in columns A5 to Q5</p>
<pre><code class="language-markdown">ws.auto_filter.ref = &quot;A5:Q5&quot;
</code></pre>
<p>Set filter to values &quot;X&quot;,&quot;Y&quot;,&quot;Z&quot; in column 2</p>
<pre><code class="language-markdown">ws.auto_filter.add_filter_column(2,[&quot;X&quot;,&quot;Y&quot;,&quot;Z&quot;])
</code></pre>
<p>Sort elements in filter for columsn B2 to B15</p>
<pre><code class="language-markdown">ws.auto_filter.add_sort_condition(&quot;B2:B15&quot;)
</code></pre>
<p>Close workbook</p>
<pre><code class="language-markdown">wb.close()
</code></pre>
<p><br>Iterate trough worksheet row by row</p>
<pre><code class="language-markdown">for row in ws.iter_rows():
    for cell in row: print(cell.value)
</code></pre>
<p><br>Iterate trough worksheet row by row (from A1 to C6 - 6 lines)</p>
<pre><code class="language-markdown">for row in ws.iter_rows
	(min_row=1,min_col=1,max_row=6,max_col=3):
</code></pre>
<p><br>Iterate trough worksheet col by col</p>
<pre><code class="language-markdown">for col in sheet.iter_cols():
    for cell in col: print(cell.value)
</code></pre>
<p><br>Iterate trough worksheet col by col (from A1 to C6 - 3 lines)</p>
<pre><code class="language-markdown">for col in ws.iter_cols
	(min_row=1,min_col=1,max_row=6,max_col=3):
</code></pre>
<p><br>Read whole worksheet to a nested list</p>
<pre><code class="language-markdown">data_list = []
for row in ws.iter_rows ():
    zeile = []
    for cell in row:
        if cell.value is None:
            zeile.append ('')
        else:
            zeile.append (cell.value)
    data_list.append (zeile)
</code></pre>
<p><br>Saving a nested list in XLSX</p>
<pre><code class="language-markdown">import pandas as pd
from openpyxl import load_workbook
cont = [[row1_cell1, row1_cell2], [row2.cell1,row3_cell3]]      # Nested list for saving
book = load_workbook (&quot;fn.xlsx&quot;)                                # load existing XLSX - skip when overwriting
writer = pd.ExcelWriter (&quot;fn.xlsx&quot;, engine='openpyxl',          # Define writer from pandas
                         options={'strings_to_numbers': True})
pd.DataFrame (cont).to_excel (writer, sheet_name=&quot;WS1&quot;,			# Prepare Data for XLSX and worksheet1
                              header=False, index=False)
pd.DataFrame (cont).to_excel (writer, sheet_name=&quot;WS2&quot;,			# Prepare Data for XLSX and worksheet2
                              header=False, index=False)
writer.save()                                                   # Save XLSX with the new worksheets
writer.close()													# Close writer
</code></pre>
<p><br>Checking if xlsx is open while trying to save</p>
<pre><code class="language-markdown">while True:
    try:
        writer.save ()
        writer.close ()
        break
    except Exception as e:
        print (&quot;Error: &quot;, e)
		traceback.print_exc()
        input (&quot;Datei kann nicht geöffnet werden - bitte schließen und &lt;Enter&gt; drücken!&quot;)
</code></pre>
<p><br>Read column to a list</p>
<pre><code class="language-markdown">mylist = []
for col in ws['A']:
     mylist.append(col.value)
</code></pre>
<p><br>Automatic adjustment of the columns accoring to best fit</p>
<pre><code class="language-markdown">column_widths = []
ws = writer.sheets[stock]
for row in content:                                    # Determination of the longest value per column
    for i, cell in enumerate (row):
        if len (column_widths) &gt; i:
            if len (str (cell)) &gt; column_widths[i]:
                column_widths[i] = len (str (cell))
        else:
            column_widths += [len (str (cell))]
    for i, column_width in enumerate (column_widths):  # Col 0 and 1 with fixed length - rest according to longest value in col
        if i == 0:
            ws.column_dimensions[get_column_letter (i + 1)].width = 35
        elif i == 1:
            ws.column_dimensions[get_column_letter (i + 1)].width = 32
        else:
            ws.column_dimensions[get_column_letter (i + 1)].width = column_width + 2
</code></pre>
<p><br>Formating the xlsx
when a cell is formated 2 times - it gets overwritten)<br>
import openpyxl.styles</p>
<pre><code class="language-markdown">from openpyxl.styles import Font, PatternFill, Border, Side, Alignment
</code></pre>
<p>import formatting, styles</p>
<pre><code class="language-markdown">from openpyxl import formatting, styles
</code></pre>
<p>bold font</p>
<pre><code class="language-markdown">bold = Font (bold=True)
</code></pre>
<p>yellow background (use color picker)</p>
<pre><code class="language-markdown">bg_yellow = PatternFill (fill_type=&quot;solid&quot;, start_color='fbfce1', end_color='fbfce1')
</code></pre>
<p>grey background (use color picker)</p>
<pre><code class="language-markdown">bg_grey = PatternFill (fill_type=&quot;solid&quot;, start_color='babab6', end_color='babab6')
</code></pre>
<p>blue background (use color picker)</p>
<pre><code class="language-markdown">bg_green = PatternFill (fill_type=&quot;solid&quot;, start_color='8af542', end_color='8af542')
</code></pre>
<p><br>define border on very side</p>
<pre><code class="language-markdown">frame_all = Border (left=Side (style='thin'), right=Side (style='thin'),
                    top=Side (style='thin'), bottom=Side (style='thin'))
</code></pre>
<p><br>border only on top and bottom</p>
<pre><code class="language-markdown">frame_upanddown = Border (top=Side (style='thin'), bottom=Side (style='thin'))
</code></pre>
<p>font size 14</p>
<pre><code class="language-markdown">size14 = Font (bold=True, size=&quot;14&quot;)
</code></pre>
<p>define left alignment</p>
<pre><code class="language-markdown">left_allign = Alignment (horizontal=&quot;left&quot;)
</code></pre>
<p>define right alignment</p>
<pre><code class="language-markdown">right_allign = Alignment (horizontal=&quot;right&quot;)
</code></pre>
<p><br>define right alignment for area</p>
<pre><code class="language-markdown">for row in ws[&quot;D1&quot;:&quot;G34&quot;]:
    for cell in row: cell.alignment = right_allign
</code></pre>
<p><br>define full border for several areas</p>
<pre><code class="language-markdown">areas = [&quot;A7:G19&quot;,&quot;A27:G31&quot;]
</code></pre>
<p><br>format area</p>
<pre><code class="language-markdown">for area in areas:
    for row in ws[area]:
        for cell in row:
			cell.border = frame_all
			cell.number_format = &quot;0&quot;															=&gt; define number format without decimals
			cell.number_format = &quot;0.000E+00&quot;													=&gt; define number format with 3 decimals
</code></pre>
<p><br>set background and size for several specific cells</p>
<pre><code class="language-markdown">for i in [&quot;A6&quot;,&quot;D6&quot;,&quot;E6&quot;,&quot;A26&quot;,&quot;D26&quot;,&quot;E26&quot;]:
    ws[i].fill = bg_green
    ws[i].font = size12
</code></pre>
<p><br>freeze worksheet at cell B2 for right and down scrolling</p>
<pre><code class="language-markdown">freeze = ws[&quot;B2&quot;]
ws.freeze_panes = freeze
</code></pre>
<p><br>fit xlsx to one page for printing - 1st part</p>
<pre><code class="language-markdown">ws.sheet_properties.pageSetUpPr.fitToPage = True
</code></pre>
<p>fit xlsx to one page for printing - 2nd part</p>
<pre><code class="language-markdown">ws.page_setup.fitToHeight = False
</code></pre>
<p>set page to landscape horizontal</p>
<pre><code class="language-markdown">ws.set_printer_settings(paper_size=1, orientation = 'landscape')
</code></pre>
<p>set page to landscape horizontal</p>
<pre><code class="language-markdown">ws.set_printer_settings(paper_size=1, orientation = 'portrait')
</code></pre>
<p>Define red color background</p>
<pre><code class="language-markdown">red_color = 'ffc7ce'
</code></pre>
<p>Define red color font</p>
<pre><code class="language-markdown">red_color_font = '9c0103'
</code></pre>
<p>Define red_font with size / bold / red color</p>
<pre><code class="language-markdown">red_font = styles.Font (size=14, bold=True, color=red_color_font)
</code></pre>
<p>Define red_fill with color red / fill type solid</p>
<pre><code class="language-markdown">red_fill = styles.PatternFill (start_color=red_color, end_color=red_color, fill_type='solid')
</code></pre>
<p><br>Define conditional formating for area, &lt;0, ⇒ fill with red background</p>
<pre><code class="language-markdown">ws.conditional_formatting.add ('A1:Z100',
	formatting.rule.CellIsRule (operator='lessThan',formula=['0'],fill=red_fill))
</code></pre>
<p><br>Define conditional formating for area, &lt;0, ⇒ use red font</p>
<pre><code class="language-markdown">ws.conditional_formatting.add ('A1:G25',
	formatting.rule.CellIsRule (operator='lessThan',formula=['0'],fill=red_fill,font=red_font))
</code></pre>
<p><br>Conditional formating for more than one area</p>
<pre><code class="language-markdown">for area in [&quot;B1:B100&quot;,&quot;C2:G100&quot;]:
	ws.conditional_formatting.add (area, ...)
</code></pre>
<p><br>Conditional formating according to a formula</p>
<pre><code class="language-markdown">ws.conditional_formatting.add('E1:E10',
	FormulaRule(formula=['ISBLANK(E1)'], stopIfTrue=True, fill=redFill))
</code></pre>
<p><br>Conditional formating according to a formula</p>
<pre><code class="language-markdown">ws.conditional_formatting.add('D2:D10',
	FormulaRule(formula=['E1=0'], font=myFont, border=myBorder, fill=redFill))
</code></pre>
<p><br>Color Scale formating</p>
<pre><code class="language-markdown"># Define rule
ruleBottomGreen = ColorScaleRule(
                        start_type='percentile', start_value=10, start_color=&quot;63BE7B&quot;, # green
                        mid_type='percentile', mid_value=50, mid_color= &quot;FFFB84&quot;, # yellow
                        end_type='percentile', end_value=90, end_color=&quot;F8696B&quot;) # red
# Apply rule
ws2.conditional_formatting.add(f&quot;K4:K12&quot;, ruleBottomGreen)
</code></pre>
<hr />
<h2 id="module---xlwings---working-on-the-fly-with-open-excel-worksheets">MODULE - XLWINGS - working on the fly with open excel worksheets</h2>
<p><a href="#python">jump to top...</a><br><br>
Update XLSX in reealtime<br>
Import module</p>
<pre><code class="language-markdown">import xlwings as xw
</code></pre>
<p>Use xlwings with hidden excel-worksheets</p>
<pre><code class="language-markdown">app = xw.App(visible=False)
</code></pre>
<p>Read XLSX</p>
<pre><code class="language-markdown">wb = xw.Book (&quot;name.xlsx&quot;)
</code></pre>
<p>Read XLSX with password protection</p>
<pre><code class="language-markdown">wb = xw.Book (&quot;name.xlsx&quot;, password(&quot;xyz&quot;))
</code></pre>
<p>Read specific worksheet</p>
<pre><code class="language-markdown">ws = wb.sheets[&quot;name_sheet&quot;]
</code></pre>
<p>Updates specific cell</p>
<pre><code class="language-markdown">ws[&quot;A1&quot;].value = &quot;xyz&quot;
</code></pre>
<p>Reads the formula of a cell (not the value)</p>
<pre><code class="language-markdown">f = ws[&quot;A1&quot;].formula
</code></pre>
<p>Iterate trough cells an set them to &quot;&quot; / None</p>
<pre><code class="language-markdown">for i in ws.range(&quot;A3:A7&quot;): i.value = &quot;&quot;
</code></pre>
<p>Sort worksheet in the first col (function see below)</p>
<pre><code class="language-markdown">xl_col_sort(ws,1)
</code></pre>
<p>Reads the color of a cell and returns a rgb-tuple eg. (146, 208, 80)</p>
<pre><code class="language-markdown">ws[&quot;C8&quot;].color
</code></pre>
<p>Remove background from a cell</p>
<pre><code class="language-markdown">ws[&quot;C8&quot;].color = None
</code></pre>
<p>White: Assigns background color for a range of cells</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (255,255,255)
</code></pre>
<p>Green: Assigns background color green</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (149,237,173)
</code></pre>
<p>Red: Assigns background color green</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (237,149,149)
</code></pre>
<p>Yellow: Assigns background color green</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (240,232,146)
</code></pre>
<p>Orange: Assigns background color green</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (230,172,80)
</code></pre>
<p>Blue: Assigns background color green</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).color = (143,157,235)
</code></pre>
<p>Assign numeric format with 2 decimals</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).number_format = &quot;0,00&quot;
</code></pre>
<p>Assign percentage format with 2 decimals</p>
<pre><code class="language-markdown">ws.range(&quot;A1:C3&quot;).number_format = &quot;0%&quot;
</code></pre>
<p>Set cell to bold</p>
<pre><code class="language-markdown">ws.range(&quot;B1&quot;).api.Font.Bold = True
</code></pre>
<p>Set font color to red (see codes: <a href="https://access-excel.tips/excel-vba-color-code-list/">https://access-excel.tips/excel-vba-color-code-list/</a>)</p>
<pre><code class="language-markdown">ws.range(&quot;B2&quot;).api.Font.ColorIndex = 3
</code></pre>
<p>Insert a hyperlink and define which text should be shown in the cell</p>
<pre><code class="language-markdown">ws[&quot;D5&quot;].add_hyperlink(link,text_to_display = &quot;Chart&quot;)
</code></pre>
<p>Disable auto filter in worksheet</p>
<pre><code class="language-markdown">ws.api.AutoFilterMode = False
</code></pre>
<p>Clears the content and formatting of the whole sheet</p>
<pre><code class="language-markdown">ws.clear()
</code></pre>
<p>Clears the content but leaves formatting</p>
<pre><code class="language-markdown">ws.clear_contents()
</code></pre>
<p>Read worksheetnames to list</p>
<pre><code class="language-markdown">l = [x.name for x in wb.sheets]
</code></pre>
<p>Add worksheet in workbook</p>
<pre><code class="language-markdown">wb.sheets.add(&quot;NewWS&quot;)
</code></pre>
<p>Delete worksheet in workbook</p>
<pre><code class="language-markdown">wb.sheets[&quot;OldWS].delete()
</code></pre>
<p>Hide worksheet in workbook</p>
<pre><code class="language-markdown">wb.sheets[&quot;WS&quot;].api.Visible = False
</code></pre>
<p>Save workbook</p>
<pre><code class="language-markdown">wb.save()
</code></pre>
<p>Close workbook</p>
<pre><code class="language-markdown">wb.close()
</code></pre>
<p>Quit App when opened at the beginning</p>
<pre><code class="language-markdown">app.quit()
</code></pre>
<p>ws.d
<br>Load elements in list from range which are not None</p>
<pre><code class="language-markdown">[x for x in ws.range(&quot;A3:A2000&quot;).value if x != None]
</code></pre>
<p>copy range from one sheet to another</p>
<pre><code class="language-markdown">ws.range(&quot;A1:A10&quot;).value = ws2.range(&quot;A1:A10&quot;).options(ndim=2).value
</code></pre>
<p><br>Make border / frame for cells
<br>Definiton for linestyles see: <a href="https://docs.microsoft.com/en-US/dotnet/api/microsoft.office.interop.excel.xllinestyle?view=excel-pia">https://docs.microsoft.com/en-US/dotnet/api/microsoft.office.interop.excel.xllinestyle?view=excel-pia</a>
<br>Definiton for border-sites see: <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.xlbordersindex">https://docs.microsoft.com/en-us/office/vba/api/excel.xlbordersindex</a></p>
<pre><code class="language-markdown">for e in ws.range(&quot;B3:D3&quot;):
  for site in [7,8,9,10]:
    e.api.Borders(site).LineStyle = 1
</code></pre>
<p><br>Update row / change whole row</p>
<pre><code class="language-markdown">l = ws.range(&quot;A2:A6&quot;).value         # Read specific cells to list (eg. [2,4,6,7,8])
l = [0,1,2,3,4]											# Change list
ws.range(&quot;A2:A100&quot;).value = l       # Writeback the updates to cells
</code></pre>
<p><br>Update cell area / change 3 elements</p>
<pre><code class="language-markdown">v = ws.range(&quot;A2:F9&quot;).value
v[3][2] = 9999999
v[5][1] = 8888888
v[7][5] = 5555555
ws.range(&quot;A2:F9&quot;).value = v
</code></pre>
<p><br>Sorting workssheet in given col</p>
<pre><code class="language-markdown">def xl_col_sort(sheet,col_num):
    sheet.range((2,col_num)).api.Sort(Key1=sheet.range((2,col_num)).api, Order1=1)
    return
</code></pre>
<p><br>Delete several rows / columns</p>
<pre><code class="language-markdown">from xlwings.constants import DeleteShiftDirection
ws.range('2:4').api.Delete(DeleteShiftDirection.xlShiftUp)      # delete rows 2 to 4
ws.range('A:C').api.Delete(DeleteShiftDirection.xlShiftUp)      # delete cols A to C
</code></pre>
<hr />
<h2 id="module---python-docx---working-with-word-docx">MODULE - PYTHON-DOCX - working with word docx</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import the module</p>
<pre><code class="language-markdown">import python-docx
</code></pre>
<p>Import the library</p>
<pre><code class="language-markdown">from docx import Document
</code></pre>
<p>Read file</p>
<pre><code class="language-markdown">doc = Document('file.docx')
</code></pre>
<p>Save file</p>
<pre><code class="language-markdown">doc.save('file.docx')
</code></pre>
<p>Read all tables</p>
<pre><code class="language-markdown">t = doc.tables
</code></pre>
<p>Access specific element in table</p>
<pre><code class="language-markdown">t[0].rows[0].cells[0].paragraphs[0].text
</code></pre>
<p>Assign style to specific paragraph</p>
<pre><code class="language-markdown">t[0].rows[0].cells[1].paragraphs[0].style
</code></pre>
<p>Read all paragraphs</p>
<pre><code class="language-markdown">p = doc.paragrapsh
</code></pre>
<p><br>Set the Normal style to specific font and size</p>
<pre><code class="language-markdown">(assigning it to specific paragraph see above)
from docx.shared import Pt
style = document.styles['Normal']
font = style.font
font.name = 'Arial'
font.size = Pt(10)
</code></pre>
<p><br>Replace text and keep the previous style</p>
<pre><code class="language-markdown">(iteration over runs necessary)
for para in doc.paragraphs:
  for run in para.runs:
    run.text = &quot;New Text&quot;
</code></pre>
<hr />
<h2 id="module---win32com---creating-worksheets-as-pdf-from-xlsx">MODULE - WIN32COM - creating worksheets as pdf from xlsx</h2>
<p><a href="#python">jump to top...</a><br><br>
Create Worksheets as PDF from XLSX<br>
Import Win32 Module</p>
<pre><code class="language-markdown">import win32com.client
</code></pre>
<p>Import OS Module</p>
<pre><code class="language-markdown">import os
</code></pre>
<p>Define Input-XLSX</p>
<pre><code class="language-markdown">inp = os.getcwd() + &quot;\\&quot; +&quot;excel.xlsx&quot;
</code></pre>
<p>Define Output-PDF</p>
<pre><code class="language-markdown">out = os.getcwd() + &quot;\\&quot; +&quot;ws.pdf&quot;
</code></pre>
<p>Initialize Excel Application</p>
<pre><code class="language-markdown">o = win32com.client.Dispatch(&quot;Excel.Application&quot;)
</code></pre>
<p>Do everything hidden</p>
<pre><code class="language-markdown">o.Visible = False
</code></pre>
<p>Open XLSX</p>
<pre><code class="language-markdown">wb = o.Workbooks.Open(inp)
</code></pre>
<p>Create PDF from the active worksheet in the xlsx</p>
<pre><code class="language-markdown">wb.ActiveSheet.ExportAsFixedFormat (0, out)
</code></pre>
<p>Close XLSX</p>
<pre><code class="language-markdown">wb.Close(True)
</code></pre>
<p>Number of Worksheets</p>
<pre><code class="language-markdown">wb.Sheets.Count
</code></pre>
<p>Select 3 different worksheets by number (for exporting afterwards)</p>
<pre><code class="language-markdown">wb.WorkSheets ([3,4,8]).Select()
</code></pre>
<p>Assign worksheet 4</p>
<pre><code class="language-markdown">ws = wb.Worksheets[4]
</code></pre>
<p>No Zooming</p>
<pre><code class="language-markdown">ws.PageSetup.Zoom = False
</code></pre>
<p>Fit to 1 height</p>
<pre><code class="language-markdown">ws.PageSetup.FitToPagesTall = 1
</code></pre>
<p>Fit to 1 width</p>
<pre><code class="language-markdown">ws.PageSetup.FitToPagesWide = 1
</code></pre>
<p>Select specific print area</p>
<pre><code class="language-markdown">ws.PageSetup.PrintArea = &quot;A1:G50&quot;
</code></pre>
<hr />
<h2 id="module---pypdf2---working-with-pdfs">MODULE - PyPDF2 - working with pdfs</h2>
<p><a href="#python">jump to top...</a><br><br>
Working with PDFs
<br>Read PDF informations / metadata</p>
<pre><code class="language-markdown">from PyPDF2 import PdfFileReader        # Import Module for PDF Reading
with open (fn, 'rb') as f:
    pdf = PdfFileReader (f)				# Read PDF informations
    info = pdf.getDocumentInfo ()		# Read PDF infos^
    number_of_pages = pdf.getNumPages ()    # Read number of pages
	print(info)							# Outputs all informations
	print(info.title)					# Outputs title of the pdf
	print(info.author)					# Outputs author of the pdf
</code></pre>
<p><br>Read Text from Pdf</p>
<pre><code class="language-markdown">page = pdf.getPage (7)		# Select page 8
text = page.extractText ()	# Extract text
print (text)				# print (text
</code></pre>
<p><br>Split PDFs</p>
<pre><code class="language-markdown">from PyPDF2 import PdfFileWriter		    # Import Module for PDF Writing
pdf_writer = PdfFileWriter()				# Create new instance of PDF writer
pdf_writer.addPage(page)                    # Add Page to writer
with open(output_filename, 'wb') as out:	# Write splitted PDF
	pdf_writer.write(out)
</code></pre>
<p><br>Merge PDFs</p>
<pre><code class="language-markdown">from PyPDF2 import PdfFileMerger		    # Import Module for PDF Merging
pdf_merger = PdfFileMerger()				# Create new instance of PDF merger
pdf_merger.append(path)                     # Append Page for merging
with open(output_path, 'wb') as fileobj:	# Write merged PDF
	pdf_merger.write(fileobj)
</code></pre>
<p><br>Rotate clockwise</p>
<pre><code class="language-markdown">page.rotateClockwise(90)
</code></pre>
<p>Rotate counter clockwise</p>
<pre><code class="language-markdown">page.rotateCounterClockwise(90)
</code></pre>
<p>Overlaying / Watermarking two pages</p>
<pre><code class="language-markdown">page.mergePage(watermark_page)
</code></pre>
<hr />
<h2 id="mysql---mariadb---heidisql">MYSQL - MARIADB - HEIDISQL</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Data where the MariaDB-database is stored</p>
<pre><code class="language-markdown">C:\Program Files\MariaDB 10.3\data
</code></pre>
<p>Data where the MySQL-database is stored</p>
<pre><code class="language-markdown">C:\ProgramData\MySQL\MYSQL Server 8.0\data
</code></pre>
<p>Shows the database-version in the column header</p>
<pre><code class="language-markdown">HeidiSQL - Datei / Verbindungsmanager
</code></pre>
<p><br>Transfer whole table from local db to hosted db</p>
<pre><code class="language-markdown">right click on database / table to transfer and select &quot;export database as sql&quot;
for &quot;output&quot; select eg. &quot;Server: A2Hosting&quot; (connection to the hosted server)
for &quot;database&quot; select eg. &quot;xyztec_stockdb&quot; (name from the db on the hosted server)
for &quot;data&quot; select &quot;replace existing data&quot;
when format of table should be changed also select checkbox &quot;Drop&quot; at table (not database!)
press &quot;export&quot; (wait till the rows-column shows 100%)
</code></pre>
<p><br>Backup MySQL / MariaDB with HeidiSQL
<br>see: <a href="https://manjaro.site/backup-mysql-database-using-heidisql/">https://manjaro.site/backup-mysql-database-using-heidisql/</a></p>
<pre><code class="language-markdown">select DB - &lt;Tools&gt;, &lt;Export Database as SQL&gt;
select Drop-Checkboxes and Create-Checkboxes
Data: Delete + insert (truncate existing data)
Output: single .sql file
Filename: choose destination file and folder
</code></pre>
<hr />
<h2 id="mysql---mariadb---sql">MYSQL - MARIADB - SQL</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Both modules have to be installed</p>
<pre><code class="language-markdown">pip install mysql, mysql.connector
</code></pre>
<p>Import module for mysql access</p>
<pre><code class="language-markdown">import mysql.connector
</code></pre>
<p>Define connection</p>
<pre><code class="language-markdown">mydb = mysql.connector.connect (host=&quot;localhost&quot;,user=&quot;root&quot;,passwd=&quot;pwd&quot;)
</code></pre>
<p>Set Cursor on mySQL</p>
<pre><code class="language-markdown">mycursor = mydb.cursor()
</code></pre>
<p>Creates database &quot;db&quot;</p>
<pre><code class="language-markdown">mycursor.execute(&quot;CREATE DATABASE db&quot;)
</code></pre>
<p><br>Show databases and informations</p>
<pre><code class="language-markdown">mycursor.execute(&quot;SHOW DATABASES&quot;)
    for db in mycursor: print(db)
</code></pre>
<p><br>Create new table with 2 cols</p>
<pre><code class="language-markdown">mycursor.execute(&quot;CREATE TABLE students (name VARCHAR(255),age INTEGER(10))&quot;)
</code></pre>
<p>Show tables and informations</p>
<pre><code class="language-markdown">mycursor.execute(&quot;SHOW TABLES&quot;) for tb in mycursor: print(tb)
</code></pre>
<p>Insert row in table with the 2 values using sql injection</p>
<pre><code class="language-markdown">sqlFormula = &quot;INSERT INTO students (name, age) VALUES (%s, %s)&quot;
</code></pre>
<p>Define a row with values to insert</p>
<pre><code class="language-markdown">student1 = (&quot;Rachel&quot;, 22)
</code></pre>
<p>Execute the sql statement to add one row</p>
<pre><code class="language-markdown">mycursor.execute(sqlFormula,student1)
</code></pre>
<p>Commit the change (otherwise no update will be saved to db)</p>
<pre><code class="language-markdown">mydb.commit()
</code></pre>
<p>Define more rows with values</p>
<pre><code class="language-markdown">students = [(&quot;Tom&quot;, 22),(&quot;Mark&quot;, 29),(&quot;Clara&quot;, 52)]
</code></pre>
<p>Execute the sql statement to add more row (from list / tuple)</p>
<pre><code class="language-markdown">mycursor.executemany(sqlFormula,students)
</code></pre>
<p>Select col &quot;age&quot; from table &quot;students&quot;</p>
<pre><code class="language-markdown">mycursor.execute(&quot;SELECT age FROM students&quot;)
</code></pre>
<p>Read all rows according the above select statement</p>
<pre><code class="language-markdown">myresult = mycursor.fetchall()
</code></pre>
<p>Read one / first row according the above select statement</p>
<pre><code class="language-markdown">myresult = mycursor.fetchone()
</code></pre>
<p>Output the read row / table informations</p>
<pre><code class="language-markdown">for row in myresult: print(row)
</code></pre>
<p>Define select (greater than)</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students WHERE age &gt; 25&quot;
</code></pre>
<p>Define select (with like clausel)</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students WHERE name LIKE 'M%'&quot;
</code></pre>
<p>Execute SQL</p>
<pre><code class="language-markdown">mycursor.execute(sql)
</code></pre>
<p>Define select (with sql injection)</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students WHERE name = %s&quot;
</code></pre>
<p>Execute SQL with parameters</p>
<pre><code class="language-markdown">mycursor.execute(sql, (&quot;Mike&quot;, ))
</code></pre>
<p>Update row where name = &quot;xyz&quot;</p>
<pre><code class="language-markdown">sql = &quot;UPDATE students SET age = 82 WHERE name='xyz'&quot;
</code></pre>
<p>Limit the output to 5 rows</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students LIMIT 5&quot;
</code></pre>
<p>Limit the output toi 5 rows and starting with element 2</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students LIMIT 5 OFFSET 2
</code></pre>
<p>Output content - ascending order</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students ORDER BY name&quot;
</code></pre>
<p>Output content - descending order</p>
<pre><code class="language-markdown">sql = &quot;SELECT * FROM students ORDER BY name DESC&quot;
</code></pre>
<p>Delete row with name &quot;xyz&quot;</p>
<pre><code class="language-markdown">sql = &quot;DELETE FROM students WHERE name = 'xyz'&quot;
</code></pre>
<p>Drop whole table (if exists helps if there no table anymore)</p>
<pre><code class="language-markdown">sql = &quot;DROP TABLE IF EXISTS students&quot;
</code></pre>
<p>Reset auto-increment in a table</p>
<pre><code class="language-markdown">ALTER TABLE mytable AUTO_INCREMENT=0
</code></pre>
<p>Delete the data inside a table</p>
<pre><code class="language-markdown">TRUNCATE TABLE tablename
</code></pre>
<p>Delete the data AND the whole table-structure itself</p>
<pre><code class="language-markdown">DROP TABLE tablename
</code></pre>
<p><br>SELECT ticker name for specific ticker</p>
<pre><code class="language-markdown">sql = &quot;SELECT tickerName FROM stock_main WHERE ticker=%s&quot;   # Or Select * to get all values from the table
var = [(stockTicker)]
c.execute(sql,var)
data = c.fetchall()
</code></pre>
<p><br>SELECT maximum calcDate for specific ticker</p>
<pre><code class="language-markdown">sql = &quot;SELECT max(calcDate) FROM scores WHERE ticker = %s&quot;
var = [(stock)]
c.execute (sql, var)
lastCalcDate = c.fetchone()
</code></pre>
<p><br>INSERT new row in a table</p>
<pre><code class="language-markdown">sql = &quot;INSERT INTO scores (&quot; \
    &quot;ticker,&quot; \
    &quot;calcDate,&quot; \
    &quot;stockName,&quot; \
    &quot;profitGrowth)&quot; \
    &quot; VALUES (%s,%s,%s,%s)&quot;  # as many %s necessary as insert attributes
cont = [inputList]          # list with 4 elements
c.execute (sql, cont)
mydb.commit ()
</code></pre>
<p><br>UPDATE row in a table</p>
<pre><code class="language-markdown">sql = &quot;UPDATE stock_statistics &quot; \
        &quot;SET &quot; \
        &quot;marketCap=%s,&quot; \
        &quot;EV=%s,&quot; \
        &quot;Ebitda=%s&quot; \
        &quot; WHERE ticker=%s AND ultimo=%s&quot;
cont = [(valMarketCap,
        valEV,
        valEbitda,
        stockTicker,
        ultimo)]
c.executemany (sql, cont)
mydb.commit ()
</code></pre>
<p><br>DELETE row in a table</p>
<pre><code class="language-markdown">sql = &quot;DELETE FROM scores&quot; \
    &quot; WHERE ticker = %s and calcDate = %s&quot;
cont = [stock,dateElem]
c.execute (sql, cont)
mydb.commit ()
</code></pre>
<hr />
<h2 id="sql-alchemy">SQL ALCHEMY</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import MODULE</p>
<pre><code class="language-markdown">from sqlalchemy import create_engine
</code></pre>
<p>necessary to install - otherwise problems eg. with api-accesses to the db</p>
<pre><code class="language-markdown">pip install pymysql
</code></pre>
<p>Define access to the MySQL-DB (username, pw, dbname)</p>
<pre><code class="language-markdown">engine = create_engine(&quot;mysql+pymysql: //user:pw@localhost/dbname?host=localhost?port=3306&quot;)
</code></pre>
<p>Establish connection</p>
<pre><code class="language-markdown">conn = engine.connect()
</code></pre>
<p>Read all existing tables from the databasen - returns list</p>
<pre><code class="language-markdown">engine.table_names()
</code></pre>
<p>Read data from db - returns list with tupels as rows</p>
<pre><code class="language-markdown">conn.execute(&quot;SELECT * FROM actor&quot;).fetchall()
</code></pre>
<p>Close connection at the end</p>
<pre><code class="language-markdown">conn.close()
</code></pre>
<p>Close sql engine at the end</p>
<pre><code class="language-markdown">engine.dispose()
</code></pre>
<p><br>Define object / table</p>
<pre><code class="language-markdown">from sqlalchemy import Table, Column, Integer, String, Float, MetaData
meta = MetaData()
students = Table(
   'students',
   meta,
   Column('id', Integer, primary_key = True),
   Column('name', String(45)),
   Column('lastname', String(45)),
)
</code></pre>
<p><br>Create the table(s) according to the metadata-definition</p>
<pre><code class="language-markdown">meta.create_all(engine)
</code></pre>
<p>name of the table ⇒ students</p>
<pre><code class="language-markdown">user_table.c.name
</code></pre>
<p>all column-names / keys as list ⇒ ['id', 'name', 'lastname']</p>
<pre><code class="language-markdown">user_table.c.keys()
</code></pre>
<p>shows the primary key of the object</p>
<pre><code class="language-markdown">user_table.primary_key
</code></pre>
<p><br>Create INSERT / UPDATE / DELETE / SELECT statements</p>
<pre><code class="language-markdown">students.insert()                                           # Creates INSERT Statement according due the whole students structure
	=&gt; shows: INSERT INTO students (id, name, lastname, floatvar) VALUES (:id, :name, :lastname, :floatvar)
students.insert().values(name = 'Karan')                    # Creates INSERT Statement for specific attribute
	=&gt; shows: INSERT INTO students (name) VALUES (:name)
students.update()                                           # Creates UPDATE Statement
	=&gt; shows: UPDATE students SET id=:id, name=:name, lastname=:lastname, floatvar=:floatvar
students.delete()                                           # Creates DELETE Statement
	=&gt; shows: DELETE FROM students
students.select()                                           # Creates SELECT Statement
	=&gt; shows: SELECT students.id, students.name, students.lastname, students.floatvar  FROM students
</code></pre>
<p><br>Execute SQL command - INSERT</p>
<pre><code class="language-markdown">conn = engine.connect()                                     # Insert one row
ins = students.insert().values (name = 'Brauneder', lastname = 'Karl')
result = conn.execute(ins)
result.inserted_primary_key                                 # Shows the inserted primary key
conn.execute(students.insert(), [                           # Insert more rows
   {'name':'Krankl', 'lastname' : 'Hans'},
   {'name':'Herzog','lastname' : 'Andreas'},
])
</code></pre>
<p><br>Execute SQL command - SELECT</p>
<pre><code class="language-markdown">s = students.select()                                       # Creates select statement for SELECT *
result = conn.execute(s)                                    # Excenute select statement
for row in result: print(row)                               # Outputs the result rows for select
s = students.select().where(students.c.id &gt; 10)             # Creates select statement with WHERE clausel
</code></pre>
<p><br>Execute SQL with Textual SQL</p>
<pre><code class="language-markdown">from sqlalchemy.sql import text
t = text(&quot;SELECT name FROM students&quot;)
result = conn.execute(t)
for row in result: print(row)
t = text(&quot;select students.name, students.lastname from students where students.name between :x and :y&quot;)
result = conn.execute(t, x = 'A', y = 'L')                  # Select statement with where-parameters
</code></pre>
<p><br>Using Aliases</p>
<pre><code class="language-markdown">from sqlalchemy.sql import alias, select
st = students.alias(&quot;a&quot;)
s = select([st]).where(st.c.id &gt; 2)
conn.execute(s).fetchall()
</code></pre>
<p><br>Execute UPDATE statement</p>
<pre><code class="language-markdown">conn = engine.connect()
stmt=students.update().where(students.c.lastname=='Khanna').values(lastname='Kapoor')
conn.execute(stmt)
s = students.select()
conn.execute(s).fetchall()
</code></pre>
<p><br>Execute DELETE statementconn = engine.connect()</p>
<pre><code class="language-markdown">stmt = students.delete().where(students.c.lastname == 'Khanna')
conn.execute(stmt)
s = students.select()
conn.execute(s).fetchall()
</code></pre>
<hr />
<h2 id="sqlite3-sql">SQLITE3 SQL</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Create a database or connect to one</p>
<pre><code class="language-markdown">conn = sqlite3.connect(&quot;address_book.db&quot;)
</code></pre>
<p>Create a cursor (for working with the db)</p>
<pre><code class="language-markdown">c = conn.cursor()
</code></pre>
<p><br>Create a table in the database</p>
<pre><code class="language-markdown">c.execute('''CREATE TABLE tbl (
		attr1 text,
		attr2 text,
		attr3 integer)''')
</code></pre>
<p><br>Insert rows into database</p>
<pre><code class="language-markdown">c.execute(INSERT INTO tbl VALUES (:attr1,:attr2,:attr3)&quot;,
		{
			&quot;attr1&quot;: field1.get(),
			&quot;attr2&quot;: field2.get(),
			&quot;attr3&quot;: field3.get()
		})
</code></pre>
<p><br>Select rows from database</p>
<pre><code class="language-markdown">c.execute&quot;SELECT * FROM adresses&quot;)
</code></pre>
<p>Delete row from database - get key from delete_box widget (eg. tkinter-module)</p>
<pre><code class="language-markdown">c.execute(&quot;DELETE from addresses WHERE oid = &quot; + delete_box.get())
</code></pre>
<p>Fetch all rows</p>
<pre><code class="language-markdown">records = c.fetchall()
</code></pre>
<p>Fetch only one row</p>
<pre><code class="language-markdown">c.fetchone()
</code></pre>
<p>Fetch the first 50 rows</p>
<pre><code class="language-markdown">records = c.fetchmany(50)
</code></pre>
<p>Commit Changes</p>
<pre><code class="language-markdown">conn.commit()
</code></pre>
<p>Close Connection</p>
<pre><code class="language-markdown">conn.close()
</code></pre>
<hr />
<h2 id="modules---dates-datetime-calendar-timeit-time-sys-ctypes">MODULES - DATES, DATETIME, CALENDAR, TIMEIT, TIME, SYS, CTYPES</h2>
<p><a href="#python">jump to top...</a><br><br>
Standardmodules from python no pip install necessary
<br>Overview % parsing commands
<a href="https://www.programiz.com/python-programming/datetime/strptime">https://www.programiz.com/python-programming/datetime/strptime</a>
<a href="https://rdrr.io/r/base/strptime.html">https://rdrr.io/r/base/strptime.html</a>
<br>Import module datetime and timedelta</p>
<pre><code class="language-markdown">from datetime import datetime, timedelta
</code></pre>
<p>Import module dat</p>
<pre><code class="language-markdown">from datetime import date
</code></pre>
<p>Conversion string to datetime in format yyyy-mm-dd</p>
<pre><code class="language-markdown">datetime.strptime(s, &quot;%Y-%m-%d&quot;)
</code></pre>
<p>Conversion for date format eg. &quot;Apr 21, 2020&quot;</p>
<pre><code class="language-markdown">datetime.strptime(s, &quot;%b %M, %Y&quot;)
</code></pre>
<p>Conversion for utc format eg. &quot;14:42:46 UTC 2021-12-15</p>
<pre><code class="language-markdown">datetime.strptime(s, &quot;%H:%M:%S UTC %Y-%m-%d&quot;)
</code></pre>
<p>Conversion datetime to string in format  yyyy-mm-dd</p>
<pre><code class="language-markdown">datetime.strftime(dt, &quot;%Y-%m-%d&quot;)
</code></pre>
<p>Convert dateformat from string in one line (1st from - 2nd to)</p>
<pre><code class="language-markdown">dt.strftime((dt.strptime(tmp,&quot;%m/%d/%Y&quot;)),&quot;%Y-%m-%d&quot;)
</code></pre>
<p>Check if variable is of type datetime.date or datetime.datetime</p>
<pre><code class="language-markdown">isinstance(x, date)
</code></pre>
<p>Check if variable is of type datetime.datetime</p>
<pre><code class="language-markdown">isinstance(x, datetime)
</code></pre>
<p>Define date as &quot;2020-07-24&quot;</p>
<pre><code class="language-markdown">date = date(2020,7,24)
</code></pre>
<p>Define date+time as &quot;2020-03-05 19:27:23&quot;</p>
<pre><code class="language-markdown">dt = datetime(2020,3,5,19,27,23)
</code></pre>
<p>Actual date+time in format 2020-06-09 20:11:13</p>
<pre><code class="language-markdown">now = datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)
</code></pre>
<p>Actual date in format 2020-06-09</p>
<pre><code class="language-markdown">now = datetime.now().strftime(&quot;%Y-%m-%d&quot;)
</code></pre>
<p>Actual date in datetime format</p>
<pre><code class="language-markdown">tday = datetime.today()
</code></pre>
<p>Actual date as date format</p>
<pre><code class="language-markdown">tday = datetime.today().date()
</code></pre>
<p>Actual date as string format</p>
<pre><code class="language-markdown">tday = str(datetime.today().date())
</code></pre>
<p>Convert datetime to date</p>
<pre><code class="language-markdown">date = datetime.date()
</code></pre>
<p>Year / month / day / hour / minute from the datetime</p>
<pre><code class="language-markdown">dt.year, dt.month, dt.day, dt.hour, dt.minute
</code></pre>
<p>Returns weekday (monday=1, sunday=7)</p>
<pre><code class="language-markdown">tday.isoweekday()
</code></pre>
<p>Calculates last friday (+2 for FR, +1 SA, 0 SU, -1 MO, -2 TU, -3 WE, -4 TH)</p>
<pre><code class="language-markdown">last_friday = day - timedelta(days=tday.isoweekday() + 2)
</code></pre>
<p>Creates timedelta for 7 days</p>
<pre><code class="language-markdown">tdelta = timedelta(days=7)
</code></pre>
<p>Creates timedelta for 1 minute</p>
<pre><code class="language-markdown">tdelta = timedelta(seconds=60)
</code></pre>
<p>7 days are added to the actual day</p>
<pre><code class="language-markdown">tday + tdelta
</code></pre>
<p>Previous 1-day-back-date for date</p>
<pre><code class="language-markdown">newdate = date - timedelta(days=1)
</code></pre>
<p>Timedelta for two dates</p>
<pre><code class="language-markdown">date2-date1
</code></pre>
<p>Difference in days</p>
<pre><code class="language-markdown">daysDiff = abs(dt2-dt1).days
</code></pre>
<p>Difference in minutes</p>
<pre><code class="language-markdown">minDiff = (date2-date1).total_seconds() / 60
</code></pre>
<p>Generate ISO-format from datetime</p>
<pre><code class="language-markdown">datetime.fromisoformat('2020-07-10 02:00:00').timestamp()
</code></pre>
<p>Generate ISO-format from actual date</p>
<pre><code class="language-markdown">iso_dt = datetime.fromisoformat(str(datetime.now())).timestamp()
</code></pre>
<p>Generate Datetime from ISO-format=&gt;</p>
<pre><code class="language-markdown">date = datetime.fromtimestamp(1594339200000 / 1e3)
</code></pre>
<p>Shows size of the list / tuple in bytes</p>
<pre><code class="language-markdown">sys.getsizeof(l) or sys.getsizeof(t)
</code></pre>
<p><br>Using german names / deutsche namen for month- and day-names</p>
<pre><code class="language-markdown">import locale
locale.setlocale(category=locale.LC_ALL,locale=&quot;German&quot;)
</code></pre>
<p><br>Check last day of month &amp; first weekday of month</p>
<pre><code class="language-markdown">import calendar
calendar.monthrange(year,month)                         # return tuple - 1st: weekday first day - 2nd: ultimo day
</code></pre>
<p><br>Check if date and timezone has summmer time / daylight time</p>
<pre><code class="language-markdown">import pytz
def is_dst(dt=None, timezone=&quot;UTC&quot;):
    if dt is None:
        dt = datetime.utcnow()
    timezone = pytz.timezone(timezone)
    timezone_aware_date = timezone.localize(dt, is_dst=None)
    return timezone_aware_date.tzinfo._dst.seconds != 0
is_dst()													# False =&gt; UTC has no daylight time
is_dst(datetime(2019, 1, 1), timezone=&quot;US/Eastern&quot;)			# False =&gt; at this date US/Eastern has no daylight time
is_dst(datetime(2019, 4, 1), timezone=&quot;US/Eastern&quot;)			# True =&gt; at this date US/Eastern has daylight time
is_dst(datetime(2019, 1, 1), timezone=&quot;CET&quot;)				# False =&gt; at this date CET has no daylight time
is_dst(datetime(2019, 4, 1), timezone=&quot;CET&quot;)				# True =&gt; at this date CET has daylight time
</code></pre>
<p><br>Timing a specific activity</p>
<pre><code class="language-markdown">import timeit
start = timeit.default_timer()                          # Start timer
stop = timeit.default_timer()                           # Stop timer
round(stop-start,2)										# Stopped time in seconds and rounded to 2 decimals
round((stop-start)/60,2)                                # Stopped time in minutes and rounded to 2 decimals
timeit.timeit(stmt=&quot;[0,1,2]&quot;,number=1000000)     		# Checking the time for creating the list for 1mio times
</code></pre>
<p><br>Countdown while waiting</p>
<pre><code class="language-markdown">import time, import sys
time.sleep(3)                                           # Delay for 3 seconds
for i in range (30, 0, -1):                             # Delay for 30 seconds - countdown in one row
    sys.stdout.write (str (i) + ' ')                    # Countdown output
    sys.stdout.flush ()
    time.sleep (1)
</code></pre>
<p><br>Check which os system running</p>
<pre><code class="language-markdown">from sys import platform
if platform == &quot;linux&quot;                                  # Program is excecuting from Linux
if platform == &quot;win32&quot;:                                 # Program ix excecuting from Windows
if platform == &quot;darwin&quot;:                                # Program is excecuting from Mac
</code></pre>
<p><br>Read monitor resolution</p>
<pre><code class="language-markdown">import ctypes
user32 = ctypes.windll.user32
screensize = user32.GetSystemMetrics(0),                # 1st parameter is width, 2nd parameter is height
    user32.GetSystemMetrics(1)
</code></pre>
<p><br>Wait for keystroke or x seconds</p>
<pre><code class="language-markdown">TIMEOUT = 10                # time / seconds for waiting
startTime = time.time()
inp = None
print(f&quot;Program finished - pls press &lt;enter&gt; to close the window or wait {round(TIMEOUT / 60, 2)} minutes...&quot;)
while True:
    if msvcrt.kbhit():                          # continue when pressing a key
        inp = msvcrt.getch()
        break
    elif time.time() - startTime &gt; TIMEOUT:     # continue when the time is running out
        break
</code></pre>
<hr />
<h2 id="module---currencyconverter---currency-conversion">MODULE - CURRENCYCONVERTER - currency conversion</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import Module</p>
<pre><code class="language-markdown">from currency_converter import CurrencyConverter
</code></pre>
<p>Import Module for rate-checks for specific date</p>
<pre><code class="language-markdown">from datetime import date
</code></pre>
<p>Read Function CurrencyConverter</p>
<pre><code class="language-markdown">c = CurrencyConverter()
</code></pre>
<p>Convert 100 USD to AUD with for actual date</p>
<pre><code class="language-markdown">c.convert(100, 'USD', 'AUD')
</code></pre>
<p>Convert 100 USD to AUD for date 2013-03-21</p>
<pre><code class="language-markdown">c.convert(100, 'USD', 'AUD', date=date(2013, 3, 21))
</code></pre>
<p>Check begin and end-date for all rates for BGN</p>
<pre><code class="language-markdown">first_date, last_date = c.bounds['BGN']
</code></pre>
<p>Read all possible currencies in a set</p>
<pre><code class="language-markdown">c.currencies
</code></pre>
<hr />
<h2 id="module---pycountry---countries-currency-language">MODULE - PYCOUNTRY - Countries, Currency, Language</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Description about the module</p>
<pre><code class="language-markdown">https://pypi.org/project/pycountry/
</code></pre>
<p>Problems with some added python modules (eg. pycountry) with pyinstaller ⇒ see pyinstaller description<br>
Install moduel</p>
<pre><code class="language-markdown">import pycountry
</code></pre>
<p>List of all countries with several informations</p>
<pre><code class="language-markdown">list(pycountry.countries)
</code></pre>
<p>Searching for country-informatns for &quot;DE&quot;</p>
<pre><code class="language-markdown">c = pycountry.countries.get(alpha_2='DE')
</code></pre>
<p>Outputs ⇒ DE</p>
<pre><code class="language-markdown">c.alpha_2
</code></pre>
<p>Outputs ⇒ DEU</p>
<pre><code class="language-markdown">c.alpha_3
</code></pre>
<p>Outputs number of the coutnry ⇒ 276</p>
<pre><code class="language-markdown">c.numeric
</code></pre>
<p>Outputs full name of the country ⇒ Germany</p>
<pre><code class="language-markdown">c.name
</code></pre>
<p>Outputs the official name ⇒ &quot;Federal Republic of Germany!</p>
<pre><code class="language-markdown">c.official_name
</code></pre>
<p>List of all currencies</p>
<pre><code class="language-markdown">list(pycountry.currencies)
</code></pre>
<p>List of all languages</p>
<pre><code class="language-markdown">list(pycountry.languages)
</code></pre>
<p>List of all historic countries which not more exists</p>
<pre><code class="language-markdown">list(pycountry.historic_countries)
</code></pre>
<p>List of all subdivided countries</p>
<pre><code class="language-markdown">list(pycountry.subdivisiones)
</code></pre>
<hr />
<h2 id="modules---smtplib-mimetext---sending-emails">MODULES - SMTPLIB, MIMEText - sending emails</h2>
<p><a href="#python">jump to top...</a><br><br>
sending emails
if you have 2-Factor-Authentification you must generate a App-Password for GMail<br>
Import smtplib</p>
<pre><code class="language-markdown">import smtplib
</code></pre>
<p>Import MIMEText</p>
<pre><code class="language-markdown">from email.mime.text import MIMEText
</code></pre>
<p>SMTP-Server and port number from the mail provider (e.g. GMail)</p>
<pre><code class="language-markdown">s = smtplib.SMTP('smtp.gmail.com', 587)
</code></pre>
<p>Response 250 means connection is ok</p>
<pre><code class="language-markdown">print(s.ehlo())
</code></pre>
<p>Response 250 means connection is ok</p>
<pre><code class="language-markdown">print(s.starttls())
</code></pre>
<p>Not the real pw - only the app-generated pw from gmail</p>
<pre><code class="language-markdown">print(s.login('sender@gmail.com', 'xyz123'))
</code></pre>
<p>Message of the email</p>
<pre><code class="language-markdown">msg = MIMEText(&quot;This is the text of the mail&quot;)
</code></pre>
<p>One recipient</p>
<pre><code class="language-markdown">sender = ['sender@gmail.com']
</code></pre>
<p>One or more recipient</p>
<pre><code class="language-markdown">recipients = ['recip1@gmail.com']
</code></pre>
<p>Or more recipients</p>
<pre><code class="language-markdown">recipients = ['recip1@gmail.com','recip2@r-software.at']
</code></pre>
<p>Subject</p>
<pre><code class="language-markdown">msg['Subject'] = &quot;Subject of Mail&quot;
</code></pre>
<p>From</p>
<pre><code class="language-markdown">msg['From'] = sender
</code></pre>
<p>One or more recipients</p>
<pre><code class="language-markdown">msg['To'] = &quot;, &quot;.join(recipients)
</code></pre>
<p>Sending email</p>
<pre><code class="language-markdown">s.sendmail(sender, recipients, msg.as_string())
</code></pre>
<p>Closing connection</p>
<pre><code class="language-markdown">s.quit()
</code></pre>
<hr />
<h2 id="module---pathlib---interacting-with-the-operating-system">MODULE - PATHLIB - interacting with the operating system</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import module</p>
<pre><code class="language-markdown">from pathlib import Path
</code></pre>
<p>Current working directory</p>
<pre><code class="language-markdown">Path.cwd()
</code></pre>
<p>Creates new folder (no error message if folder allready exists with exist_ok=True)</p>
<pre><code class="language-markdown">Path(&quot;folder&quot;).mkdir(parents=True, exist_ok=True)
</code></pre>
<p>define some folder</p>
<pre><code class="language-markdown">path = Path(&quot;some_folder&quot;)
</code></pre>
<p>add some subfolders (eg. some_folder/sub_folder/sub_sub_folder)</p>
<pre><code class="language-markdown">path = path / &quot;sub_folder&quot; / &quot;sub_sub_folder&quot;
</code></pre>
<p>make path absolute</p>
<pre><code class="language-markdown">path = path.resolve()
</code></pre>
<p><br>get mac-adress from the actual pc</p>
<pre><code class="language-markdown">from uuid import getnode as get_mac
mac = get_mac()
</code></pre>
<hr />
<h2 id="module---os-shutil-filecmp-dircmp---interacting-with-the-operating-system">MODULE - OS, SHUTIL, FILECMP, DIRCMP - interacting with the operating system</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import module</p>
<pre><code class="language-markdown">import os
</code></pre>
<p>Shows alls attributs and methods of the library</p>
<pre><code class="language-markdown">print(dir(os))
</code></pre>
<p>Change the directory</p>
<pre><code class="language-markdown">os.chdir(&quot;C:/temp&quot;)
</code></pre>
<p>Current working directory</p>
<pre><code class="language-markdown">os.getcwd()
</code></pre>
<p>Get actual user name</p>
<pre><code class="language-markdown">os.getlogin()
</code></pre>
<p>Outputs the entire content of the current working dir</p>
<pre><code class="language-markdown">for f in os.listdir(): print(f)
</code></pre>
<p>Outputs the elements seperated in name + extension</p>
<pre><code class="language-markdown">for f in os.listdir(): fn, ext = os.path.splitext(f)
</code></pre>
<p>Change the filenmae</p>
<pre><code class="language-markdown">os.rename(filename, new_name)
</code></pre>
<p>Cut and paste file from path1 to path2</p>
<pre><code class="language-markdown">os.rename(path1+fn, path2+fn)
</code></pre>
<p>Copy file from source to destination</p>
<pre><code class="language-markdown">shutil.copyfile(&quot;src&quot;,&quot;dst&quot;)
</code></pre>
<p>Creates new folder (also possible with makedirs ⇒ is prefered)</p>
<pre><code class="language-markdown">os.mkdir(&quot;folder&quot;)
</code></pre>
<p>Creates new folder and subfolders</p>
<pre><code class="language-markdown">os.makedirs(&quot;folder/subfolder&quot;)
</code></pre>
<p>Delete file</p>
<pre><code class="language-markdown">os.remove (file)
</code></pre>
<p>Delete folder (prefered cause deleting ist dangerous)</p>
<pre><code class="language-markdown">os.rmdir (&quot;folder&quot;)
</code></pre>
<p>Delete folder and subfolders</p>
<pre><code class="language-markdown">os.removedirs (&quot;folder/subfolder&quot;)
</code></pre>
<p>Outputs the statistics of the file (size, modification time,...)</p>
<pre><code class="language-markdown">os.stat(&quot;file&quot;)
</code></pre>
<p>Outputs dirpath - all the dirs - and all the files</p>
<pre><code class="language-markdown">for dirpath,dir,files in os.walk(os.getcwd())
</code></pre>
<p>Get home dir of the actual user</p>
<pre><code class="language-markdown">os.environ.get(&quot;HOME&quot;)
</code></pre>
<p>Outputs only the filename ⇒ file.txt</p>
<pre><code class="language-markdown">os.path.basename(&quot;temp/file.txt&quot;)
</code></pre>
<p>Outputs only the dir ⇒ temp/</p>
<pre><code class="language-markdown">os.path.dirname(&quot;temp/file.txt&quot;)
</code></pre>
<p>Outputs filename and dir as a tupel ⇒ (&quot;temp/&quot;,&quot;file.txt&quot;)</p>
<pre><code class="language-markdown">os.path.split(&quot;temp/file.txt&quot;)
</code></pre>
<p>Checks if filename exists in the filesystem</p>
<pre><code class="language-markdown">os.path.exists(&quot;temp/file.txt&quot;)
</code></pre>
<p>Checks if folder exists / element is a directory (in the actual dir)</p>
<pre><code class="language-markdown">os.path.isdir(&quot;xyz&quot;)
</code></pre>
<p>Checks if files exists / element is a file (in the actual dir)</p>
<pre><code class="language-markdown">os.path.isfile(&quot;xyz&quot;)
</code></pre>
<p>Put all filenames to a list from the actual working dir</p>
<pre><code class="language-markdown">os.listdir()
</code></pre>
<p>Put all sub-folders to a list from the actual working dir</p>
<pre><code class="language-markdown">[x[0] for x in os.walk(path)][1:]
</code></pre>
<p>Change file to hidden</p>
<pre><code class="language-markdown">os.popen('attrib +h ' + fn).read().close()
</code></pre>
<p><br>Put all files in a list from actual directory with all subdirs and Filtering</p>
<pre><code class="language-markdown">listExtensions=[&quot;jpg&quot;,&quot;jpeg&quot;,&quot;png&quot;]
listImages = []
for dirpath,dir,files in os.walk(os.getcwd()):
  for f in files:
    if any(x in f.lower() for x in listExtensions):
      listImages.append(f)
</code></pre>
<p><br>Find home-directory for the actual user</p>
<pre><code class="language-markdown">from os.path import expanduser
home = expanduser(&quot;~&quot;)
</code></pre>
<p><br>Check if 2 folders are different</p>
<pre><code class="language-markdown">from filecmp import dircmp
ergDiff = dircmp(path, toPath)          # compare 2 directories
if ergDiff.left_only: ...               # see all changed files on the left side
</code></pre>
<hr />
<h2 id="module---logging">MODULE - LOGGING</h2>
<p><a href="#python">jump to top...</a><br><br>
general Logging Layers: debug ⇒ info ⇒ warning ⇒ error ⇒ critical<br>
importing module</p>
<pre><code class="language-markdown">import logging
</code></pre>
<p>Create &amp; Config - w overwrites every time</p>
<pre><code class="language-markdown">logging.basicConfig(filename=&quot;fn.log&quot;,format='%(asctime)s %(message)s', filemode='w')
</code></pre>
<p>Level every log &gt; INFO possible (but not DEBUG)</p>
<pre><code class="language-markdown">logging.basicConfig(filename=&quot;fn.log&quot;,level=logging.INFO)
</code></pre>
<p>getLogger-Name / Level / Time / Message</p>
<pre><code class="language-markdown">...format=&quot;%(name)&quot;s-%(levelname)s:%(asctime)s-%(message)s
</code></pre>
<p>Creating an object with specific name</p>
<pre><code class="language-markdown">logger=logging.getLogger(logname)
</code></pre>
<p>Setting the threshold of logger to DEBUG</p>
<pre><code class="language-markdown">logger.setLevel(logging.DEBUG)
</code></pre>
<p>Debug message</p>
<pre><code class="language-markdown">logger.debug(&quot;Harmless debug Message&quot;)
</code></pre>
<p>Info message</p>
<pre><code class="language-markdown">logger.info(&quot;Just an information&quot;)
</code></pre>
<p>Warning message</p>
<pre><code class="language-markdown">logger.warning(&quot;Its a Warning&quot;)
</code></pre>
<p>Error message</p>
<pre><code class="language-markdown">logger.error(&quot;Did you try to divide by zero&quot;)
</code></pre>
<p>Critical error message</p>
<pre><code class="language-markdown">logger.critical(&quot;Internet is down&quot;)
</code></pre>
<p><br>Example with 2 logging levels</p>
<pre><code class="language-markdown">logger=logging.getLogger(__name__)							 # Creating an object with the name of the py-file
stream_h = logging.StreamHandler()							 # Defining a handler for streamdata in the console
file_h = logging FileHandler(&quot;file.log&quot;						 # Defining a handler for logging to a file
stream_h.setLevel(logging.WARNING)							 # Set Stream-Logging to Warning-Level
file_h.setLevel(logging.ERROR)								 # Set File-Logging to Error-Level
	=&gt; Error-Messages will go to both stream and file - Warning-Messages only to stream and not to file
formatter = logging.formatter								 # Defining the format for outputting
	&quot;%(name)s - %(levelname)s - %(message)s&quot;)
stream_h.setFormatter(formatter)							 # Setting format for stream-logging
file_h.setFormatter(formatter)								 # Setting format for file-logging
logger.addHandler(stream_h)									 # Adding Stream-handler to logger
logger.addHandler(file_h)									 # Adding File-handler to logger
</code></pre>
<p><br>logging using RotatingFileHandler
<br>https://stackoverflow.com/questions/24505145/how-to-limit-log-file-size-in-python	# Explanation about handling</p>
<pre><code class="language-markdown">from logging.handlers import RotatingFileHandler             # importing file handler
log_formatter = logging.Formatter('%(asctime)s               # Define format for output in logfile
    %(levelname)s %(funcName)s(%(lineno)d) %(message)s')
my_handler = RotatingFileHandler(logFile, mode='a',          # Define handler with maxBytes and backupCount
    maxBytes=5*1024*1024, backupCount=2, encoding=None,      # When the log grows more then maxBytes...
    delay=0)                                                 # ...itgenerates a new logfile-version
my_handler.setFormatter(log_formatter)                       # Setting the format
my_handler.setLevel(logging.INFO)                            # Setting the threshold of logger to INFO
logger = logging.getLogger('root')                           # Creating an object with name
logger.setLevel(logging.INFO)                                # Setting the threshold of logger to INFO
logger.addHandler(my_handler)                                # Define handler with definition above
</code></pre>
<hr />
<h2 id="module---unittest">MODULE - UNITTEST</h2>
<p><a href="#python">jump to top...</a><br><br>
many methods: <a href="https://docs.python.org/3/library/unittest.html">https://docs.python.org/3/library/unittest.html</a><br>
Importing module</p>
<pre><code class="language-markdown">import unittest
</code></pre>
<p>Import the function which will be tested</p>
<pre><code class="language-markdown">from prg import func
</code></pre>
<p>Define the class for testing the function</p>
<pre><code class="language-markdown">class TestFunc(unittest.TestCase):
</code></pre>
<p>Define the first testcase - must begin with test*</p>
<pre><code class="language-markdown">def testcase1(self):
</code></pre>
<p>call the function</p>
<pre><code class="language-markdown">erg = func(&quot;x&quot;,3)
</code></pre>
<p>check if result is ok</p>
<pre><code class="language-markdown">self.assertEqual(&quot;3x&quot;)
</code></pre>
<p>starting the unittest</p>
<pre><code class="language-markdown">if __name__ == '__main__': unittest.main()
</code></pre>
<p>Check if equal</p>
<pre><code class="language-markdown">self.assertEqual(a,b)
</code></pre>
<p>Check if not equal</p>
<pre><code class="language-markdown">self.assertNotEquale(a,b)
</code></pre>
<p>Check if true</p>
<pre><code class="language-markdown">self.assertTrue(x)
</code></pre>
<p>Check if false</p>
<pre><code class="language-markdown">self.assertFalse(x)
</code></pre>
<p>Check if i in list</p>
<pre><code class="language-markdown">self.assertIn(i,list)
</code></pre>
<p>Check if i not in list</p>
<pre><code class="language-markdown">self.assertNotIn(i,list)
</code></pre>
<hr />
<h2 id="module---dotenv---hide-environment-informations">MODULE - DOTENV - hide environment informations</h2>
<p><a href="#python">jump to top...</a><br><br>
Installation: pip install python-dotenv
<br>create .env file and store sensible data in the form TOKEN=xyz123
<br>and hide the *.env files in the .gitignore</p>
<pre><code class="language-markdown">pip install python-dotenv
from dotenv import load_dotenv, find_dotenv
import os
load_dotenv(find_dotenv())
GMAIL_TOKEN = os.environ.get(&quot;GMAIL_TOKEN&quot;)
</code></pre>
<hr />
<h2 id="module---collections---counter-defaultdic">MODULE - COLLECTIONS - counter, defaultdic</h2>
<p><a href="#python">jump to top...</a><br><br>
Counter, namedtuple, OrderedDict, defaultdict, deque</p>
<p><br>COUNTER</p>
<pre><code class="language-markdown">from collections import Counter
colors = ['blue', 'blue', 'red', 'red', &quot;red&quot;]
counter = Counter(colors)									# Creates dict with counts =&gt; {'red': 3, 'blue': 2} in ordered form
counter.most_common(1) 		                           		# Outputs the element with the most counts as tuple
counter[&quot;red&quot;})            		                            # Outputs the occurence of the value &quot;red&quot; =&gt; 3
</code></pre>
<p><br>NAMEDTUPLE</p>
<pre><code class="language-markdown">from collections import namedtuple
Point = namedtuple(&quot;Point&quot;,&quot;x,y&quot;)							# Creates class with tumple
pt = Point(1,-4)											# Creates Point(x=1,y=-4)
print(pt.x, pt.y)											# Shows 1 and -4
</code></pre>
<p><br>ORDEREDDICT</p>
<pre><code class="language-markdown">not necessary anymore in the newer python versions
is allready implemented in the regular dict-type)
</code></pre>
<p><br>DEFAULTDIC</p>
<pre><code class="language-markdown">d = defaultdict(int)	# Create defaultdict and define default-type
d[&quot;xyz&quot;]				# No key error when when key not in the dict =&gt; default-type value 0 is outputed
</code></pre>
<p><br>DEQUE</p>
<pre><code class="language-markdown">from collections import deque      # import collections deque module
d = deque()				# Create deque (optimized for working with elements at the end or beginning of the list)
d.append(1)				# Add element at the end
d.appendleft(2)			# Add element at the beginning
d.extend([1,2]			# Add list of elements at the end
d.extendleft([1,2])		# Add list of elements at the beginning (in reversed order so 2,1)
d.pop()					# Delete element at the end
d.popleft()				# Delete element at the beginning
d.clear()				# Clear entire list
d.rotate(2)				# Shift all elements 2 places to the right
d.rotateleft(-1)			# Shift all elements 1 place to the left
</code></pre>
<hr />
<h2 id="module---itertools---products-combinations">MODULE - ITERTOOLS - products, combinations</h2>
<p><a href="#python">jump to top...</a><br><br></p>
<ul>
<li>product, permutations, combinations, accumulate, groupby, infinite iterators
<br>- from itertools import product, permutations, combinations, combinations_with_replacement, accumulate, groupby</li>
<li>from itertools import count, cycle, repeat<br>
necessary for the func-operator</li>
</ul>
<pre><code class="language-markdown">import operator
</code></pre>
<p>all combis for carthesian product ⇒ [(1,3),(1,4),(2,3),(2,4)]</p>
<pre><code class="language-markdown">product([1,2],[3,4])
</code></pre>
<p>all with 3 elements ⇒ (0,0,0),(0,0,1),(0,1,0),(0,1,1), aso.</p>
<pre><code class="language-markdown">product([0, 1], repeat=3)
</code></pre>
<p>all combis of this 2 strings ⇒ [(&quot;a&quot;,&quot;1&quot;),(&quot;a&quot;,&quot;2&quot;),(&quot;b&quot;,&quot;1&quot;),(&quot;b&quot;,&quot;2&quot;)]</p>
<pre><code class="language-markdown">product('ab', '12')
</code></pre>
<p>all different orderings ⇒ [(1,2,3),(1,3,2),(2,1,3),(2,3,1),(3,1,2),(3,2,1)]</p>
<pre><code class="language-markdown">permutations ([1,2,3])
</code></pre>
<p>all different orderings with 2 elements ⇒ [(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)]</p>
<pre><code class="language-markdown">permutations([1,2,3],2)
</code></pre>
<p>all possible combis for a defined length ⇒ [(1,2),(1,3),(1,4),(2,3),(2,4),(3,4)]</p>
<pre><code class="language-markdown">combinations([1,2,3,4],2)
</code></pre>
<p>all combis also with itself ⇒ [(1,1),(1,2),(1,3),(2,2),(2,3),(3,3)]</p>
<pre><code class="language-markdown">combinations_with_replacement([1,2,3],2)
</code></pre>
<p>accumulates every number with the next ⇒ [1,3,6,10]</p>
<pre><code class="language-markdown">accumulate([1,2,3,4])
</code></pre>
<p>using operator .mul for multiplication every number the next ⇒ [1,2,6,24]</p>
<pre><code class="language-markdown">accumulate([1,2,3,4], func=operator.mul)
</code></pre>
<p>compares every entry to the maximum ⇒ [1,2,5,5,5]</p>
<pre><code class="language-markdown">accumulate([1,2,5,3,4], func=max)
</code></pre>
<p>gives interabel - groups by the func ⇒ True[1,2], False[3]</p>
<pre><code class="language-markdown">groupby([1,2,3],key=func_smaller3)
</code></pre>
<p>same thing - with a lambda operation ⇒ True[1,2], False[3]</p>
<pre><code class="language-markdown">grougpy([1,2,3],key=lambda x: x&lt;3)
</code></pre>
<p>infinite loop starting at 10 (has to be ended with break sometimes)</p>
<pre><code class="language-markdown">for i in count(10)
</code></pre>
<p>infinite cycle through the list (has to be ended with break sometimes)</p>
<pre><code class="language-markdown">for i in cycle([1,2,3])
</code></pre>
<p>infinite loop with 1</p>
<pre><code class="language-markdown">for i in repeat(1)
</code></pre>
<p>loop with 1 for 4 times</p>
<pre><code class="language-markdown">for i in repeat(1,4)
</code></pre>
<p>fastest way to change an column in a dataframe (over 400x faster then iterrows)</p>
<pre><code class="language-markdown">df = df['col'].apply(lambda x: x.strip())
</code></pre>
<hr />
<h2 id="module---numpy---basis-for-different-other-modules">MODULE - NUMPY - basis for different other modules</h2>
<p><a href="#python">jump to top...</a><br><br></p>
<ul>
<li>memory efficient, working in the background used by other modules
<br>- using only the bits which are necessary for each column (1 is stored in python with 24bytes - in numpy with 1byte or lesser)</li>
<li>shape of array has to be consistent - otherwise it just fall back to regular python objects eg. [[12,11],[13]]<br>
Import numpy module with np abbreviation</li>
</ul>
<pre><code class="language-markdown">import numpy as np
</code></pre>
<p>Using arrays, types and slicing<br>
Define a numpy array (automatically with type int)</p>
<pre><code class="language-markdown">a = np.array([1,2,3,4])
</code></pre>
<p>Multiindexing in arrays possible ⇒ gives array/[0.,1.,2.])</p>
<pre><code class="language-markdown">a[[0,2,-1]]
</code></pre>
<p>Defines a numpy array with datatype float (and not int)</p>
<pre><code class="language-markdown">np.array([1,2,3,4]),dtype=np.float)
</code></pre>
<p>Defines a 2d numpy array</p>
<pre><code class="language-markdown">a = np.array([[1,2,3],[4,5,6],[7,8,9])
</code></pre>
<p>Returns dimension shape ⇒ (3,3)</p>
<pre><code class="language-markdown">a.shape
</code></pre>
<p>Returns number of dimensions ⇒ 2</p>
<pre><code class="language-markdown">a.ndim
</code></pre>
<p>Returns total number of elements ⇒ 9</p>
<pre><code class="language-markdown">a.size
</code></pre>
<p>Gives / slices the second row ⇒ [4,5,6]</p>
<pre><code class="language-markdown">a[1]
</code></pre>
<p>Gives / slices the second row and first element ⇒ 4</p>
<pre><code class="language-markdown">a[1,0]
</code></pre>
<p>Slices the first 2 rows ⇒ array([[1,2,3],[4,5,6]])</p>
<pre><code class="language-markdown">a[0:2]
</code></pre>
<p>Slices all row with first 2 elements ⇒ array([[1,2],[4,5],[7,8]])</p>
<pre><code class="language-markdown">a[:,:2]
</code></pre>
<p>Slices first 2 rows and first 2 elements ⇒ array([[1,2],[4,5]])</p>
<pre><code class="language-markdown">a[:2,:2]
</code></pre>
<p>Slices first 2 rows and last element ⇒ array([[3],[6]])</p>
<pre><code class="language-markdown">a[:2,2:]
</code></pre>
<p>Changes content of second row ⇒ array([[1,2,3],[9,9,9],[7,8,9])</p>
<pre><code class="language-markdown">a[1] = np.array([9,9,9])
</code></pre>
<p>Changes content of third row (for all elements) ⇒ array([[1,2,3],[4,5,6],[8,8,8])</p>
<pre><code class="language-markdown">a[2] = 8
</code></pre>
<p>Builds the sum of all elements ⇒ 45</p>
<pre><code class="language-markdown">a.sum()
</code></pre>
<p>⇒ 5.0</p>
<pre><code class="language-markdown">a.mean()
</code></pre>
<p>Return standard deviation ⇒ 2.58198889774344</p>
<pre><code class="language-markdown">a.std()
</code></pre>
<p>Builds sum per columns ⇒ array([12,15,18])</p>
<pre><code class="language-markdown">a.sum(axis=0)
</code></pre>
<p>Builds sum per rows ⇒ array([6,15,24])</p>
<pre><code class="language-markdown">a.sum(axis=1)
</code></pre>
<p>Initialize numpy array with 5 zeros ⇒ array([0.,0.,0.,0.,0.])</p>
<pre><code class="language-markdown">np.zeroes(5)
</code></pre>
<p>Initialize numpy array with 2x3 ones with int32 ⇒ array([[0,0,0],[0,0,0]])</p>
<pre><code class="language-markdown">np.ones((2,3),dtype=&quot;int32&quot;)
</code></pre>
<p>Initialize np array with 2x2 with the value 99 ⇒ array([[99,99],[99,99]])</p>
<pre><code class="language-markdown">np.full((2,2,),99)
</code></pre>
<p>Initialize a square matrix with len 3 ⇒ array([[1.,0.,0.],[0.,1.,0.],[0.,0.,1.]])</p>
<pre><code class="language-markdown">np.identity(3)
</code></pre>
<p>Separate individual copy of the numpy array (no updates in both arrays)</p>
<pre><code class="language-markdown">arr_b = arr_a.copy()
</code></pre>
<p>Define 2d numpy array with 2,4 dimension</p>
<pre><code class="language-markdown">c = np.array([[1,2,3,4],[5,6,7,8]])
</code></pre>
<p>Reshape the numpy array to 4,2 dimension ⇒ [[1,2],[3,4],[5,6],[7,8]]</p>
<pre><code class="language-markdown">c.reshape((4,2))
</code></pre>
<p>Reshape the numpy array to 3d with 2,2,2 dimension ⇒ [[[1,2],[3,4]],[5,6],[7,8]]]</p>
<pre><code class="language-markdown">c.reshape((2,2,2))
</code></pre>
<p>Convert numpy datetime64 to str (can afterwards be converted with strptime to datetime</p>
<pre><code class="language-markdown">dt = str(dt64).split(&quot;T&quot;)[0]
</code></pre>
<p>Vector handling<br>
Build array with this range ⇒ array([0,1,2,3])</p>
<pre><code class="language-markdown">a = np.array(4)
</code></pre>
<p>Changes +10 to each element ⇒ array([10,11,12,13]) (creates new array - no changing a)</p>
<pre><code class="language-markdown">a + 10
</code></pre>
<p>Changes *10 to each element ⇒ array([0,10,20,30]) (creates new array - no changing a)</p>
<pre><code class="language-markdown">a * 10
</code></pre>
<p>Changes the existing array a ⇒ array([100,101,102,103])</p>
<pre><code class="language-markdown">a += 100
</code></pre>
<p>Defines second array babab6</p>
<pre><code class="language-markdown">b = np.array([10,10,10,10])
</code></pre>
<p>Sums the 2 arrays to new array ⇒ array([10,11,12,13)</p>
<pre><code class="language-markdown">a + b
</code></pre>
<p>Multiplicates the 2 arrays to new array ⇒ array([0,10,20,30)</p>
<pre><code class="language-markdown">a * b
</code></pre>
<p>Make sinus of all entries</p>
<pre><code class="language-markdown">np.sin(b)
</code></pre>
<p>Make cosinus of all entries</p>
<pre><code class="language-markdown">np.cos(b)
</code></pre>
<p>Boolean Array Operations<br>
Build array with this range ⇒ array([0,1,2,3])</p>
<pre><code class="language-markdown">a = np.array(4)
</code></pre>
<p>Selecting items with boolean expressions - returns first and last element ⇒ array([0,3])</p>
<pre><code class="language-markdown">a[True,False,False,True]
</code></pre>
<p>Use operation on the array ⇒ array([False,False,True,True])</p>
<pre><code class="language-markdown">a &gt;= 2
</code></pre>
<p>Using operation for slicing ⇒ array([2,3])</p>
<pre><code class="language-markdown">a[a &gt;= 2]
</code></pre>
<p>Gives back all elements which are greater than the mean ⇒ array([2,3])</p>
<pre><code class="language-markdown">a[a &gt; a.mean()]
</code></pre>
<p>Gives back all elements which are NOT greater than the mean ⇒ array([0,1])</p>
<pre><code class="language-markdown">a[~(a &gt; a.mean())]
</code></pre>
<p>Gives back all elements which are equal to 0 OR 1 ⇒ array([0,1])</p>
<pre><code class="language-markdown">a[(a==0) | (a==1)]
</code></pre>
<p>Gives back all elements which are ⇐2 and have no rest divided by 2 ⇒ array([0,2])</p>
<pre><code class="language-markdown">a[(a &lt;= 2) &amp; (a % 2 == 0)]
</code></pre>
<p>Creating random arrays<br>
Random 1d float array with 3 entries ⇒ eg. (0.8377, 0.8720, 0,7784)</p>
<pre><code class="language-markdown">np.random.rand(3)
</code></pre>
<p>Random 2d array 3 entries ⇒ [[0.27,0.91,0.54],[0.68,0.87,0.36],[0.05,0.64,0.16]]</p>
<pre><code class="language-markdown">np.random.rand(3,3)
</code></pre>
<p>Random 1d int array 3 entries ⇒ [0,8,8]</p>
<pre><code class="language-markdown">np.random.randint(0,10,3)
</code></pre>
<p>Random 2d int array 3x4 entries ⇒ [[2,6,4,5],[7,6,7,3],[7,0,4,0]]</p>
<pre><code class="language-markdown">np.random.randint(0,10,(3,4))
</code></pre>
<p>Random 2d int array 3x3 entries with values from 0 to 99</p>
<pre><code class="language-markdown">np.random.randint(100, size(3,3))
</code></pre>
<p>Random 2d int array 3x3 entries with values from -4 to 7</p>
<pre><code class="language-markdown">np.random.randint(-4,8,size(3,3))
</code></pre>
<p>Shuffeling a 2d list but only the first axes</p>
<pre><code class="language-markdown">np.random.shuffle(lst)
</code></pre>
<p>Can reproduce the same results</p>
<pre><code class="language-markdown">np.random.seed(1)
</code></pre>
<hr />
<h2 id="module---pandas---analyzing-and-working-with-data">MODULE - PANDAS - analyzing and working with data</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>examples</p>
<pre><code class="language-markdown">https://gist.github.com/why-not/4582705
</code></pre>
<p>Import Module</p>
<pre><code class="language-markdown">import pandas as pd
</code></pre>
<p>Also importing numpy-module necessary</p>
<pre><code class="language-markdown">import numpy as np
</code></pre>
<p>Necessary for supressing performance warnings see below</p>
<pre><code class="language-markdown">import warnings
</code></pre>
<p>Show more information - count of the shown columns</p>
<pre><code class="language-markdown">pd.set_option('display.max_columns',11)
</code></pre>
<p>Show more information - show all columns</p>
<pre><code class="language-markdown">pd.set_option('display.max_columns',None)
</code></pre>
<p>Show more information - None is using the maximum width of the IDE</p>
<pre><code class="language-markdown">pd.set_option('display.width', None)
</code></pre>
<p>Supress Performance Warnings</p>
<pre><code class="language-markdown">warnings.simplefilter(action='ignore', category=pd.errors.PerformanceWarning)
</code></pre>
<p>SERIES<br>
Define a series</p>
<pre><code class="language-markdown">s = pd.Series([35,63,81,61,127,65,319])
</code></pre>
<p>Shows default-index in 1 row / values in 2 row - also the dtype: int64 at the bottom</p>
<pre><code class="language-markdown">print(s)
</code></pre>
<p>Name the series (shows the name also when series i printed at the bottom</p>
<pre><code class="language-markdown">s.name = &quot;G7 population in millions&quot;
</code></pre>
<p>Shows the dtype of the series ⇒ dtype(&quot;int64&quot;)</p>
<pre><code class="language-markdown">s.dtype
</code></pre>
<p>Values of the series ⇒ array([35,63,81,61,127,65,319])</p>
<pre><code class="language-markdown">s.values
</code></pre>
<p>Slicing element ⇒ 35</p>
<pre><code class="language-markdown">s[0]
</code></pre>
<p>Shows the index of the series ⇒ RangeIndex(start=0, stop=7, step=1)</p>
<pre><code class="language-markdown">s.index
</code></pre>
<p>Shows first index-value</p>
<pre><code class="language-markdown">s.index[0]
</code></pre>
<p>Change the index of the series from default 0-6 to country-names</p>
<pre><code class="language-markdown">s.index=[&quot;CAN&quot;,&quot;FRA&quot;,&quot;GER&quot;,&quot;ITA&quot;,&quot;JPN&quot;,&quot;UK&quot;,&quot;USA]
</code></pre>
<p>Accessing now with the new index possible ⇒ 81</p>
<pre><code class="language-markdown">s[&quot;GER&quot;]
</code></pre>
<p>Access with index still possible using iloc ⇒ 35</p>
<pre><code class="language-markdown">s.iloc[0]
</code></pre>
<p>Access with index still possible using iloc ⇒ 319</p>
<pre><code class="language-markdown">s.iloc[-1]
</code></pre>
<p>Multiple selecting possible ⇒ GER 81 and JPN 127</p>
<pre><code class="language-markdown">s.[&quot;GER&quot;,&quot;JPN&quot;]
</code></pre>
<p>Multiple selecting with index using iloc possible ⇒ CAN 35 and USA 319</p>
<pre><code class="language-markdown">s.iloc[0,-1]
</code></pre>
<p>Multiple selecting with &quot;:&quot; - upper element is included ⇒ CAN 35, FRA 63, GER 81</p>
<pre><code class="language-markdown">s.[&quot;CAN&quot;:&quot;GER&quot;]
</code></pre>
<p>Add 10 for the every element in the series ⇒ ([45,73,91,71,137,75,329])</p>
<pre><code class="language-markdown">s + 10
</code></pre>
<p>Using boolean operation to output every element ⇒ GER 81, JPN 127, USA 319</p>
<pre><code class="language-markdown">s[s &gt; 70]
</code></pre>
<p>Using boolean operation to output countries &gt; mean ⇒ JPN 127, USA 319</p>
<pre><code class="language-markdown">s[s &gt; s.mean()]
</code></pre>
<p>~ for not, | for or, &amp; for and</p>
<pre><code class="language-markdown">logical operator which can be used
</code></pre>
<p>Changing the value of a series element ⇒ CAN 40</p>
<pre><code class="language-markdown">s[&quot;CAN&quot;] = 40
</code></pre>
<p>Changing the value of the last element ⇒ USA 500</p>
<pre><code class="language-markdown">s.iloc[-1] = 500
</code></pre>
<p>Changing the value with a specific operation ⇒ CAN,FRA,ITA,UK are changed to 99</p>
<pre><code class="language-markdown">s[s &lt; 70] = 99
</code></pre>
<p>Define a series with NaN values</p>
<pre><code class="language-markdown">s = pd.Series([1,np.nan,7]
</code></pre>
<p>Check for NaN values in the series ⇒ False,True,False</p>
<pre><code class="language-markdown">d.isnull()
</code></pre>
<p>Check for NOT NaN values in the series ⇒ True,False,True</p>
<pre><code class="language-markdown">s.notnull()
</code></pre>
<p>Sum of not NaN values in the series ⇒ 2</p>
<pre><code class="language-markdown">s.notnull().sum()
</code></pre>
<p>Sum of NaN values in the series ⇒ 1</p>
<pre><code class="language-markdown">s.isnull().sum()
</code></pre>
<p>Outputs all entries which are not NaN</p>
<pre><code class="language-markdown">s.[s.notnull()]
</code></pre>
<p>Delete all entries with NaN</p>
<pre><code class="language-markdown">s.dropna()
</code></pre>
<p>Replace the NaN-values with 0</p>
<pre><code class="language-markdown">s.fillna(0)
</code></pre>
<p>Replace the NaN-values with the meanvalue of the serie</p>
<pre><code class="language-markdown">s.fillna(s.mean())
</code></pre>
<p>With forward-fill the NaN-values are replaced with the value before (if the first i gets NaN)</p>
<pre><code class="language-markdown">s.fillna(method=&quot;ffill&quot;)
</code></pre>
<p>With backward-fill the NaN-values are replaced with the value after (if the last i gets NaN)</p>
<pre><code class="language-markdown">s.fillna(method=&quot;bfill&quot;)
</code></pre>
<p>Returns the duplicates (only the first entry for the same is no duplicate - rest gets True)</p>
<pre><code class="language-markdown">s.duplicated()
</code></pre>
<p>Returns the duplicates (only the last entry for the same value is no duplicate - rest gets True)</p>
<pre><code class="language-markdown">s.duplicated(keep=&quot;last&quot;)
</code></pre>
<p>Returns the duplicates (when there are more than one value - all get flagged as duplicate with True)</p>
<pre><code class="language-markdown">s.duplicated(keep=False)
</code></pre>
<p>Duplicates get dropped (only the first entry remains)</p>
<pre><code class="language-markdown">s.drop_duplicates()
</code></pre>
<p>Duplicates get dropped (only the last entry remains)</p>
<pre><code class="language-markdown">s.drop_duplicates(keep=&quot;last&quot;)
</code></pre>
<p>Duplicates get dropped (no entry remains if there are duplicate entries for the value)</p>
<pre><code class="language-markdown">s.drop_duplicates(keep=False)
</code></pre>
<p>Sorting by value ascending</p>
<pre><code class="language-markdown">s.sort_values()
</code></pre>
<p>Sorting by value descending</p>
<pre><code class="language-markdown">s.sort_values(ascending=False)
</code></pre>
<p>Iterate through pandas series</p>
<pre><code class="language-markdown">for index, value in s.items():
</code></pre>
<p>Get element from series - if not found is the result &quot;N/A&quot;</p>
<pre><code class="language-markdown">erg = s.get(&quot;Entry&quot;,&quot;N/A)
</code></pre>
<p>Delete timezone from timestamp</p>
<pre><code class="language-markdown">.index.tz_localize(None)
</code></pre>
<p>Convert pandas timestamp to datetime</p>
<pre><code class="language-markdown">dt = dt.to_pydatetime()
</code></pre>
<p>Convert datetime to pandas timestamp</p>
<pre><code class="language-markdown">dt = pd.Timestamp(dt)
</code></pre>
<p><br>DATAFRAMES
<br>are immutable, column is a series, dataframe = combination of multiple series
<br>reading data
<br>possible reader: read_csv,read_excel,read_json,read_html,read_sql
<br>possible writer: to_csv,to_excel,to_json,to_html,to_sql</p>
<p>CSV<br>
Shows all parameters for the reader</p>
<pre><code class="language-markdown">pf.read_csv?
</code></pre>
<p>Read csv into dataframe - first line will be col-names of the dataframe</p>
<pre><code class="language-markdown">df = pd.read_csv(&quot;fn.csv&quot;)
</code></pre>
<p>Read csv into dataframe - no headerline (col names will be default numeric)</p>
<pre><code class="language-markdown">df = pd.read_csv(&quot;fn.csv&quot;,header=None)
</code></pre>
<p>&quot;)							⇒ Read csv with sepeartor &quot;=&gt;&quot; instead of the default &quot;;&quot;</p>
<pre><code class="language-markdown">df = pd.read_csv(&quot;fn.csv&quot;,sep=&quot;
</code></pre>
<p>Many operations can be directly done when reading the csv-file</p>
<pre><code class="language-markdown">df = pd.read_csv(&quot;fn.csv&quot;,
</code></pre>
<p>⇒ no header in the csv available</p>
<pre><code class="language-markdown">header=None
</code></pre>
<p>⇒ name the columns</p>
<pre><code class="language-markdown">names=[&quot;Timestamp&quot;,&quot;Price&quot;],
</code></pre>
<p>⇒ define which column will be the index</p>
<pre><code class="language-markdown">index_col=0,
</code></pre>
<p>⇒ read dates as date - and not as string</p>
<pre><code class="language-markdown">parse_dates=True,
</code></pre>
<p>⇒ treat this chars as NaN-values</p>
<pre><code class="language-markdown">na_values[&quot;?&quot;,&quot;-&quot;,&quot;&quot;],
</code></pre>
<p>⇒ assign specific datatype to the column &quot;Price&quot;</p>
<pre><code class="language-markdown">dtype={&quot;Price&quot;:&quot;float&quot;},
</code></pre>
<p>⇒ decimal-point is &quot;,&quot; (and not &quot;.&quot;)</p>
<pre><code class="language-markdown">decimal=&quot;,&quot;,
</code></pre>
<p>⇒ read also blank lines (as default they are ignored)</p>
<pre><code class="language-markdown">skip_blank_lines=False),
</code></pre>
<p>⇒ use only the three columns when reading the csv (by position)</p>
<pre><code class="language-markdown">usecols=[0,1,2],
</code></pre>
<p>⇒ use only the three columns when reading the csv (selected by name)</p>
<pre><code class="language-markdown">usecols=[&quot;first&quot;,&quot;last&quot;,&quot;age&quot;])
</code></pre>
<p>Write dataframe to csv</p>
<pre><code class="language-markdown">df.to_csv(&quot;fn2.csv&quot;)
</code></pre>
<p>XLSX<br>
Read xlsx (first worksheet) into dataframe</p>
<pre><code class="language-markdown">df = pd.read_excel(&quot;file.xlsx&quot;)
</code></pre>
<p>Read xlsx (first worksheet) into dataframe - without headers</p>
<pre><code class="language-markdown">df = pd.read_excel(&quot;file.xlsx&quot;,header=None)
</code></pre>
<p>Read xlsx and define the first column as index of the dataframe</p>
<pre><code class="language-markdown">df = pd.read_excel(&quot;file.xlsx&quot;,index_col=[0])
</code></pre>
<p>Read xlsx (worksheet &quot;Prod&quot;) into dataframe</p>
<pre><code class="language-markdown">df = pd.read_excel(&quot;file.xlsx&quot;,sheet_name=&quot;Prod&quot;)
</code></pre>
<p>Read xlsx with the ExcelFile method</p>
<pre><code class="language-markdown">ef = pd.ExcelFile(&quot;file.xlsx&quot;)
</code></pre>
<p>Shows alle worksheet-names as a list ⇒ eg. [&quot;Prod&quot;,&quot;Desc&quot;]</p>
<pre><code class="language-markdown">ef.sheet_names
</code></pre>
<p>Read/Parse the worksheet &quot;Prod&quot; in a dataframe</p>
<pre><code class="language-markdown">df = ef.parse(&quot;Prod&quot;)
</code></pre>
<p><br>Write several dataframes to excel</p>
<pre><code class="language-markdown"># Create a Pandas Excel writer using XlsxWriter as the engine.
writer = pd.ExcelWriter('basisReadData.xlsx', engine='xlsxwriter')

# Write each dataframe to a different worksheet.
quandlMain.to_excel(writer, sheet_name=&quot;quandlMain&quot;),
quandlMain2.to_excel(writer, sheet_name=&quot;quandlMain_From2018_MRT&quot;)

# Write also in this form
with pd.ExcelWriter(&quot;example.xlsx&quot;) as writer:
    df.to_excel(writer, sheet_name=&quot;coinPrices&quot;)

# Close the Pandas Excel writer and output the Excel file.
writer.save()
</code></pre>
<p>SQL<br>
Establish connection to the sql-db</p>
<pre><code class="language-markdown">conn = sqlite3.connect(&quot;data.db&quot;)
</code></pre>
<p>Read data from sql-db into dataframe</p>
<pre><code class="language-markdown">df = pd.read_sql(&quot;SELECT * FROM empl;&quot;,conn)
</code></pre>
<p><br>Many operations can be directly done when reading the sql-db</p>
<pre><code class="language-markdown">df = pd.read_sql(&quot;SELECT * FROM empl;&quot;,conn,
	index_col=&quot;EmplID&quot;,										    # define which column will be the index
	parse_dates[&quot;BirthDate&quot;,&quot;HireDate&quot;])			# read this columns as date
</code></pre>
<p><br>It is easier to read a complete table using sqlalechmy</p>
<pre><code class="language-markdown">from sqlalchemy import create_engine
</code></pre>
<p>Create SQL Alchemy engine</p>
<pre><code class="language-markdown">engine = create_engine(&quot;data.db&quot;)
</code></pre>
<p>Establish connection with SQL Alchemy</p>
<pre><code class="language-markdown">connection = engine.connect()
</code></pre>
<p>Read whole table with SQL-Alechmy (many things are auto-done - e.g. Indexing,Parsing)</p>
<pre><code class="language-markdown">df = pd.read_sql_table(&quot;empl&quot;,con=connection)
</code></pre>
<p>Writes dataframe to the sql-db (breaks when table allready exists)</p>
<pre><code class="language-markdown">df.to_sql(&quot;data.db&quot;,conn)
</code></pre>
<p>Writes dataframe to the sql-db (with droping the table before inserting)</p>
<pre><code class="language-markdown">df.to_sql(&quot;data.db&quot;,conn,if_exists=&quot;replace&quot;)
</code></pre>
<p>Writes dataframe to the sql-db (with inserting new values to existing table)</p>
<pre><code class="language-markdown">df.to_sql(&quot;data.db&quot;,conn,if_exists=&quot;append&quot;)
</code></pre>
<p>HTML<br>
Read html into dataframe</p>
<pre><code class="language-markdown">df = pd.read_html(html_string)
</code></pre>
<p>Assign html-varialbe</p>
<pre><code class="language-markdown">html_url&quot;https://www.xyz.com&quot;
</code></pre>
<p>Read html-link to dataframe</p>
<pre><code class="language-markdown">df = pd.read_html(html_url)
</code></pre>
<p>DICT, LIST<br>
Creates a dataframe from a list of dicts ⇒ [{...},{...},{...}]</p>
<pre><code class="language-markdown">df = pd.DateFrame(l)
</code></pre>
<p>Create a dataframe for a dict</p>
<pre><code class="language-markdown">df = pd.DataFrame.from_dict(d, orient=&quot;index&quot;)
</code></pre>
<p><br>EXAMPLE</p>
<pre><code class="language-markdown">https://www.freecodecamp.org/learn/data-analysis-with-python/data-analysis-with-python-course/pandas-condtitional-selection-and-modifying-dataframes
    Popl	HDI		Continent
CAN	35		0,913	America
FRA	64		0,888	Europe
GER	81		0,916	Europe
ITA 61		0,873	Europe
JPN 127		0,891	Asia
UK  65		0,907	Europe
USA 319		0,915	America
</code></pre>
<p><br>Initialize a dataframe with random ints with 5 rows and 2 columns</p>
<pre><code class="language-markdown">df = pd.DataFrame(np.random.randint(0,5,size=(5, 2)), columns=list('AB'))
</code></pre>
<p>Create an empty dataframe</p>
<pre><code class="language-markdown">df = pd.DataFrame()
</code></pre>
<p>Creates a dataframe from a list of dicts ⇒ [{...},{...},{...}]</p>
<pre><code class="language-markdown">df = pd.DateFrame(l)
</code></pre>
<p>Create a dataframe for a dict</p>
<pre><code class="language-markdown">df = pd.DataFrame.from_dict(d, orient=&quot;index&quot;)
</code></pre>
<p>Check if datafram is empty</p>
<pre><code class="language-markdown">if df.empty:
</code></pre>
<p>Show the shape of the dataframe (rows, columns) ⇒ (7,3)</p>
<pre><code class="language-markdown">df.shape
</code></pre>
<p>Info for columns (index,name,dtype) also count of NaN-values per column</p>
<pre><code class="language-markdown">df.info()
</code></pre>
<p>Shows datatype of every column</p>
<pre><code class="language-markdown">df.dtypes()
</code></pre>
<p>Several statistic for the dataframe (median,max,min,std,...)</p>
<pre><code class="language-markdown">df.describe()
</code></pre>
<p>Output of the first 5 rows per default</p>
<pre><code class="language-markdown">df.head()
</code></pre>
<p>Output of the first 22 rows</p>
<pre><code class="language-markdown">df.head(22)
</code></pre>
<p>Output of the last 5 rows per default</p>
<pre><code class="language-markdown">df.tail()
</code></pre>
<p>Output of the last 22 rows</p>
<pre><code class="language-markdown">df.tail(22)
</code></pre>
<p>Output of all column names</p>
<pre><code class="language-markdown">df.columns
</code></pre>
<p>Outputs the index</p>
<pre><code class="language-markdown">df.index
</code></pre>
<p>Set index to column &quot;name&quot;</p>
<pre><code class="language-markdown">df.index = df[&quot;name&quot;]
</code></pre>
<p>Outputs the size of the dataframe</p>
<pre><code class="language-markdown">df.size
</code></pre>
<p>Resets the index to numeric (previous index exists as column)</p>
<pre><code class="language-markdown">df.reset_index(drop=False)
</code></pre>
<p>Resets the index to numeric (previous index is deleted)</p>
<pre><code class="language-markdown">df.reset_index(drop=True)
</code></pre>
<p>Define &quot;Popl&quot; as new index - with inplace it is permanently saved</p>
<pre><code class="language-markdown">df.set_index(&quot;Popl&quot;, inplace=True)
</code></pre>
<p>Selecting Rows by index - showing the row with the index = &quot;CAN&quot;</p>
<pre><code class="language-markdown">df.loc[&quot;CAN&quot;]
</code></pre>
<p>Selecting Rows by position - showing the last row</p>
<pre><code class="language-markdown">df.iloc[-1]
</code></pre>
<p>Selecting Columns by title - showing the whole column &quot;Population&quot; for all rows</p>
<pre><code class="language-markdown">df[&quot;Popl&quot;]
</code></pre>
<p>df[&quot;Continent&quot;].value_  # fill motor city input
print(f&quot;Create filtering for Motor City Input AM...&quot;)
filt = (dfInpAM[&quot;Lab&quot;] == &quot;US-Motor City&quot;)
filt2 = (dfInpAM[&quot;Status&quot;] == &quot;In Production&quot;)
dfMCI = dfInpAM[filt &amp; filt2]
<br>Output of alle values with their count</p>
<pre><code class="language-markdown">dfMCI[&quot;ReceivedTime&quot;]= dfMCI[&quot;ReceivedTime&quot;].astype(str)    counts()
</code></pre>
<p>Output of alle values with their count in percent</p>
<pre><code class="language-markdown">df[&quot;Continent&quot;].value_counts(normalize=True)
</code></pre>
<p>Showing cols Popl,Continent for all rows</p>
<pre><code class="language-markdown">df[[&quot;Popl&quot;,&quot;Continent&quot;]]
</code></pre>
<p>Showing cols Popl,Continent for all rows - values divided by 100</p>
<pre><code class="language-markdown">df[[&quot;Popl&quot;,&quot;Continent&quot;]] / 100
</code></pre>
<p>Show the rows from index CAN to ITA</p>
<pre><code class="language-markdown">df.loc[&quot;CAN&quot;:&quot;ITA&quot;]
</code></pre>
<p>Show the rows from index CAN to ITA - only with the column1</p>
<pre><code class="language-markdown">df.loc[&quot;CAN&quot;:&quot;ITA&quot;,&quot;Popl&quot;]
</code></pre>
<p>Show the rows from index CAN to ITA - only with the column1 + column3</p>
<pre><code class="language-markdown">df.loc[&quot;CAN&quot;:&quot;ITA&quot;,[&quot;Popl&quot;,&quot;Continent&quot;]]
</code></pre>
<p>Show the columns col1 to col4 for all rows</p>
<pre><code class="language-markdown">df.loc[:,&quot;col1&quot;:&quot;col4&quot;]
</code></pre>
<p>Show the columns col1 to col4 for 3 rows from index 0 to 2 (2 included)</p>
<pre><code class="language-markdown">df.loc[0:2,&quot;col1&quot;:&quot;col4&quot;]
</code></pre>
<p>Show the columns cols 1 and 3 for the rows from index 0 to 2 (2 included)</p>
<pre><code class="language-markdown">df.loc[0:2,[&quot;col1&quot;,&quot;col3&quot;]]
</code></pre>
<p>Show the 1st and last row ⇒ CAN,USA</p>
<pre><code class="language-markdown">df.iloc[0,-1]
</code></pre>
<p>Show 2nd and 3rd row for all cols ⇒ FRA,GER / Popl,HDI,Continent</p>
<pre><code class="language-markdown">df.iloc[1:3]
</code></pre>
<p>Show 2nd and 3rd row for 2nd col ⇒ FRA,GER / HDI</p>
<pre><code class="language-markdown">df.iloc[1:3,1]
</code></pre>
<p>Show 2nd and 3rd row for 1st and 3rd column ⇒ FRA,GER / Popl,Continent</p>
<pre><code class="language-markdown">df.iloc[1:3,[0,2]}
</code></pre>
<p>Show 2nd and 3rd row for the 2nd and 3rd col ⇒ FRA,GER / HDI,Continent</p>
<pre><code class="language-markdown">df.iloc[1:3,1:3]
</code></pre>
<p>Returns GER,JPN,USA for all cols</p>
<pre><code class="language-markdown">df.loc[(df[&quot;Popl&quot;] &gt; 70	)]
</code></pre>
<p>Returns GER,JPN,USA for col &quot;Popl&quot;</p>
<pre><code class="language-markdown">df.loc[df[&quot;Popl&quot;] &gt; 70, &quot;Popl&quot;]
</code></pre>
<p>Returns GER,JPN,USA for cols &quot;Popl&quot; and &quot;Continent&quot;</p>
<pre><code class="language-markdown">df.loc[df[&quot;Popl&quot;] &gt; 70, [&quot;Popl&quot;,&quot;Continent&quot;]]
</code></pre>
<p>Output of 2 columns for the column slice</p>
<pre><code class="language-markdown">df[[&quot;Open&quot;,&quot;Close&quot;]][&quot;2010&quot;:&quot;2020&quot;]
</code></pre>
<p>Output specific rows and slice of columns</p>
<pre><code class="language-markdown">df[df.index.isin([&quot;2020&quot;,&quot;2019&quot;])][hist.columns[0:4]]
</code></pre>
<p>Output specific rows and columns</p>
<pre><code class="language-markdown">df[df.index.isin([&quot;2020&quot;,&quot;2019&quot;])][[&quot;Open&quot;,&quot;Close&quot;]]
</code></pre>
<p>Drops the row CAN</p>
<pre><code class="language-markdown">df.drop(&quot;CAN&quot;)
</code></pre>
<p>Drops the rows CAN,JPN</p>
<pre><code class="language-markdown">df.drop([&quot;CAN&quot;,&quot;JPN&quot;])
</code></pre>
<p>Drops the rows CAN,JPN (2nd method)</p>
<pre><code class="language-markdown">df.drop([&quot;CAN&quot;,&quot;JPN&quot;],axis=0)
</code></pre>
<p>Drops the rows CAN,JPN (3rd method)</p>
<pre><code class="language-markdown">df.drop([&quot;CAN&quot;,&quot;JPN&quot;],axis=&quot;rows&quot;)
</code></pre>
<p>Drops the cols Popl,Continent</p>
<pre><code class="language-markdown">df.drop(columns=[&quot;Popl&quot;,&quot;Continent&quot;])
</code></pre>
<p>Drops the cols</p>
<pre><code class="language-markdown">df.drop(df.columns[1,2,5,9],axis=1)
</code></pre>
<p>Drops the cols Popl,Continent (2nd method)</p>
<pre><code class="language-markdown">df.drop([&quot;Popl&quot;,&quot;Continent&quot;],axis=1)
</code></pre>
<p>Drops the cols Popl,Continent (3rd method)</p>
<pre><code class="language-markdown">df.drop([&quot;Popl&quot;,&quot;Continent&quot;],axis=&quot;columns&quot;)
</code></pre>
<p>Drops the whole dataframe</p>
<pre><code class="language-markdown">df.drop(df.index, inplace=True)
</code></pre>
<p>Define series with same col-names as in the dataframe - with some correction values</p>
<pre><code class="language-markdown">crisis = pd.Series([-10,-0,3],index=[&quot;Popl&quot;,&quot;HDI&quot;])
</code></pre>
<p>Comines crisis-series to the df ⇒ all values in &quot;Popl&quot; -10 and &quot;HDI&quot; -0,3 in the df</p>
<pre><code class="language-markdown">df[[&quot;Popl&quot;,&quot;HDI&quot;]] + crisis
</code></pre>
<p><br>Define new series for new column in dataframe</p>
<pre><code class="language-markdown">langs = pd.Series(
	[&quot;FR&quot;,&quot;DE&quot;,&quot;IT&quot;],           # values of new column
	index=[&quot;FRA&quot;,&quot;GER&quot;,&quot;ITA&quot;],  # existing index in dataframe
	name= &quot;lang&quot;)               # name of the new column
</code></pre>
<p><br>Creates new column in the dataframe according to the series &quot;langs&quot; - other rows will get &quot;NaN&quot;</p>
<pre><code class="language-markdown">df[&quot;lang&quot;] = langs
</code></pre>
<p>Values of all rows in the column &quot;lang&quot; will be changed to &quot;GB&quot;</p>
<pre><code class="language-markdown">df[&quot;lang&quot;] = &quot;GB&quot;
</code></pre>
<p>Renames column names</p>
<pre><code class="language-markdown">df.rename(columns={&quot;Popl&quot;:&quot;POPL&quot;,&quot;Continent&quot;:&quot;CONT&quot;})
</code></pre>
<p>Renames index names</p>
<pre><code class="language-markdown">df.rename(index={&quot;UK&quot;:&quot;UnKi&quot;,&quot;USA&quot;:&quot;US&quot;})
</code></pre>
<p>Creates new column by dividing col &quot;Popl&quot; with col &quot;HDI&quot;</p>
<pre><code class="language-markdown">df[&quot;Popl_HDI&quot;] = df[&quot;Popl&quot;] / df[&quot;HDI&quot;]
</code></pre>
<p>Different operations for the column in the dataframe</p>
<pre><code class="language-markdown">df[&quot;Popl&quot;].median().max().min().sum().mean().qunatile()
</code></pre>
<p>Changes Timestamp-String to Timestamp-Type (eg. read from csv-file before)</p>
<pre><code class="language-markdown">df[&quot;Timestamp&quot;]=pd.to_datetime(df[&quot;Timestamp&quot;])
</code></pre>
<p>Plotting the dataframe using the mathlib-module</p>
<pre><code class="language-markdown">df.plot()
</code></pre>
<p>Plot the dataframe</p>
<pre><code class="language-markdown">df.plot(figsize=(12,6))
</code></pre>
<p>Plot the dataframe for the specific timeframe</p>
<pre><code class="language-markdown">df.loc[&quot;2017-12-01&quot;:&quot;2019-12-01&quot;].plot(figsize=(12,6)))
</code></pre>
<p>Check for NaN values in the Dataframe ⇒ Matrix with True / False</p>
<pre><code class="language-markdown">df.isnull()
</code></pre>
<p>Check for NOT NaN values in the Series ⇒ Matrix with True / False</p>
<pre><code class="language-markdown">df.notnull()
</code></pre>
<p>Sum of NaN values per column</p>
<pre><code class="language-markdown">df.isnull().sum()
</code></pre>
<p>Deleting all rows with at least one NaN value in it</p>
<pre><code class="language-markdown">df.dropna()
</code></pre>
<p>Deleting all columns with at least one NaN value in it</p>
<pre><code class="language-markdown">df.dropna(axis=1)
</code></pre>
<p>Deleting all rows where all columns are NaN</p>
<pre><code class="language-markdown">df.dropna(how=&quot;all&quot;)
</code></pre>
<p>Deleting all rows where at least 3 columns are NOT NaN</p>
<pre><code class="language-markdown">df.dropna(thresh=3)
</code></pre>
<p>Replace NaN values with text</p>
<pre><code class="language-markdown">df.fillna(&quot;missing&quot;)
</code></pre>
<p>Replace NaN values with 0</p>
<pre><code class="language-markdown">df.fillna(0)
</code></pre>
<p>With forward-fill NaN-values are replaced with the value before (axis=0 means vertical / per column)</p>
<pre><code class="language-markdown">df.fillna(method=&quot;ffill&quot;,axis=0)
</code></pre>
<p>With forward-fill NaN-values are replaced with the value before (axis=0 means horizontal / per row)</p>
<pre><code class="language-markdown">df.fillna(method=&quot;ffill&quot;,axis=1)
</code></pre>
<p>Shows the existing values for the column ⇒ eg: &quot;M&quot;,&quot;F&quot;,&quot;D&quot;,&quot;?&quot; (M/F is correct and D/? is wrong)</p>
<pre><code class="language-markdown">df[&quot;Sex&quot;].unique()
</code></pre>
<p>Shows the count of each existing value in the column ⇒ eg. &quot;M&quot; 175, &quot;F&quot; 132, &quot;D&quot; 5, &quot;?&quot;, 3 ⇒ so 8 wrong entries</p>
<pre><code class="language-markdown">df[&quot;Sex&quot;].value_counts()
</code></pre>
<p>Change all &quot;D&quot; values in the column to &quot;F&quot;</p>
<pre><code class="language-markdown">df[&quot;Sex&quot;].replace(&quot;D&quot;,&quot;F&quot;)
</code></pre>
<p>Change all &quot;D&quot; to &quot;F&quot; and &quot;N&quot; to &quot;M&quot; in the column</p>
<pre><code class="language-markdown">df[&quot;Sex&quot;].replace({&quot;D&quot;:&quot;F&quot;,&quot;N&quot;:&quot;M&quot;})
</code></pre>
<p>Find all the invalid values in the age-column ⇒ eg. greater than 100 is invalid entry</p>
<pre><code class="language-markdown">df[df[&quot;Age&quot;] &gt; 100]
</code></pre>
<p>Fixing the invalid values for age by dividing it to 100</p>
<pre><code class="language-markdown">df.loc[df[&quot;Age&quot;]&gt;100,&quot;Age&quot;]=df.loc[df[&quot;Age&quot;]&gt;100,&quot;Age&quot;]/100
</code></pre>
<p>Defines new filter</p>
<pre><code class="language-markdown">filt = (df[&quot;col1&quot;] == &quot;col1_val1&quot;)
</code></pre>
<p>Defines new filter with several values</p>
<pre><code class="language-markdown">filt2 = (df[&quot;col1&quot;].isin([&quot;val1&quot;,&quot;val2&quot;,&quot;val3&quot;]))
</code></pre>
<p>Defines new filter NOT with several values</p>
<pre><code class="language-markdown">filt3 = (~df[&quot;col1&quot;].isin([&quot;val1&quot;,&quot;val2&quot;,&quot;val3&quot;]))
</code></pre>
<p>Defines new filter with a &gt; operator</p>
<pre><code class="language-markdown">filt4 = (df[&quot;col1&quot;] &gt; 123)
</code></pre>
<p>Outputs the result for the above filter</p>
<pre><code class="language-markdown">df[filt]
</code></pre>
<p>Outputs the result for the above filter with only col2</p>
<pre><code class="language-markdown">df[filt][&quot;col2&quot;]
</code></pre>
<p>Use 2 filters</p>
<pre><code class="language-markdown">df[filt1 &amp; filt2]
</code></pre>
<p>Filter the elements for the top 2.5% of the dataset (quantile)</p>
<pre><code class="language-markdown">df= df[(df['value'] &gt;= df['value'].quantile (0.025))]
</code></pre>
<p>Filter the elements for the bottom 2.5% of the dataset (quantile)</p>
<pre><code class="language-markdown">df= df[(df['value'] &lt; df['value'].quantile (0.975))]
</code></pre>
<p>Check duplicates for all rows (only first entry is not flagged as True)</p>
<pre><code class="language-markdown">df.duplicated()
</code></pre>
<p>Check duplicates for all rows (only last entry is not flagged as True)</p>
<pre><code class="language-markdown">df.duplicated(keep=&quot;last&quot;)
</code></pre>
<p>Check duplicates for all rows (every entry is flagged as True)</p>
<pre><code class="language-markdown">df.duplicated(keep=False)
</code></pre>
<p>Check duplicates only for subset-col (only first entry is not flagged as True)</p>
<pre><code class="language-markdown">df.duplicated(subset=[&quot;Name&quot;])
</code></pre>
<p>Check duplicates only for subset-col (only last entry is not flagged as True)</p>
<pre><code class="language-markdown">df.duplicated(subset=[&quot;Name&quot;],keep=&quot;last&quot;)
</code></pre>
<p>Check duplicates only for subset-col (every entry is flagged as True)</p>
<pre><code class="language-markdown">df.duplicated(subset=[&quot;Name&quot;],keep=False)
</code></pre>
<p>Split all the strings in the column at the blank-char &quot;_&quot; ⇒ eg. results [1987, M, US, 1]</p>
<pre><code class="language-markdown">df[&quot;Data&quot;].str.split(&quot;_&quot;)
</code></pre>
<p>Split all the strings in the column at the blank-char and build seperate new columsn in the dataframe</p>
<pre><code class="language-markdown">df[&quot;Data&quot;].str.split(&quot;_&quot;,expand=True)
</code></pre>
<p>Check column if there exists an &quot;U&quot; in the string-values (True / False output as series) - also regex possible</p>
<pre><code class="language-markdown">df[&quot;Data&quot;].str.contains(&quot;U&quot;)
</code></pre>
<p>Eliminate the whitespaces at the beginning and end for the string-values</p>
<pre><code class="language-markdown">df[&quot;Data&quot;].str.strip()
</code></pre>
<p>Replace / Deletes blanks &quot; &quot; in the string-values</p>
<pre><code class="language-markdown">de[&quot;Data&quot;].str.replace(&quot; &quot;,&quot;&quot;)
</code></pre>
<p>Function lower is used for the whole dataframe</p>
<pre><code class="language-markdown">df.apply(lambda x: x.lower())
</code></pre>
<p>Function lower is used for the first 3 columns</p>
<pre><code class="language-markdown">df.apply(lambda x: x.lower(), axis=&quot;columns&quot;)[0:3]
</code></pre>
<p>Sorting the new index ascending</p>
<pre><code class="language-markdown">df.sort_index(inplace=True)
</code></pre>
<p>Sorting the columns in dataframe</p>
<pre><code class="language-markdown">df.reindex(sorted(df.columns), axis=1)
</code></pre>
<p>Sorting by column ascending</p>
<pre><code class="language-markdown">df.sort_values(by=&quot;co1&quot;)
</code></pre>
<p>Sorting by column descending</p>
<pre><code class="language-markdown">df.sort_values(by=&quot;co2&quot;,ascending=False)
</code></pre>
<p>Sorting by 2 columns descending - first col1 and then col2</p>
<pre><code class="language-markdown">df.sort_values(by=[&quot;col1&quot;,&quot;col2&quot;],ascending=False)
</code></pre>
<p>Sorting a series for one specific col descending</p>
<pre><code class="language-markdown">df[&quot;col1&quot;].sort_value(ascending=False)
</code></pre>
<p>Change the column titles to uppercase</p>
<pre><code class="language-markdown">df.columns =) [x.upper() for x in df.columns]
</code></pre>
<p>Function lower is used for the whole column</p>
<pre><code class="language-markdown">df[&quot;c1&quot;] = df[&quot;c1&quot;].apply(lambda x: x.lower())
</code></pre>
<p>Change the names of the values - all others become NaN</p>
<pre><code class="language-markdown">df[&quot;c1&quot;].map({&quot;val1&quot;:&quot;val1new&quot;,&quot;val2&quot;:&quot;val2new&quot;})
</code></pre>
<p>Change the names of the values - all others are not touched</p>
<pre><code class="language-markdown">df[&quot;c1&quot;].replace({&quot;val1&quot;:&quot;val1new&quot;,&quot;val2&quot;:&quot;val2new&quot;})
</code></pre>
<p>New column at the end</p>
<pre><code class="language-markdown">df[&quot;cnew1&quot;] = df[&quot;c1&quot;] + df[&quot;c2&quot;]
</code></pre>
<p>New column at the end</p>
<pre><code class="language-markdown">df[&quot;cnew1&quot;] = df[&quot;c1&quot;] + df[&quot;c2&quot;]
</code></pre>
<p>Deleting 2 columns</p>
<pre><code class="language-markdown">df.drop(columns=[&quot;c1&quot;,&quot;c2&quot;], inplace=True)
</code></pre>
<p>Add new row (all other cols are defined as NaN for the row)</p>
<pre><code class="language-markdown">df = df.append({&quot;c1&quot;:&quot;val1&quot;},ignore_index=True)
</code></pre>
<p>Outputs the 5 highest values in the column - only col1</p>
<pre><code class="language-markdown">df[&quot;col1&quot;].nlargest(5)
</code></pre>
<p>Outputs the 5 highest values in the column - all columns</p>
<pre><code class="language-markdown">df.nlargest(5,&quot;col1&quot;)
</code></pre>
<p>Outputs the 5 lowest values in the column - all columns</p>
<pre><code class="language-markdown">df.nsmallest(5,&quot;col1&quot;)
</code></pre>
<p>Grouping according to col1</p>
<pre><code class="language-markdown">col1_grp = df.groupby(&quot;col1&quot;)
</code></pre>
<p>Access to one value from the group</p>
<pre><code class="language-markdown">col1_grp.get_group(&quot;col1_value&quot;)
</code></pre>
<p>Grouping col1 and output median for col2</p>
<pre><code class="language-markdown">col1_grp[&quot;col2&quot;].median()
</code></pre>
<p>Grouping col1 and output median for col2 only for 3 group-values</p>
<pre><code class="language-markdown">col1_grp[&quot;col2&quot;].median().loc[[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;]]
</code></pre>
<p>Filtering all Values with 0</p>
<pre><code class="language-markdown">non_zero = df[df[&quot;col1&quot;]!=0]
</code></pre>
<p>Add new column with Y/N depending if the value in col &quot;Sales&quot; is &gt; 50</p>
<pre><code class="language-markdown">df[&quot;newcol&quot;]=[&quot;Y&quot; if x &gt; 50 else &quot;N&quot; for x in df[&quot;Sales&quot;]]
</code></pre>
<p>Change existing column with Y/N depending if the value in col is &gt; 50</p>
<pre><code class="language-markdown">df[&quot;col&quot;]=[&quot;Y&quot; if x &gt; 50 else &quot;N&quot; for x in df[&quot;col&quot;]]
</code></pre>
<p>Add/change column with 0/1 depending of calc of the variables x/y from 2 cols</p>
<pre><code class="language-markdown">df[&quot;c&quot;]=[1 if (x/y&gt;9) else 0 for x,y in zip(df[&quot;c1&quot;],df[&quot;c2])]
</code></pre>
<p>Delete duplicate index entries in the dataframe</p>
<pre><code class="language-markdown">df = df[~df.index.duplicated(keep='first')]
</code></pre>
<p>Convert a dataframe to a dict (<a href="https://stackoverflow.com/questions/26716616/convert-a-pandas-dataframe-to-a-dictionary">https://stackoverflow.com/questions/26716616/convert-a-pandas-dataframe-to-a-dictionary</a>)</p>
<pre><code class="language-markdown">df.set_index('timestamp').T.to_dict('list')
</code></pre>
<p>Select every 5th row</p>
<pre><code class="language-markdown">df.iloc[::5, :]
</code></pre>
<p>Reset index form a dataframe with a new column from 0 to x</p>
<pre><code class="language-markdown">df = df.reset_index()
</code></pre>
<p>Get the first row of the dataframe</p>
<pre><code class="language-markdown">df = df.iloc[:,0]
</code></pre>
<p>Iterate trough dataframe with index and content / row</p>
<pre><code class="language-markdown">for index, row in df.iterrows():
</code></pre>
<p>Show all rows of the dataframe when printed</p>
<pre><code class="language-markdown">pd.set_option('display.max_rows', None)
</code></pre>
<p>Change datetime64 column to datetime</p>
<pre><code class="language-markdown">df[&quot;col1&quot;] = df[&quot;col1&quot;].dt.date
</code></pre>
<p>Convert pandas timestamp to datetime</p>
<pre><code class="language-markdown">dt = dt.to_pydatetime()
</code></pre>
<p>Convert datetime to pandas timestamp</p>
<pre><code class="language-markdown">dt = pd.Timestamp(dt)
</code></pre>
<p>Get the maximum from the 3 different columns and put it in the column &quot;max&quot;</p>
<pre><code class="language-markdown">df[&quot;max&quot;]=df[[&quot;high-low&quot;,&quot;high-pc&quot;,&quot;low-pc&quot;]].max(axis=1)
</code></pre>
<p>Changing a column with this lambda function (over 400x faster then using iterrows)</p>
<pre><code class="language-markdown">temp = df['name'].apply(lambda x: x.strip())
</code></pre>
<p>Add empty line to dataframe</p>
<pre><code class="language-markdown">df.append(pd.Series(np.nan), ignore_index=True)
</code></pre>
<p>Delete rows where col1 = nan</p>
<pre><code class="language-markdown">df = df[df[&quot;col1&quot;].notna()]
</code></pre>
<p>Delete rows where col1 &lt; 10</p>
<pre><code class="language-markdown">df = df[df[&quot;col1&quot;] &lt; 10]
</code></pre>
<p>Merge 2 dataframes where the column order-id is ident</p>
<pre><code class="language-markdown">dfFinal = df1.merge(df2, on='order-id')
</code></pre>
<p>Convert a dataframe to a nested list</p>
<pre><code class="language-markdown">l = df.values.tolist()
</code></pre>
<p><br>When there is some warning like &quot;A value is trying to be set on a copy of a slice from a DataFrame&quot;</p>
<pre><code class="language-markdown">change the access from eg.: df[&quot;upperband&quot;][current] = df[&quot;upperband&quot;][previous]
to: df.loc[current, &quot;upperband&quot;] = df.loc[previous, &quot;upperband&quot;]
(then there will be no more warning)
</code></pre>
<hr />
<h2 id="module---matplotlib---working-with-charts">MODULE - MATPLOTLIB - working with charts</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import module as plotter plt</p>
<pre><code class="language-markdown">import matplotlib.pyplot as plt
</code></pre>
<p>Plot a line</p>
<pre><code class="language-markdown">plt.plot(x, x **2 )
</code></pre>
<p>Plot another line (in the other direction)</p>
<pre><code class="language-markdown">plt.plot(x, -1 * (x ** 2))
</code></pre>
<p>Define x values</p>
<pre><code class="language-markdown">x_values = list(range(1000))
</code></pre>
<p>Define y values / squares</p>
<pre><code class="language-markdown">squares = [x**2 for x in x_values]
</code></pre>
<p>Plot diagram with x- and y-axes</p>
<pre><code class="language-markdown">plt.plot(x_values, squares)
</code></pre>
<p>Plot 1st row, 2nd col in the 2nd diagram (any line after that will only access the 2nd diagram)</p>
<pre><code class="language-markdown">plt.subplot(1,2,2)
</code></pre>
<p>Sscatter diagram with x- and y-axes and line strenght = 5</p>
<pre><code class="language-markdown">plt.scatter(x_values, squares, s=5)
</code></pre>
<p>Title with fontsize = 24</p>
<pre><code class="language-markdown">plt.title(&quot;Title&quot;, fontsize=24)
</code></pre>
<p>X-Axe title with fontsize = 18</p>
<pre><code class="language-markdown">plt.xlabel(&quot;X-Axe&quot;, fontsize=18)
</code></pre>
<p>Y-Axe title with fontsize = 18</p>
<pre><code class="language-markdown">plt.ylabel(&quot;Y-Axe&quot;, fontsize=18)
</code></pre>
<p>Params describtion with fontsize = 10</p>
<pre><code class="language-markdown">plt.tick_params(axis=&quot;both&quot;, which=&quot;major&quot;, labelsize=10)
</code></pre>
<p>Define scaling of axes</p>
<pre><code class="language-markdown">plt.axis([0,1100,0,1100000])
</code></pre>
<p>Colors from one shade to another with different params</p>
<pre><code class="language-markdown">plt.scatter(x,y,c=squares,cmap=plt.cm.Blues,edgecolor=&quot;none&quot;, s=10)
</code></pre>
<p>Expoit the first point larger in green</p>
<pre><code class="language-markdown">plt.scatter(x[0],y[0],c=&quot;green&quot;,edgecolor=&quot;none&quot;, s=100)
</code></pre>
<p>Expoit the last point larger in red</p>
<pre><code class="language-markdown">plt.scatter(x[-1],y[-1],c=&quot;red&quot;,edgecolor=&quot;none&quot;, s=100)
</code></pre>
<p>Hide the complete x-axis description</p>
<pre><code class="language-markdown">plt.axes().get_xaxis().set_visible(False)
</code></pre>
<p>Hide the complete y-axis description</p>
<pre><code class="language-markdown">plt.axes().get_yaxis().set_visible(False)
</code></pre>
<p>Define custom figure size</p>
<pre><code class="language-markdown">plt.figure(dpi=128, figsize=(10,6))
</code></pre>
<p>Show diagram</p>
<pre><code class="language-markdown">plt.show()
</code></pre>
<p>Save diagram as png-picture-file</p>
<pre><code class="language-markdown">plt.savefig(&quot;example.png&quot;,bbox_inches=&quot;tight&quot;)
</code></pre>
<hr />
<h2 id="module---selenium---browser-automatization">MODULE - SELENIUM - browser automatization</h2>
<p><a href="#python">jump to top...</a><br><br>
chromedriver.exe in Ordner von py-file speichern<br>
Python specific documentation for selenium</p>
<pre><code class="language-markdown">https://selenium-python.readthedocs.io/locating-elements.html
</code></pre>
<p>Import WebDriver for url access</p>
<pre><code class="language-markdown">from selenium import webdriver
</code></pre>
<p>Import Options</p>
<pre><code class="language-markdown">from selenium.webdriver.chrome.options import Options
</code></pre>
<p>Import Service</p>
<pre><code class="language-markdown">from selenium.webdriver.chrome.service import Service
</code></pre>
<p>Import WebDriverWait (explizit waiting time)</p>
<pre><code class="language-markdown">from selenium.webdriver.support.ui import WebDriverWait
</code></pre>
<p>Import EC (for expected conditions with waiting logic)</p>
<pre><code class="language-markdown">from selenium.webdriver.support import expected_conditions as EC
</code></pre>
<p>Import By (for finding elements with By-logic)</p>
<pre><code class="language-markdown">from selenium.webdriver.common.by import By
</code></pre>
<p>Import Keys (for keystroke handling)</p>
<pre><code class="language-markdown">from selenium.webdriver.common.keys import Keys
</code></pre>
<p>Import Time-Library when there are delays needed</p>
<pre><code class="language-markdown">import time
</code></pre>
<p>Import Keys to send key-strokes</p>
<pre><code class="language-markdown">from selenium.webdriver.common.keys import Keys
</code></pre>
<p>Define chrome driver - with actual folder os.getcwd</p>
<pre><code class="language-markdown">driver = webdriver.Chrome(os.getcwd() + '/chromedriver')
</code></pre>
<p>Access to the url</p>
<pre><code class="language-markdown">driver.get(&quot;url&quot;)
</code></pre>
<p>Somtimes necessary to delay some work in progress</p>
<pre><code class="language-markdown">time.sleep(1)
</code></pre>
<p>Find element (input-element with id = &quot;passwd-id&quot;)</p>
<pre><code class="language-markdown">driver.find_element(By.XPATH, &quot;//input[@id='passwd-id']&quot;)
</code></pre>
<p>Click on element by xpath (investigate - copy xpath)</p>
<pre><code class="language-markdown">driver.find_element(By.XPATH,&quot;//*[@id='button']/input&quot;).click()
</code></pre>
<p>Fill field &quot;name&quot; with content &quot;x&quot;</p>
<pre><code class="language-markdown">driver.find_element(By.XPATH,&quot;//*[@id='name']&quot;).send_keys(&quot;x&quot;)
</code></pre>
<p>Other method to find element per xpath ()</p>
<pre><code class="language-markdown">driver.find_element(By.XPATH, &quot;//button[text()='Some text']&quot;)
</code></pre>
<p>Find Element according to a specific element eg. &quot;aria-label&quot; with text &quot;Post&quot; in a &quot;div&quot;</p>
<pre><code class="language-markdown">driver.find_element(By.XPATH,&quot;//div[@aria-label='Post']&quot;).click()
</code></pre>
<p>Clear / delete input field</p>
<pre><code class="language-markdown">driver.find_element(&quot;q&quot;).clear()
</code></pre>
<p>Fill text in field and press enter</p>
<pre><code class="language-markdown">driver.find_element(&quot;q&quot;).send_keys(&quot;txt&quot; + u'\ue007')
</code></pre>
<p>Set text of element to xyz</p>
<pre><code class="language-markdown">driver.execute_script('arguments[0].innerHTML = &quot;xyz&quot;;', elem)
</code></pre>
<p>Fill text in field (use css-selector to find element ⇒ input element with id &quot;myID&quot; in it)</p>
<pre><code class="language-markdown">drv.find_element_by_css_selector(&quot;input#myID&quot;).send_keys(&quot;txt&quot;)
</code></pre>
<p>driver.set_window_size(600,1000)
<br>Search field for class</p>
<pre><code class="language-markdown">driver.find_elements(By.CLASS_NAME, &quot;cl&quot;)
</code></pre>
<p>Search field for tag</p>
<pre><code class="language-markdown">driver.find_elements_by_tag_name(&quot;tag&quot;)
</code></pre>
<p>Search by (exact) link-text in an anchor-tag</p>
<pre><code class="language-markdown">driver.find_element_by_link_text('Continue')
</code></pre>
<p>Search by (partial) link-text in an ancor-tag</p>
<pre><code class="language-markdown">driver.find_element_by_partial_link_text('Conti')
</code></pre>
<p>Send single keyboard-elements &lt;&gt; chars (needs import keys)</p>
<pre><code class="language-markdown">driver.send_keys(Keys.Backspace,Keys.ARROW_LEFT,Keys.ENTER)
</code></pre>
<p>Send a PageDown-keystroke (eg. for scrolling to the very bottom of a page)</p>
<pre><code class="language-markdown">driver.send_keys (Keys.PAGE_DOWN)
</code></pre>
<p>Send an Return-keystroke (eg. for enter after data entries in fields)</p>
<pre><code class="language-markdown">driver.send_keys (u'\ue007')
</code></pre>
<p>Press enter and submit site</p>
<pre><code class="language-markdown">field.submit()
</code></pre>
<p>Close driver (otherwise the windows will not close)</p>
<pre><code class="language-markdown">driver.quit()
</code></pre>
<p>Close the actual window</p>
<pre><code class="language-markdown">driver.close()
</code></pre>
<p>Title of the html-site</p>
<pre><code class="language-markdown">driver.title
</code></pre>
<p>Back-Function in browser-history</p>
<pre><code class="language-markdown">driver.back()
</code></pre>
<p>Forward-Function in browser-history</p>
<pre><code class="language-markdown">driver.forward()
</code></pre>
<p>Refresh website</p>
<pre><code class="language-markdown">driver.navigate().refresh()
</code></pre>
<p>Define an individual cookie</p>
<pre><code class="language-markdown">cookie = {&quot;name&quot;: &quot;token&quot;, &quot;value&quot;: &quot;23874kljdsjhfaökldjs&quot;}
</code></pre>
<p>Use Cookie</p>
<pre><code class="language-markdown">driver.add_cookie(cookie)
</code></pre>
<p>Outputs a specific cookie</p>
<pre><code class="language-markdown">driver.get_cookie(&quot;token&quot;)
</code></pre>
<p>Outputs all cookies</p>
<pre><code class="language-markdown">driver.get_cookies())
</code></pre>
<p>Read current, actual url</p>
<pre><code class="language-markdown">driver.current_url
</code></pre>
<p>Switch to a frame-id (eg. a PopUp)</p>
<pre><code class="language-markdown">driver.switch_to.frame (&quot;frame_id&quot;)
</code></pre>
<p>Read active window name</p>
<pre><code class="language-markdown">act_window = driver.current_window_handle
</code></pre>
<p>Switch (back) to active window (eg. after working on the popup-frame or popup-window)</p>
<pre><code class="language-markdown">driver.switch_to.window(act_window)
</code></pre>
<p>Set window size to 600 wide and 1000 height</p>
<pre><code class="language-markdown">driver.set_window_size(600,1000)
</code></pre>
<p>Minmize window</p>
<pre><code class="language-markdown">driver.minimize_window()
</code></pre>
<p>ScrollDown in the window (maybe to the bottom of the site)</p>
<pre><code class="language-markdown">driver.execute_script(&quot;window.scrollTo(0, 10000)&quot;)
</code></pre>
<p><br>Switch between iframes</p>
<pre><code class="language-markdown">iframe = driver.find_element_by_xpath(&quot;//iframe[@name='DialWin']&quot;)  =&gt; Use XPath to locate iframe
driver.switch_to.frame(iframe)                                      =&gt; Switch to iframe
driver.switch_to.default_content()                                  =&gt; Switch back to default content
</code></pre>
<p><br>Wait till a specific element is loaded / clickable</p>
<pre><code class="language-markdown">=&gt; waiting as long as required - better then time.sleep
=&gt; more possible conditions see https://selenium-python.readthedocs.io/waits.html#explicit-waits
wait = WebDriverWait (driver, 5)                                        # Define maximum wait time till the element is ready
wait.until(EC.presence_of_element_located((By.NAME, &quot;agree&quot;))).click()  # Wait till element with name = &quot;agree&quot; is present and click afterwards
wait.until(EC.presence_of_element_located((By.ID, &quot;YDC-Col1&quot;)))         # Wait till element with id = &quot;YDC-Col1&quot; is present
wait.until(EC.element_to_be_clickable((By.XPATH, &quot;//div[text()='Total revenues']&quot;))).click()    # Wait till div-element with specific text is pressent and click
</code></pre>
<p><br>Use Selenium with chrome windows hidden</p>
<pre><code class="language-markdown">os.environ['WDM_LOG_LEVEL'] = '0'     # with this seeting no output of log / messages using webdriver_manager.chrome
import undetected_chromedriver as uc
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager
from fake_useragent import UserAgent
ua = UserAgent()
userAgent = ua.random
options = Options()
options.add_argument('--headless')
options.add_experimental_option ('excludeSwitches', ['enable-logging'])
options.add_argument(&quot;start-maximized&quot;)
options.add_argument('window-size=1920x1080')
options.add_argument('--no-sandbox')
options.add_argument('--disable-gpu')
options.add_argument(f'user-agent={userAgent}')
srv=Service(ChromeDriverManager().install())
# driver = webdriver.Chrome (service=srv, options=options)
driver = uc.Chrome (service=srv, options=options)
waitWebDriver = WebDriverWait (driver, 5)
link = &quot;https://www.google.com&quot;
driver.get (link)
</code></pre>
<p><br>Define Real User Agent Header</p>
<pre><code class="language-markdown">(avoid being blocked while scraping some data - keep it up to date from time to time)
see: https://www.scraperapi.com/blog/5-tips-for-web-scraping/
common user agent list: https://www.networkinghowtos.com/howto/common-user-agent-list/
latest user agent list: https://www.whatismybrowser.com/guides/the-latest-user-agent/
options.add_argument(&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36&quot;)
</code></pre>
<p><br>Use Random User Agent Header</p>
<pre><code class="language-markdown">https://stackoverflow.com/questions/49565042/way-to-change-google-chrome-user-agent-in-selenium

from fake_useragent import UserAgent
options = Options()
ua = UserAgent()
userAgent = ua.random
options.add_argument(f'user-agent={userAgent}')
</code></pre>
<p><br>Using XPath with Selenium</p>
<pre><code class="language-markdown">https://www.guru99.com/xpath-selenium.html
Can be used to find the location of any element in a html- or xml document

Example:
wait = WebDriverWait(driver, 10)
tmpElem = wait.until(EC.element_to_be_clickable((By.XPATH, &quot;//span[text()='Top Grossing']&quot;)))
tmpElem.click()

Xpath=//tagname[@attribute='value']
    // : Select current node
    Tagname: Tagname of the particular node.
    @: Select attribute.
    Attribute: Attribute name of the node.
    Value: Value of the attribute.

//input[@name='uid']                      # input-elem with name = &quot;uid&quot;
//input[@type='text']                     # input-elem with type = &quot;text&quot;
//label[@id='message23']                  # label-elem with id = &quot;message23&quot;
//input[@value='RESET']                   # input-elem with value = &quot;RESET&quot;
//*[@class='barone']                      # any elem with class = &quot;barone&quot;
//td[text()='UserID']	                    # td-elem which has the text &quot;User-ID&quot;
//a[@href='http://demo.guru99.com/']      # anchor with specific link
//img[@src='//xyz.com/img/java.png']      # img-elem with specific pic-link
(//button)[2]                             # select the second button on the page
(//p[@class='product']/span)[2]           # select the second span in the p-element with class =

//*[@type='submit' or @name='btnReset']         # any elem which has 2 OR conditions (for type and name)
//input[@type='submit' and @name='btnLogin'     # any elem which has 2 AND conditions (for type and name)

//*[contains(@name,'btn')]              # any elem which has &quot;btn&quot; somewhere in the name
//*[contains(@id,'message')]            # any elem which has &quot;message&quot; somewhere in the id
//*[contains(text(),'here')]            # any elem which has &quot;here&quot; somewhere in the text
//*[contains(@href,'orf')]              # any elem which has &quot;orf&quot; somewhere in the href-link
//label[starts-with(@id,'message')]     # elem where id starts with &quot;message&quot;

//*[@type='text']//following::input[1]              # select all following-elements which have input as tag and select the first elem
//*[text()='Enterprise Testing']//ancestor::div[2]  # find ancestor-elements with text and take the second one
//*[@id='java_technologies']//child::li[23]         # select all child elements with specific id and select the 23th one
//*[@type='submit']//preceding::input[1]            # select preceding (dt.: vorangegangene) input-elements and take the first one
//*[@type='submit']//following-sibling::input       # select following sibling which is input
//*[@id='rt-feature']//parent::div[5]               # select parent of the elem with id = &quot;rt-feature&quot; and take the 5th div
//*[@type='password']//self::input                  # select elem and use itself (only 1 element can be found)
//*[@id='rt-feature']//descendant::a[X]             # find all elements below (dt.: Nachfahren) and take the Xth one
</code></pre>
<p><br>Scroll to the very bottom of a site - eg. Twitter, Facebook, Stocktwits,...</p>
<pre><code class="language-markdown">lenOfPage = driver.execute_script(&quot;window.scrollTo(0, document.body.scrollHeight);var lenOfPage=document.body.scrollHeight;return lenOfPage;&quot;)
match=False
while(match==False):
    lastCount = lenOfPage
    time.sleep(1)
    lenOfPage = driver.execute_script(&quot;window.scrollTo(0, document.body.scrollHeight);var lenOfPage=document.body.scrollHeight;return lenOfPage;&quot;)
    if lastCount==lenOfPage:
        match=True
</code></pre>
<p><br>When there are problems clicking an element on a page</p>
<pre><code class="language-markdown">Method1:
element = driver.find_element_by_id('datePickerToggleBtn')
webdriver.ActionChains(driver).move_to_element(element ).click(element ).perform()

Method2:
element = driver.find_element_by_css('div[class*=&quot;loadingWhiteBox&quot;]')
driver.execute_script(&quot;arguments[0].click();&quot;, element)
</code></pre>
<p><br>Take a screenshot when something fails in headless mode</p>
<pre><code class="language-markdown">try:
    ...
    do the whole selenium work...
    ...
except:
    driver.save_screenshot(&quot;a.png&quot;)
</code></pre>
<p><br>use locators in this order as suggested by Selenium contributors</p>
<pre><code class="language-markdown">ID
name
className
linkText
partialLinkText
tagName
cssSelector
XPath
</code></pre>
<hr />
<h2 id="module---beautiful-soap---webscraping">MODULE - BEAUTIFUL SOAP - webscraping</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Import module for beautiul soap</p>
<pre><code class="language-markdown">from bs4 import BeautifulSoap
</code></pre>
<p>Import moduel for fake useragent</p>
<pre><code class="language-markdown">from fake_useragent import UserAgent
</code></pre>
<p>Define UserAgent</p>
<pre><code class="language-markdown">ua = UserAgent()
</code></pre>
<p>Create random useragent</p>
<pre><code class="language-markdown">ua.random								&quot;t
</code></pre>
<p>Read url as page</p>
<pre><code class="language-markdown">page = requests.get(&quot;https://www.ariva.de/dax-30&quot;)
</code></pre>
<p>Read url as page with proxy like eg. &quot;https://10.10.1.11:1080&quot;</p>
<pre><code class="language-markdown">page = requests.get(url,headers=headers,proxy=proxy)
</code></pre>
<p>Read page with html.parser</p>
<pre><code class="language-markdown">soup = BeautifulSoup (page.content,&quot;html.parser&quot;)
</code></pre>
<p>find first a-tag in body</p>
<pre><code class="language-markdown">soup.body.a
</code></pre>
<p>Find all td-elements</p>
<pre><code class="language-markdown">soup.find_all(&quot;td&quot;):
</code></pre>
<p>Find alle th- and td-elements</p>
<pre><code class="language-markdown">soup.find_all([&quot;th&quot;,&quot;td&quot;])
</code></pre>
<p>Read all table rows for specific class</p>
<pre><code class="language-markdown">soup.find_all(&quot;tr&quot;, class_=&quot;arrow0&quot;):
</code></pre>
<p>Find all div-elements with specific class</p>
<pre><code class="language-markdown">soup.find_all(&quot;p&quot;, {&quot;class&quot;: &quot;payamntp&quot;})
</code></pre>
<p>Find element with one of this 2 classes</p>
<pre><code class="language-markdown">soup.find_all(&quot;div&quot;, {'class':['class1', 'class2']})
</code></pre>
<p>Find divs which have both classes</p>
<pre><code class="language-markdown">soup.select(&quot;div.class1.class2&quot;)
</code></pre>
<p>Read all table data cells with id and content</p>
<pre><code class="language-markdown">for col_id, col_content in enumerate(result.find_all(&quot;td&quot;)):
</code></pre>
<p>Read all divs with specific class</p>
<pre><code class="language-markdown">soup.find_all(&quot;div&quot;, class_=&quot;col-xs-6&quot;)
</code></pre>
<p>Find div with id &quot;lj_div&quot;</p>
<pre><code class="language-markdown">soup.find(&quot;div&quot;, {&quot;id&quot;: &quot;lj_div&quot;})
</code></pre>
<p>Find (first) p with class &quot;line&quot;</p>
<pre><code class="language-markdown">soup.find(&quot;p&quot;, {&quot;class&quot;: &quot;line&quot;})
</code></pre>
<p>Find element with specific text / string</p>
<pre><code class="language-markdown">soup.find(&quot;dt&quot;, string=&quot;In-App Purchases&quot;)
</code></pre>
<p>Find elements for several tags</p>
<pre><code class="language-markdown">soup.find_all([&quot;strong&quot;,&quot;a&quot;,&quot;br&quot;])
</code></pre>
<p>Found the parent div-element for a specific before find element</p>
<pre><code class="language-markdown">erg2 = erg.find_parent(&quot;div&quot;)
</code></pre>
<p>Check if class has specific content</p>
<pre><code class="language-markdown">if row.get(&quot;class&quot;) == [&quot;ellipsis&quot;, &quot;nobr&quot;, &quot;new&quot;]:
</code></pre>
<p>Check if string nameSymbol_&quot; is part of the class-element</p>
<pre><code class="language-markdown">soup.find(&quot;small&quot;, class_=re.compile(&quot;nameSymbol_&quot;))
</code></pre>
<p>Read all links from href element</p>
<pre><code class="language-markdown">for e in soup.find_all(&quot;a&quot;): e.get(&quot;href&quot;)
</code></pre>
<p>Read all number from the field &quot;value&quot;</p>
<pre><code class="language-markdown">for e in soup.find_all(&quot;a&quot;): e.get(&quot;value&quot;)
</code></pre>
<p>Change all linebreak <br> in text to blank</p>
<pre><code class="language-markdown">for lb in soup.findAll(&quot;br&quot;): lb.replaceWith(&quot; &quot;)
</code></pre>
<p>Read url from the image</p>
<pre><code class="language-markdown">url_i = rows[0].find('img')['src']
</code></pre>
<p>Read image as content</p>
<pre><code class="language-markdown">image = requests.get(f'https:{url_i}').content
</code></pre>
<p>Formated Output with html indentations</p>
<pre><code class="language-markdown">results.prettify()
</code></pre>
<p>Check if specific text in soup text-output</p>
<pre><code class="language-markdown">if &quot;Kein Zugriff&quot; in soup.text:
</code></pre>
<p>Reads everyting what is in the tbody-tag</p>
<pre><code class="language-markdown">soap.tbody
</code></pre>
<p>return direct child elements of a an element in a list</p>
<pre><code class="language-markdown">.contents
</code></pre>
<p>returns all direct childrens (as a generator object)</p>
<pre><code class="language-markdown">.children
</code></pre>
<p>returns all descendants (nachfolger) as iterable</p>
<pre><code class="language-markdown">.descendants
</code></pre>
<p>return the parent-tag</p>
<pre><code class="language-markdown">.parent
</code></pre>
<p>return all parents (as a generator object)</p>
<pre><code class="language-markdown">.parents
</code></pre>
<p>return the next sibling (going sideways / have the same parent)</p>
<pre><code class="language-markdown">.next_sibling
</code></pre>
<p>return the previous sibling (going sideways / have the same parent)</p>
<pre><code class="language-markdown">.previous_sibling
</code></pre>
<p>all following siblings as iterable</p>
<pre><code class="language-markdown">.next_siblings
</code></pre>
<p>all previous siblings as iterable</p>
<pre><code class="language-markdown">.previous_siblings
</code></pre>
<p>return next element</p>
<pre><code class="language-markdown">.next_element
</code></pre>
<p>return next elements (as a generator object)</p>
<pre><code class="language-markdown">.next_elements
</code></pre>
<p>return previous element</p>
<pre><code class="language-markdown">.previous_element
</code></pre>
<p>return previous elements (as a generator object)</p>
<pre><code class="language-markdown">.previous_elements
</code></pre>
<p>find the next ul-element</p>
<pre><code class="language-markdown">.find_next(&quot;ul)
</code></pre>
<p>returns the name of the tag</p>
<pre><code class="language-markdown">.name
</code></pre>
<p>get all strings from a tag in an iterable</p>
<pre><code class="language-markdown">.strings
</code></pre>
<p>get all (stripped) strings from a tag in an iterable</p>
<pre><code class="language-markdown">.stripped_strings
</code></pre>
<p><br>Define Real User Agent Header</p>
<pre><code class="language-markdown">(avoid being blocked while scraping some data - keep it up to date from time to time)
see: https://www.scraperapi.com/blog/5-tips-for-web-scraping/
common user agent list: https://www.networkinghowtos.com/howto/common-user-agent-list/
latest user agent list: https://www.whatismybrowser.com/guides/the-latest-user-agent/
headers = {
    'User-Agent': '&lt;copy from the above link&gt;',
}
response = requests.get(url, headers=headers)
</code></pre>
<p><br>Read with Selenium when necessary due the specific homepage</p>
<pre><code class="language-markdown">from bs4 import BeautifulSoup
from selenium import webdriver
link = &quot;https://www.gurufocus.com/stock/&quot; + stock + &quot;/summary&quot;			# define the homepage to be scraped
options = Options()
options.add_argument('--headless')										# webpage will work in the back
options.add_experimental_option ('excludeSwitches', ['enable-logging'])
path = os.path.abspath (os.path.dirname (sys.argv[0]))					# works for alle platforms (Win,MacOs,Linux)
if platform == &quot;win32&quot;:
	cd = '/chromedriver.exe'
elif platform == &quot;linux&quot;:
	cd = '/chromedriver_linux'
elif platform == &quot;darwin&quot;:
	cd = '/chromedriver'
driver = webdriver.Chrome (path + cd, options=options)					# Use chromedriver.exe to read website with the above options
driver.get (link)  														# Read link
time.sleep (2)  														# Wait till the full site is loaded
</code></pre>
<p><br>Wait for the specific element to load</p>
<pre><code class="language-markdown">element = driver.find_element_by_id(&quot;analyst-estimate&quot;)
driver.execute_script(&quot;arguments[0].scrollIntoView();&quot;, element)
time.sleep (1)
</code></pre>
<p><br>Read page with html.parser and to the further scraping</p>
<pre><code class="language-markdown">soup = BeautifulSoup(driver.page_source, 'html.parser')
</code></pre>
<p>Close the chromedriver window</p>
<pre><code class="language-markdown">driver.quit ()
</code></pre>
<p><br>all searches also possible for more elements wiht find_elements_*</p>
<pre><code class="language-markdown">driver.find_element_by id												# Search for a id in html
driver.find_element_by_name												# Search for name-field (eg. in input-tag)
driver.find_element_by_xpath											# Search by xpath of the element (right mouse blick in Chrome Dev Tools)
driver.find_element_by_link_text										# Search for (full) text within the tags
driver.find_element_by_partial_link_text								# Search for (part) text within the tags
driver.find_element_by_tag_name('h1')									# Search for a tag in html
driver.find_element_by_class_name(&quot;cont&quot;)								# Search for a specific class name in html
driver.find_element_by_css_selector('p.content')						# Search for tag and selector
</code></pre>
<hr />
<h2 id="module---requests---workings-with-apis">MODULE - REQUESTS - workings with APIs</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://realpython.com/python-api/">https://realpython.com/python-api/</a><br>
import module requests</p>
<pre><code class="language-markdown">import requests
</code></pre>
<p>import module json</p>
<pre><code class="language-markdown">import json
</code></pre>
<p>Request api from the generated api-link</p>
<pre><code class="language-markdown">resp = requests.get (url)
</code></pre>
<p><br>GET-request with payload and headers</p>
<pre><code class="language-markdown">resp = requests.request(&quot;GET&quot;, url,
                        json=payload,
                        headers=headers)
</code></pre>
<p><br>Return the statuscode of the response</p>
<pre><code class="language-markdown">resp.status_code
    # 200: ok
    # 201: resource created
    # 400: bad request (wrong or missing some informations)
    # 401: Unauthorized (requires some additonal permissions)
    # 404: Not Found (requested resource does not exist)
    # 405: Method Not Allowed (wrong HTTP Method - eg. POST instead of GET)
    # 500: Internal Server Error: something broken on the server site
</code></pre>
<p><br>shows the statuscode in textform (eg. OK, Not Found)</p>
<pre><code class="language-markdown">resp.reasons
</code></pre>
<p>used headers for the request</p>
<pre><code class="language-markdown">resp.request.headers
</code></pre>
<p>header from the response</p>
<pre><code class="language-markdown">resp.headers
</code></pre>
<p>show the content-type of the resonse (eg. json, image/jpeg)</p>
<pre><code class="language-markdown">resp.headers[&quot;Content-Type&quot;]
</code></pre>
<p>response in text-form</p>
<pre><code class="language-markdown">resp.text
</code></pre>
<p>response in json-form</p>
<pre><code class="language-markdown">resp.json()
</code></pre>
<p>Pretty-Print formatted json-file</p>
<pre><code class="language-markdown">print(json.dumps(respJSON,
</code></pre>
<p>indent=4,
sort_keys=True))
<br>Read the value for the 1 element and the attribute xyz</p>
<pre><code class="language-markdown">result = api[0][&quot;xyz&quot;]
</code></pre>
<p><br>Install module</p>
<pre><code class="language-markdown">pip install requests-html
</code></pre>
<p>Import requests_html</p>
<pre><code class="language-markdown">from requests_html import HTMLSession
</code></pre>
<p>Define a html-session</p>
<pre><code class="language-markdown">s = HTMLSession()
</code></pre>
<p>Define response</p>
<pre><code class="language-markdown">r = s.get(url, headers=HEADERS)
</code></pre>
<p>title of in the html-tag</p>
<pre><code class="language-markdown">r.html.find(&quot;title&quot;, first=True).text
</code></pre>
<p>Span-value with id = &quot;wob_tm&quot;</p>
<pre><code class="language-markdown">r.html.find(&quot;span#wob_tm&quot;, first=True).text
</code></pre>
<p>Div-element with class = &quot;clX&quot;</p>
<pre><code class="language-markdown">r.html.find(&quot;div.clX&quot;, first=True)
</code></pre>
<p>Span-element with class=&quot;clY&quot; ind Div-element with class=&quot;clX&quot;</p>
<pre><code class="language-markdown">r.html.find(&quot;div.clX span.clY&quot;,first=True).text
</code></pre>
<hr />
<h2 id="module---scrapy---webscraping-using-spiders">MODULE - SCRAPY - webscraping using spiders</h2>
<p><a href="#python">jump to top...</a><br><br>
Tutorial: <a href="https://docs.scrapy.org/en/latest/intro/tutorial.html">https://docs.scrapy.org/en/latest/intro/tutorial.html</a>
<br>Video-Tutorial: <a href="https://www.youtube.com/c/zytedata/playlists">https://www.youtube.com/c/zytedata/playlists</a> (Playlist - Learn Scrapy)
Video-Tutorial2: <a href="https://www.youtube.com/watch?v=s4jtkzHhLzY">https://www.youtube.com/watch?v=s4jtkzHhLzY</a> (Scrape a Whisky-Shop)<br>
install the scrapy module</p>
<pre><code class="language-markdown">pip install SCRAPY
</code></pre>
<p>creates the project and folder-structure</p>
<pre><code class="language-markdown">scrapy startproject indeedScraper
</code></pre>
<p>create tilesSpider.py with scrapy-template</p>
<pre><code class="language-markdown">scrapy genspider tilesSpider magnattiles.com
</code></pre>
<p>scrape a webpage in command line and use the console for further investigations</p>
<pre><code class="language-markdown">scrapy shell http://quotes.toscrape.com/random
</code></pre>
<p>fetch a new site from an allready scraped page with &quot;scrapy shell&quot; before</p>
<pre><code class="language-markdown">fetch(&quot;newURL&quot;)
</code></pre>
<p>shows the full html-code of the page</p>
<pre><code class="language-markdown">print(response.text)
</code></pre>
<p>select element &quot;small&quot; with class=&quot;author&quot; and shows the html-code</p>
<pre><code class="language-markdown">response.css(&quot;small.author&quot;).extract()
</code></pre>
<p>return only the text for the element+class for the first element</p>
<pre><code class="language-markdown">response.css(&quot;small.author::text&quot;).extract()[0]
</code></pre>
<p>return the text for the first element for span + class=&quot;text&quot;</p>
<pre><code class="language-markdown">response.css(&quot;span.text::text&quot;).extract_first()
</code></pre>
<p>return all anchor-tag texts in a list</p>
<pre><code class="language-markdown">response.css(&quot;a.tag:lst:text&quot;).extract()
</code></pre>
<p>find elems a in li with class &quot;next&quot; and get the content from the href-element</p>
<pre><code class="language-markdown">response.css(&quot;li.next &gt; a::attr(href)&quot;).extract_first()
</code></pre>
<p>extract href from all anchor-tags inside div.quote ⇒ span ⇒ a</p>
<pre><code class="language-markdown">response.css(&quot;div.quote &gt; span &gt; a::attr(href)&quot;).extract()
</code></pre>
<p>combine the url from the initial scrapy shell with the string-path</p>
<pre><code class="language-markdown">response.urljoin(&quot;/page/2/&quot;)
</code></pre>
<p>read text-data when the response is i a json-format</p>
<pre><code class="language-markdown">data = json.loads(response.text)
</code></pre>
<p><br>Create spider skeleton on command line (quotesName = spider-name, toscrape.com = site to scrape)</p>
<pre><code class="language-markdown">scrapy genspider quotesNAME toscrape.com
</code></pre>
<p>run spider from command line</p>
<pre><code class="language-markdown">scrapy runspider quotesNAME.py
</code></pre>
<p>run spider and store result into items.json</p>
<pre><code class="language-markdown">scrapy runspider quotesNAME.py -o items.json
</code></pre>
<p>shows the duplicate elements which are filtered</p>
<pre><code class="language-markdown">'dupefilter/filtered': 50,
</code></pre>
<p>from second video-tutorial above<br>
open scrapy shell</p>
<pre><code class="language-markdown">scrapy shell
</code></pre>
<p>get the first div-element with that class</p>
<pre><code class="language-markdown">response.css(&quot;div.product-item-info&quot;).get()
</code></pre>
<p>get the first li-element in the ul-element with class &quot;products&quot;</p>
<pre><code class="language-markdown">response.css(&quot;ul.products li&quot;)
</code></pre>
<p>assign all div-elements with that class to the variable &quot;products&quot;</p>
<pre><code class="language-markdown">products = response.css(&quot;div.product-item-info&quot;)
</code></pre>
<p>outputs the number of alle div-elements with that class on the loaded page</p>
<pre><code class="language-markdown">len(products)
</code></pre>
<p>from the products-variable get the first a-element with this class</p>
<pre><code class="language-markdown">p.css(&quot;a.product-item-link&quot;).get()
</code></pre>
<p>return the text from the element (first a-element with this class)</p>
<pre><code class="language-markdown">p.css(&quot;a.product-item-link::text&quot;).get()
</code></pre>
<p>return the text from all elements (all a-elements with this class)</p>
<pre><code class="language-markdown">p.css(&quot;a.product-item-link::text&quot;).getall()
</code></pre>
<p>return the text from all elements (all span-elements with this class)</p>
<pre><code class="language-markdown">p.css(&quot;span.price::text&quot;).getall()
</code></pre>
<p>return the text from the element (first span with class &quot;price&quot; and replace the €-symbol)</p>
<pre><code class="language-markdown">p.css(&quot;span.price::text&quot;).get().replace(&quot;€&quot;,&quot;&quot;)
</code></pre>
<p>return the link from the element (first href-link with this class)</p>
<pre><code class="language-markdown">p.css(&quot;a.product-item-link&quot;).attrib[&quot;href&quot;]
</code></pre>
<p>second way to the the href-value</p>
<pre><code class="language-markdown">p.css(&quot;a.product-item-link::attr(href)&quot;).get(
</code></pre>
<p>return value of attribut &quot;dpsku&quot; in the a-tag with class &quot;button&quot;</p>
<pre><code class="language-markdown">p.css(&quot;a.button::attr(dpsku)&quot;).get()
</code></pre>
<p><br>start scrapy with the spider &quot;whisky&quot;</p>
<pre><code class="language-markdown">scrapy crawl whisky
</code></pre>
<p>run spider &quot;whisky&quot; and output result to json-file (overwrite the json-file)</p>
<pre><code class="language-markdown">scrapy crawl whisky -O whisky.json
</code></pre>
<p>same as above (only appending the results and not overwriting)</p>
<pre><code class="language-markdown">scrapy crawl whisky -o whisky.json
</code></pre>
<p>outputing as csv</p>
<pre><code class="language-markdown">scrapy crawl whisky -O whisky.csv
</code></pre>
<p>outputing as xlsx (scrapy-xlsx must be installed + settings.py changed: <a href="https://pypi.org/project/scrapy-xlsx/">https://pypi.org/project/scrapy-xlsx/</a>)</p>
<pre><code class="language-markdown">scrapy crawl whisky -O whisky.xlsx
</code></pre>
<p>find element with class &quot;action  next&quot; (spaces have to be replaced with &quot;.&quot;)</p>
<pre><code class="language-markdown">response.css(&quot;a.action.next&quot;).get()
</code></pre>
<p>store the link for the next page</p>
<pre><code class="language-markdown">nextPage = response.css(&quot;a.action.next&quot;).attrib[&quot;href&quot;
</code></pre>
<p>go to next page and do parsing</p>
<pre><code class="language-markdown">yield response.follow(nextPage, callback=self.parse)
</code></pre>
<p>automatic delay between requests</p>
<pre><code class="language-markdown">settings.py: AUTOTHROTTLE_ENABLED = True
</code></pre>
<p>The initial download delay</p>
<pre><code class="language-markdown">settings.py: AUTOTHROTTLE_START_DELAY = 5
</code></pre>
<p>The maximum download delay to be set in case of high latencies</p>
<pre><code class="language-markdown">settings.py: AUTOTHROTTLE_MAX_DELAY = 60
</code></pre>
<p>ignore robots.txt</p>
<pre><code class="language-markdown">settings.py: ROBOTSTXT_OBEY = False
</code></pre>
<p>set download-delay (to prevent site-checkings)</p>
<pre><code class="language-markdown">settings.py: DOWNLOAD_DELAY = 3
</code></pre>
<p><br>when scraping with scrapy_selenium</p>
<pre><code class="language-markdown">DOWNLOADER_MIDDLEWARES = {
    'scrapy_selenium.SeleniumMiddleware': 800
}
#Selenium
from shutil import which
SELENIUM_DRIVER_NAME = 'chrome'
SELENIUM_DRIVER_EXECUTABLE_PATH = r&quot;C:\Users\Polzi\Documents\DEV\Python-Private\chromedriver.exe&quot;
# '--headless' if using chrome instead of firefox
SELENIUM_DRIVER_ARGUMENTS = ['--headless']
</code></pre>
<p><br>get text (with div and a combination)</p>
<pre><code class="language-markdown">response.xpath(&quot;//div[@class='vendor']//ancestor::a/text()&quot;).get()
</code></pre>
<p>get href-value (from a element with class)</p>
<pre><code class="language-markdown">response.xpath(&quot;//a[@class='next page-numbers']/@href&quot;).get()
</code></pre>
<p>get the aria-label-value</p>
<pre><code class="language-markdown">response.xpath(&quot;//a/@aria-label).get()
</code></pre>
<p>get href-element (from a element and existing selector &quot;tmp&quot;)</p>
<pre><code class="language-markdown">tmp.xpath(&quot;.//a/@href&quot;).get()
</code></pre>
<p><br>Example spider</p>
<pre><code class="language-markdown">import scrapy
class QuotesnameSpider(scrapy.Spider):
    name = 'quotesNAME'                                 # name of the spider
    custom_settings = {                                 # define custom settings - eg. encoding utf-8 for german umlaute
        &quot;FEED_EXPORT_ENCODING&quot;: &quot;utf-8&quot;
    }
    allowed_domains = ['toscrape.com']                  # allowed domains (no http in front of the domain)
    start_urls = ['http://quotes.toscrape.com/random']  # urls to scrape

    def parse(self, response):
        self.log(&quot;I just visited: &quot; + response.url)     # info-output when program is running
        yield {                                         # store scraped informations in a dictionary
            &quot;author_name&quot;: response.css(&quot;small.author::text&quot;).extract()[0],
            &quot;text&quot;: response.css(&quot;span.text::text&quot;).extract_first(),
            &quot;tags&quot;: response.css(&quot;a.tag::text&quot;).extract(),
        }
</code></pre>
<p><br>Example spider (with direct api-access on an infinite page)</p>
<pre><code class="language-markdown">import scrapy
import json

class QuotesScrollSpider(scrapy.Spider):
    name = 'quotesINFINITE'                                     # name of the spider
    apiURL = &quot;https://quotes.toscrape.com/api/quotes?page={}&quot;   # standard URL with page variable
    start_urls = [apiURL.format(1)]                             # create the start-url with page = 1

    def parse(self, response):
        data = json.loads(response.text)                        # read the json-page
        for quote in data[&quot;quotes&quot;]:                            # iterate trough all quotes
            yield {                                             # return the needed values
                &quot;authorName&quot;: quote[&quot;author&quot;][&quot;name&quot;],
                &quot;text&quot;: quote[&quot;text&quot;],
                &quot;tags&quot;: quote[&quot;tags&quot;]
            }
        if data[&quot;has_next&quot;]:                                    # check if next page has to be read
            nextPage = data[&quot;page&quot;] + 1
            yield scrapy.Request(url=self.apiURL.format(nextPage), callback=self.parse)
</code></pre>
<hr />
<h2 id="module---pyqt---making-guis">MODULE - PYQT - making GUIs</h2>
<p><a href="#python">jump to top...</a><br><br>
see Codemy.com <a href="https://www.youtube.com/channel/UCFB0dxMudkws1q8w5NJEAmw">https://www.youtube.com/channel/UCFB0dxMudkws1q8w5NJEAmw</a>
see Python-Diverses/PyQt<br>
Install Py Qt Designer</p>
<pre><code class="language-markdown">https://build-system.fman.io/qt-designer-download
</code></pre>
<p>Installation</p>
<pre><code class="language-markdown">pip install pyqt5
</code></pre>
<p>Defines Application</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QApplication
</code></pre>
<p>Defines Label</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QLabel
</code></pre>
<p>Defines Widget</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QWidget
</code></pre>
<p>Arranges horizontally from left to right</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QHBoxLayout
</code></pre>
<p>Arranges vertically from top to bottom</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QVBoxLayout
</code></pre>
<p>Arranges in grid from on x and y axes</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QGridLayout
</code></pre>
<p>Field for forms - 1col are titles, 2col are fields,rbs,cb</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QFormLayout
</code></pre>
<p>Defines PushButton</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QPushButton
</code></pre>
<p>Module for dialog windows</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QDialog
</code></pre>
<p>Module for button boxes in dialog windows</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QDialogButtonBox
</code></pre>
<p>Defines input field with text</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QLineEdit
</code></pre>
<p>Module for main windows</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QMainWindow
</code></pre>
<p>Module for status bar</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QStatusBar
</code></pre>
<p>Module for tool bar</p>
<pre><code class="language-markdown">from PyQt5.QtWidgets import QToolBar
</code></pre>
<p>Create an instance of the application</p>
<pre><code class="language-markdown">app = QApplication(sys.argv)
</code></pre>
<p>Initialize a window</p>
<pre><code class="language-markdown">w = QWidget()
</code></pre>
<p>Title of the windows</p>
<pre><code class="language-markdown">w.setWindowTitle('Windows Title')
</code></pre>
<p>Define windows (1:x-coord,2:y-coord,3:width,4:height)</p>
<pre><code class="language-markdown">w.setGeometry(200, 200, 380, 180)
</code></pre>
<p>Place / move windows to coodinates 60,15</p>
<pre><code class="language-markdown">w.move(50, 15)
</code></pre>
<p>Define label / message in format h1</p>
<pre><code class="language-markdown">msg = QLabel('&lt;h1&gt;Hello World!&lt;/h1&gt;', parent=window)
</code></pre>
<p>Place / move labe to coordinates 60,15</p>
<pre><code class="language-markdown">msg.move(50, 15)
</code></pre>
<p>Show the application GUI - schedules a paint event</p>
<pre><code class="language-markdown">windows.show()
</code></pre>
<p>Start the app and close it with sys.exit</p>
<pre><code class="language-markdown">sys.exit(app.exce_())
</code></pre>
<p>Defines horzontal box</p>
<pre><code class="language-markdown">layout_qh = QHBoxLayout()
</code></pre>
<p>Defines vertical box</p>
<pre><code class="language-markdown">layout_qv = QVBoxLayout()
</code></pre>
<p>Defines grid layout</p>
<pre><code class="language-markdown">layout_qg = QGridLayout()
</code></pre>
<p>Defines form layout</p>
<pre><code class="language-markdown">layout_qf = QFormLayout()
</code></pre>
<p>Defines one or more buttons</p>
<pre><code class="language-markdown">layout_qh.addWidget(QPushButton('Button1'))
</code></pre>
<p>Defines one or more buttons</p>
<pre><code class="language-markdown">layout_qv.addWidget(QPushButton('Button1'))
</code></pre>
<p>Defines one or more buttons and set it to position 1,0</p>
<pre><code class="language-markdown">layout_qg.addWidget(QPushButton('Button1'),1,0)
</code></pre>
<p>Set buttons to position 2,1 and span it 1row/2cols</p>
<pre><code class="language-markdown">layout_qg.addWidget(QPushButton('Button1'),2,1,1,2)
</code></pre>
<p>Defines input field</p>
<pre><code class="language-markdown">layout_qf.addRow(&quot;text:&quot;, QLineEdit())
</code></pre>
<p>Sets layout dimensions to window</p>
<pre><code class="language-markdown">w.setLayout(layout_xy)
</code></pre>
<p>Defines a class dialog which inherits from QDialog</p>
<pre><code class="language-markdown">class Dialog(QDialog):
</code></pre>
<p>Define buttons for a dialog window</p>
<pre><code class="language-markdown">buttons = QDialogButtonBox()
</code></pre>
<p>Defines a ok button on a dialog window</p>
<pre><code class="language-markdown">buttons.setStandardButtons(QDialogButtons.OK)
</code></pre>
<p>Adds buttons to vertical layout</p>
<pre><code class="language-markdown">layout_qv.addWidget(buttons)
</code></pre>
<p>Defines a class Windows which inherits from QMainWindow</p>
<pre><code class="language-markdown">class Window(QMainWindow):
</code></pre>
<p>Convert Qt-Designer file to a python-file</p>
<pre><code class="language-markdown">pyuic5 -x 6PyQtDesigner.ui -o 6PyQtDesigner.py
</code></pre>
<p><br>simplest App</p>
<pre><code class="language-markdown">import PyQt5.QtWidgets as qtw
class MainWindow(qtw.QWidget):
  def __init__(self):
    super().__init__()
    self.setWindowTitle(&quot;Check Orphans App&quot;)
    ...
    self.show()
app = qtw.QApplication([])
mw = MainWindow()
app.exec_()
</code></pre>
<hr />
<h2 id="module---tkinter---making-guis">MODULE - TKINTER - making GUIs</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Tutorial with deep explanation</p>
<pre><code class="language-markdown">https://www.youtube.com/watch?v=YXPyB4XeYLA
</code></pre>
<p>Import tkinter module</p>
<pre><code class="language-markdown">from tkinter import *
</code></pre>
<p>Create root window</p>
<pre><code class="language-markdown">root = Tk()
</code></pre>
<p>Name of the window in the title</p>
<pre><code class="language-markdown">root.title(&quot;Header Title&quot;)
</code></pre>
<p>Define icon for the windows (left upper corner)</p>
<pre><code class="language-markdown">root.iconbitmap(&quot;pic.ico&quot;)
</code></pre>
<p>Define size of the window</p>
<pre><code class="language-markdown">root.geometry(&quot;400x400&quot;)
</code></pre>
<p>Creating a label widget</p>
<pre><code class="language-markdown">myLabel = Label(root,text=&quot;Hello World!&quot;)
</code></pre>
<p>Showing myLabel on the screen</p>
<pre><code class="language-markdown">myLabel.pack()
</code></pre>
<p>Showing myLabel on grid place 0/0 (left upper corner) with 10pixel padding from above</p>
<pre><code class="language-markdown">myLabel.grid(row=0,column=0,pady=10)
</code></pre>
<p>Creating a status label widget with border (bd=1), sunken relief and anchor position right (east)</p>
<pre><code class="language-markdown">status = Label(root,text=&quot;St&quot;,bd=1,relief=SUNKEN,anchor=E
</code></pre>
<p>Showing status bar - with using maximum space from left to right (west to east) with sticky</p>
<pre><code class="language-markdown">status.grid(row=2,column=0,columnspan=3,sticky=W+E)
</code></pre>
<p>Creating a button widget with a name</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;Click Me!&quot;)
</code></pre>
<p>Creating a deactivated, greyed button widget with a name</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;Click Me!&quot;,state=DISABLED)
</code></pre>
<p>Creating a button widget with a name and size 50 * 50</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;C&quot;,padx=50,pady=50)
</code></pre>
<p>Creating a button which will excute the myfunc-function when its clicked</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;T&quot;,command=myfunc)
</code></pre>
<p>Creating a button which will excute the func-function with a numeric parameter</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;T&quot;,command=lambda: func(nr))
</code></pre>
<p>Creating a button with background blue and foreground white</p>
<pre><code class="language-markdown">myButton = Button(root,text=&quot;col&quot;,bg=&quot;blue&quot;,fg=&quot;white&quot;)
</code></pre>
<p>Create a quit-button on the window</p>
<pre><code class="language-markdown">QuitButton = Button(root,text=&quot;exit&quot;,command=root.quit)
</code></pre>
<p>Creating a entry field - with width 50 and borderwidth 5 - and showing the field</p>
<pre><code class="language-markdown">myEntry = Entry(root, width=50, borderwidth=5).pack()
</code></pre>
<p>Showing myEntry as grid in row/col = 0/0 and spanned over 3 columns</p>
<pre><code class="language-markdown">myEntry.grid(row=0,column=0,columnspan=3)
</code></pre>
<p>Showing myEntry as grid in row/col = 0/0 and with pading in x/y-axes</p>
<pre><code class="language-markdown">e.grid(row=0,column=0,padx=10,pady=10)
</code></pre>
<p>Read content of the entry field</p>
<pre><code class="language-markdown">myEntry.get()
</code></pre>
<p>Shows a default value in the entry field</p>
<pre><code class="language-markdown">myEntry.insert(0,&quot;Default-Text&quot;)
</code></pre>
<p>Insert a number into the entry field</p>
<pre><code class="language-markdown">myEntry.insert(0, number)
</code></pre>
<p>Delete content of the entry field</p>
<pre><code class="language-markdown">myEntry.delete(0,END)
</code></pre>
<p>Mainloop of the program</p>
<pre><code class="language-markdown">root.mainloop()
</code></pre>
<p>Close window &quot;wind&quot;</p>
<pre><code class="language-markdown">...command=wind.destroy
</code></pre>
<p><br>Pics in Tkinter-Windows</p>
<pre><code class="language-markdown">from PIL import ImageTk,Image								# Additional module Pillow neede (install with &lt;pip install Pillow&gt;
my_img = ImageTk.PhotoImage(Image.open(&quot;demo.png&quot;))			# Reads Image wiht Pillow-module (Tkinter can not read png/jpg files)
my_label = Label(image=my_img)								# Creating a Label with the image
my_label.pack()												# Showing the pic
</code></pre>
<p><br>Define Frame</p>
<pre><code class="language-markdown">frame = LabelFrame(root,text=&quot;Name_Frame&quot;,padx=5,padx=5)	# Creating a frame with padding 5/5 (inside the frame)
frame.pack(padx=10,pady=10)									# Showing the frame with padding 10/10 (outside the frame)
button = Button(frame,text=&quot;Name_Button&quot;)					# Creating button in the frame (not root window)
button.grid(row=0, column=0)								# Showing the button in the frame as grid (with frames is mixing between pack and grid possible)
</code></pre>
<p><br>RadioButtons</p>
<pre><code class="language-markdown">r = IntVar()												# Define variable for radio button - when string use StringVar()
r.set(&quot;2&quot;)													# Choose default radio button
Radiobutton(root,text=&quot;Opt1&quot;,variable=r,value=1).pack()		# Define and show radiobutton 1
Radiobutton(root,text=&quot;Opt2&quot;,variable=r,value=2).pack()		# Define and show radiobutton 2
r.get()														# Get value from choosen radio button
</code></pre>
<p><br>MessageBox</p>
<pre><code class="language-markdown">messagebox.showinfo(&quot;Title of PopUp&quot;, &quot;Hello World!&quot;)		# Show Messagebox
different boxes available: showinfo, showwarning, showerror, askquestion, askokcancel, askyesno
response = messagebox.askquestion (&quot;Bla&quot;, &quot;BlaBla!&quot;)		# Show AskQuestion Box and store response
</code></pre>
<p><br>Check about response of user in message box</p>
<pre><code class="language-markdown">if response == 1: Label(root, text= &quot;YES&quot;).pack()
elif response == 0: Label(root, text= &quot;NO&quot;).pack()
</code></pre>
<p><br>More Windows</p>
<pre><code class="language-markdown">def open()													# Function for opening the 2nd window
	global my_img											# Global definition necessary - otherwise no pic would be drawn
	sec = TopLevel()										# Define 2nd window
	sec.title(&quot;2nd Window&quot;)									# Title for 2nd window
    img = ImageTk.PhotoImage(Image.open(&quot;demo.png&quot;))		# Define image
    Label (top, image=img).pack()							# Show image in 2nd window
btn=Button(root,text=&quot;Open 2nd Window&quot;,command=open).pack()	# Button for opening 2nd window per click
</code></pre>
<p><br>FileDialog</p>
<pre><code class="language-markdown">root.filename = filedialog.askopenfilename(					# Define filname dialog
    initialdir=&quot;/Users/Bla/images&quot;,							# Define initial dir for the file dialog
    title=&quot;Select file&quot;,									# Title of the file dialog
    filetypes=((&quot;png files&quot;,&quot;*.png&quot;),(&quot;all files&quot;,&quot;*.*&quot;)))	# Define filetypes in dialog (first name, second which files, default first entry)
my_label = Label(root, text=root.filename).pack()			# After choosing a file - show the filename + filepath
</code></pre>
<p><br>Slider</p>
<pre><code class="language-markdown">vertical = Scale(root,from_=0,to=200)						# Define vertical slider
vertical.pack()												# Showing vertical slider
horizontal = Scale(root,from_=0,to=200,orient=HORIZONTAL)	# Define horizontal slider
horizontal.pack()											# Showing horizontal slider
</code></pre>
<p><br>Checkboxes</p>
<pre><code class="language-markdown">Checkbutton(root,text=&quot;Check1&quot;,variable=var).pack(			# Define and Show a checkbox
c.select() or c.deselect()									# Select or Deselect per default the checkbox
</code></pre>
<p><br>DropDown</p>
<pre><code class="language-markdown">options=[&quot;Mo&quot;,&quot;Tu&quot;,&quot;We&quot;,&quot;Th&quot;,&quot;Fr&quot;]							# Define options for dropdown menue
var = StringVar()											# Define variable for dropdown menue
var.set(&quot;Mo&quot;)												# Set default for dropdown menue
OptionMenu(root,var,*options).pack							# Define dropdown menue
</code></pre>
<hr />
<h2 id="mouule---kivy---making-guis">MOUULE - KIVY - making GUIs</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>https://kivy.org/#home</p>
<pre><code class="language-markdown">Kivy documentation
</code></pre>
<p><a href="https://www.youtube.com/watch?v=dLgquj0c5_U&amp;list=PLCC34OHNcOtpz7PJQ7Tv7hqFBP_xDDjqg">https://www.youtube.com/watch?v=dLgquj0c5_U&amp;list=PLCC34OHNcOtpz7PJQ7Tv7hqFBP_xDDjqg</a></p>
<pre><code class="language-markdown">Training from
</code></pre>
<p>python -m pip install kivy[base] kivy_examples</p>
<pre><code class="language-markdown">Install kivy
</code></pre>
<p>Use template.spec (create with: pyinstaller *.spec - creation not as onefile possible with pyinstaller)</p>
<pre><code class="language-markdown">Create EXE
</code></pre>
<p><br>Simple Window with Label</p>
<pre><code class="language-markdown">import kivy                         # Import kivy base
from kivy.app import App            # Import App
from kivy.uix.label import Label    # Import Label class

class MyApp(App):                   # Define App-Class
    def build(self):
        return Label(text=&quot;Hello&quot;, font_size = 72)  # Print label with font_size 72)

if __name__ == &quot;__main__&quot;:          # Start App / draw windows with label
    MyApp().run()
</code></pre>
<p><br>Input fields and button with Grid-Layout</p>
<pre><code class="language-markdown">from kivy.uix.gridlayout import GridLayout      # Import Grid-Layout class
from kivy.uix.textinput import TextInput        # Import TextInput class
from kivy.uix.button import Button              # Import Button class

class MyGridLayout(GridLayout):                 # Define Grid Layout
    def __init__(self, **kwargs):                       # Initialize infinite keywords
        super(MyGridLayout,self).__init__(**kwargs)     # Call grid layout constructor
        self.cols = 2                                   # Set columns to 2 (draws all elements in 2 columns)

        self.add_widget(Label(text=&quot;Name: &quot;))           # Add Label-Widget with text=&quot;Name&quot; (as one-liner)
        self.name = TextInput(multiline=False)          # Add Input Box &quot;name&quot; with only one line (multiline = True would me more input lines)
        self.add_widget(self.name)                      # Assigment as two-liner

        self.submit = Button(text=&quot;Submit&quot;, font_size=32)   # Add Button-Widget with text=&quot;Submit&quot; and font-size 32
        self.submit.bind(on_press=self.press)               # Bind the button to a function (when pressed the function press will be called)
        self.add_widget(self.submit)

    def press(self,instance):
        print(self.name.text)   # Print the text of the name-input field in the terminal
        self.add_widget (Label (text=f&quot;New Label with text {self.name.text}&quot;)       # Create new Label and write the text to it
</code></pre>
<p><br>Combine 2 Grids with 2 columns and 1 column</p>
<pre><code class="language-markdown">    super(MyGridLayout,self).__init__(**kwargs)
    self.cols = 1                                       # define standard grid with 1 column

    self.secondGrid = GridLayout()
    self.secondGrid.cols = 2                            # define second grid with 2 columns

    self.secondGrid.add_widget(Label(text=&quot;Stock: &quot;))   # define content for the secondGrid
    self.stock = TextInput(multiline=False)
    self.secondGrid.add_widget(self.stock)
    self.add_widget (self.topGrid)

    self.submit = Button(text=&quot;Levermann Score&quot;, font_size =32)     # define button with only 1 column
    self.submit.bind(on_press=self.levermannCalc)
    self.add_widget(self.submit)
</code></pre>
<p><br>Set height and width of the widgets</p>
<pre><code class="language-markdown">    self.row_force_default=True     # necessary - otherwise no adjustment will be done for the widget
    self.row_default_height=120     # sets the height to 120 pixel

    # set height for the whole widgets in topGrid
    self.topGrid = GridLayout(
        row_force_default=True,
        row_default_height=40
    )

    # set width and heigth for individual widget
    self.top_grid.add_widget(Label(text=&quot;Name: &quot;,       # set the name of the widget
                                   size_hint_y=None,
                                   height=10,           # define height
                                   size_hint_x=None,
                                   width=200))          # define width
</code></pre>
<p><br>Kivy Design Language
<br>Seperate program in python from the gui-design (in a kv-file)</p>
<pre><code class="language-markdown"># python-file:
from kivy.uix.widget import Widget              # import widget module
from kivy.properties import ObjectProperty      # import object property
class MyGridLayout(Widget):
    inpfield = ObjectProperty(None)             # define an object and initialize empty
    def method_function(self):                  # defube a method / function in the the gui (eg. for a button)
        print(f&quot;something&quot;)
class MyApplication(App):                       # define the application class (kv-file must have the same name = MyApplication.kv)
    def build(self):
        return MyGridLayout()                   # name of the first line in the kv-file
if __name__ == &quot;__main__&quot;:
    MyApplication().run()                       # run the gui

# kv-file (name must be in this case &quot;MyApplication.kv&quot;)#
# intention is here very similar (only tabs - no spaces)
&lt;MyGridLayout&gt;
    inpfield : inpfield                         # initialize the input field

    GridLayout:                                 # define the main grid layout with one column
        cols: 1
        size: root.width, root.height           # take the root width/height (otherwise the objects will be placed in the very left bottom)
        row_force_default: True                 # necessary - otherwise no adjustment will be done for the widget
        row_default_height: 120                 # set the height (of the whole grid) to 120 pixel)

        GridLayout:                             # define second (nested) grid with two columns
            cols: 2
            row_force_default: True
            row_default_height: 40              # set the height (of every object in this grid to 40 pixel)

            Label:
                text: &quot;Stock Ticker&quot;            # name of the label
            TextInput:
                id: inpfield                    # if of the inputfield
                text: blablabla                 # default value for the inputfield
                multiline: False                # no multiline input field

        Button:                                 # define button as part of the first gridlayout (so only 1 column)
        text: &quot;Button Text&quot;                     # button text
        font_size: 32                           # font-size of the button text
        on_press: root.method_function()        # on button press call function &quot;method_function&quot; from the py-file
        size_hint_y: None
        height: 50                              # set height of the button to 50 pixel
</code></pre>
<p><br>Kivy Builder</p>
<pre><code class="language-markdown"># link kv-files to python-file
from kivy.lang import Builder       # import builder module
Builder.load_file(&quot;whatever.kv&quot;)    # link the kv-file to the python-file (so the App-classname must not be the same as the kv-filename)
</code></pre>
<p><br>Coloring buttons and input fields</p>
<pre><code class="language-markdown"># using rgb-color for the coloring
background_normal: ''                           # necessary to use this - otherwise the color will be mixed with the intial grey default
background_color: (1,0,0,1)                     # coloring the element in red
background_color: (238/255,250/255,0/255,1)     # using a rgb-color for the coloring

# using hexadecimal coloring
#:import utils kivy.utils                               # importing the kivy-utils in the very first line of the kv-file
background_color: utils.get_color_from_hex(&quot;#eefa00&quot;)   # coloring the element with this hex-code
</code></pre>
<p><br>Box Layout</p>
<pre><code class="language-markdown">BoxLayout:
    orientation: &quot;horizontal&quot;                   # arrange the object horizontal (also vertical possible)
    size: root.width, root.height               # use the full place of the window
    spacing: 20                                 # 20 pixels between the elements
    padding: 50                                 # 50 pixels padding around the elements

    Button:
    text: &quot;blablabla&quot;                           # define button in the box-model
    size_hint: (0.5,0.5)                         # make the button the half-size (x- and y-axes) - working also responsive when the windows size is changed

    size_hint: (None, None)                     # set fixed size for the button (200 pixels width and 50 pixels height)
    width: 200
    height: 50
    pos_hint: {&quot;center_x&quot;: 0.5}                 # center the element horizontal
</code></pre>
<p><br>Inheritance, Widget Properties</p>
<pre><code class="language-markdown"># Define the global settings in sepearte section in the kv-file
&lt;Button&gt;                            # these settings are used for all buttons in the window
    font_size: 32
    background_normal: ''
    background_color: (0,0,1,1)
&lt;TextInput&gt;                         # this color is used for all input fields in the window
    background_color: (150/255,150/255,150/255,1)

# But when some individual setting for an element is needed this is possible
&lt;MyLayout&gt;
    BoxLayout:
        TextInput:
            background_color: (1,0,0,1)     # background color for this input-field will be different then the global settings aboth
</code></pre>
<p><br>Color Labels</p>
<pre><code class="language-markdown"># Works a little bit different that the normal coloring of objects like buttons or input fields
Label:
    background_color: (0,0,1,1)             # choose the color for the label
    canvas.before:                          # this whole code-part has to be added - otherwise there will be no label coloring
        Color:
            rgba: self.background_color
        Rectangle:
            size: self.size
            pos: self.pos

# Normal usage of other properties
    text: &quot;Name&quot;                # name of the label
    font_size: 45               # font size of the label
    color: (0,1,0,1)            # color of the text of the label
    bold: True                  # text will be bold written
    italic: True                # text will be italic written
    outline_color: (0,0,0)      # set the color for the border of the text
    outline_width: 2            # width of the border of the text
</code></pre>
<p><br>Color Background</p>
<pre><code class="language-markdown"># 1st method in kv-file: make a white background color
&lt;MyLayout&gt;
    canvas.before:
        Color:
            rgba: (1,1,1,1)
        Rectangle:
            pos: self.pos
            size: self.size

# 2nd method in py-file
from kivy.core.window import Window

class AwesomeApp(App):
    def build(self):
        Window.clearcolor = (1,1,1,1)
        return MyLayout()
</code></pre>
<p><br>Set window size</p>
<pre><code class="language-markdown"># set windows size to width 550 and height 300
from kivy.core.window import Window
class MyLayout(Widget):
    Window.size = (550, 300)
</code></pre>
<p><br>DropDown box with spinner</p>
<pre><code class="language-markdown">kv-file:
    Spinner:
        id: spinner_id
        text: &quot;Favorite&quot;
        values: [&quot;Pepperoni&quot;,&quot;Cheese&quot;,&quot;Mushroom&quot;,&quot;Pineapple&quot;]
        on_text: root.spinner_clicked(spinner_id.text)

py-file:
    def spinner_clicked(self,value):
        self.ids.click_label.text = f&quot;You selected: {value}&quot;
</code></pre>
<hr />
<h2 id="module---pygame---making-games">MODULE - PYGAME - making games</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Pygame documentation</p>
<pre><code class="language-markdown">http://pygame.org/docs/
</code></pre>
<p>Import of the pygame module</p>
<pre><code class="language-markdown">import pygame as pg
</code></pre>
<p>Initialize and setup screen</p>
<pre><code class="language-markdown">pg.init()
</code></pre>
<p>Define dimension</p>
<pre><code class="language-markdown">screen_dim = (1200,800)
</code></pre>
<p>Show screen with the defined dimensions</p>
<pre><code class="language-markdown">screen = pg.display.set_mode(screen_dim)
</code></pre>
<p>Define background color</p>
<pre><code class="language-markdown">bg_color = (230,230,230)
</code></pre>
<p>Screen filling with defined background color</p>
<pre><code class="language-markdown">screen.fill(bg_color)
</code></pre>
<p>Title of the game in the window</p>
<pre><code class="language-markdown">pg.display.set_caption(&quot;My Super Game&quot;)
</code></pre>
<p>Rectangle infos (left,top,width,height - (0,0,1200,800)</p>
<pre><code class="language-markdown">rect screen.get_rect()
</code></pre>
<p>Center of the Rectangle as tuple - (600,400)</p>
<pre><code class="language-markdown">rect.center
</code></pre>
<p>Size of the Rectangle as tuple - (1200,800)</p>
<pre><code class="language-markdown">rect-size
</code></pre>
<p>X-Dim left - (0)</p>
<pre><code class="language-markdown">rect.left
</code></pre>
<p>X-Dim right - (1200)</p>
<pre><code class="language-markdown">rect.right
</code></pre>
<p>Y-Dim top - (0)</p>
<pre><code class="language-markdown">rect.top
</code></pre>
<p>Y-Dim bottom - (800)</p>
<pre><code class="language-markdown">rect.bottom
</code></pre>
<p>Middle of X-Dim - (600)</p>
<pre><code class="language-markdown">rect.centerx
</code></pre>
<p>Middle of Y-Dim - (400)</p>
<pre><code class="language-markdown">rect.centery
</code></pre>
<p>Width of the rectangle - (1200)</p>
<pre><code class="language-markdown">rect.width
</code></pre>
<p>Height of the rectangle - (800)</p>
<pre><code class="language-markdown">rect.height
</code></pre>
<p>Define new rectangle</p>
<pre><code class="language-markdown">small_rect = pg.Rect(100,100,10,150)
</code></pre>
<p>Draw small rectangle in screen</p>
<pre><code class="language-markdown">pg.draw.rect(screen,(100,100,100,small_rect)
</code></pre>
<p>Loading an image</p>
<pre><code class="language-markdown">figure = pg.image.load(&quot;ship.png&quot;)
</code></pre>
<p>Getting the rect object from an image</p>
<pre><code class="language-markdown">figure.get_rect()
</code></pre>
<p>Positioning an image in the middle of the bottom screen</p>
<pre><code class="language-markdown">figure_rect.midbottom = screen_rect.midbottom
</code></pre>
<p>Drawing an image to the screen</p>
<pre><code class="language-markdown">screen.blit(figure, figure_rect)
</code></pre>
<p>Check if an event has happend (keystroke, mouseclick)</p>
<pre><code class="language-markdown">for event in pg.event.get():
</code></pre>
<p>Check if key is pressed</p>
<pre><code class="language-markdown">event.type == pg.KEYDOWN:
</code></pre>
<p>Some action when Right-Key is pressed</p>
<pre><code class="language-markdown">event.key == pg.K_RIGHT:
</code></pre>
<p>Some action when Space-Key is pressed</p>
<pre><code class="language-markdown">event.key == pg.K_SPACE:
</code></pre>
<p>Check if mousebutton is clicked</p>
<pre><code class="language-markdown">event.type == pg.MOUSEBUTTONDOWN
</code></pre>
<p>Findinig the mouse position</p>
<pre><code class="language-markdown">mouse_pos = pg.mouse.get_pos()
</code></pre>
<p>Check if mouse-cursor is ofer an object / rectangle</p>
<pre><code class="language-markdown">button_rect.collidepoint(mouse_pos)
</code></pre>
<p>Pygame groups<br>
Group class for working with similar objects</p>
<pre><code class="language-markdown">from pygame.sprite import Sprite,Group
</code></pre>
<p>Making and filling a group - must inherit from Sprite</p>
<pre><code class="language-markdown">def Bullet(Sprite):
</code></pre>
<p>Method from the new group</p>
<pre><code class="language-markdown">def draw_bullet(self):
</code></pre>
<p>Method from the new group</p>
<pre><code class="language-markdown">def update(self):
</code></pre>
<p>Define group of elements</p>
<pre><code class="language-markdown">bullet = Group()
</code></pre>
<p>Define new instance</p>
<pre><code class="language-markdown">new_bullet = Bullet()
</code></pre>
<p>Add new instance to group</p>
<pre><code class="language-markdown">bullets.add(new_bullet)
</code></pre>
<p>Iterate through group instances and draw</p>
<pre><code class="language-markdown">from bullet in bullets.sprites(): bullet.draw_bullet()
</code></pre>
<p>Calls the methode update() on each member of the group</p>
<pre><code class="language-markdown">bullets.update()
</code></pre>
<p>Remove instance from group</p>
<pre><code class="language-markdown">bullets.remove(bullet)
</code></pre>
<p>Check if single object is overlapping with groupelements</p>
<pre><code class="language-markdown">prg.sprite.spritecollideany(obj,group)
</code></pre>
<p>Result-Dict with all overlapping elements of both groups</p>
<pre><code class="language-markdown">pg.sprite.groupcollide(group1,group2,True,True)
</code></pre>
<p>Define message</p>
<pre><code class="language-markdown">msg = &quot;Play again!&quot;
</code></pre>
<p>Defines message color</p>
<pre><code class="language-markdown">msg_col = (100,100,100)
</code></pre>
<p>Defines background color</p>
<pre><code class="language-markdown">bg_col = (230,230,230)
</code></pre>
<p>Defines font from system font</p>
<pre><code class="language-markdown">font = pg.font.SysFont(None,48)
</code></pre>
<p>Create an image of the message</p>
<pre><code class="language-markdown">msg_img = f.render(msg,True,msg_col,bg_col)
</code></pre>
<p>Read rect from message-image</p>
<pre><code class="language-markdown">msg_img_rect = msg_image.get_rect()
</code></pre>
<p>Pos the message-image in the middle of the window</p>
<pre><code class="language-markdown">msg_img_rect.center = screen_rect.center
</code></pre>
<p>Display the positioned message-image</p>
<pre><code class="language-markdown">screen.blit(msg_img, msg_img_rect)
</code></pre>
<hr />
<h2 id="module---pythoncom---make-new-formula-in-excel-with-python-function">MODULE - PYTHONCOM - make new formula in excel with python-function</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://www.youtube.com/watch?v=cYwn8Pu5eRg&amp;feature=emb_logo">https://www.youtube.com/watch?v=cYwn8Pu5eRg&amp;feature=emb_logo</a><br>
Import necessary modules</p>
<pre><code class="language-markdown">import pythoncom
</code></pre>
<p>Import client</p>
<pre><code class="language-markdown">import win32com.client
</code></pre>
<p>Import server</p>
<pre><code class="language-markdown">import win32com.server.register
</code></pre>
<p>Put everything in a class</p>
<pre><code class="language-markdown">class PythonObjectLibrary:
</code></pre>
<p>UniqueID for our object to register it with Windows</p>
<pre><code class="language-markdown">_reg_clsid_ = pythoncom.CreateGuid()
</code></pre>
<p>Register the object as an EXE</p>
<pre><code class="language-markdown">_reg_clsctx = pythoncom.CLSCTX_LOCAL_SERVER
</code></pre>
<p>Register the object as a DLL</p>
<pre><code class="language-markdown">_reg_clsctx = pythoncom.IMPROC_SERVER
</code></pre>
<p>Name of the project library</p>
<pre><code class="language-markdown">_reg_progid_ = &quot;Python.ObjectLibrary&quot;
</code></pre>
<p>Optional / Description of the library</p>
<pre><code class="language-markdown">_reg_desc_ = &quot;This is our Python Obj Library&quot;
</code></pre>
<p>Name the functions - this sees the user in excel</p>
<pre><code class="language-markdown">_public_methods_ = [&quot;f1&quot;,&quot;f2,&quot;f3&quot;]
</code></pre>
<p>Define the function in the class</p>
<pre><code class="language-markdown">def f1(self, x, y):
</code></pre>
<p>Return the result of the function (to excel later)</p>
<pre><code class="language-markdown">return x + y
</code></pre>
<p>Another function - this time wie a range (more cells in excel)</p>
<pre><code class="language-markdown">def f2(self, myRange):
</code></pre>
<p>Create an instance of the range object passed trough</p>
<pre><code class="language-markdown">rng1 = win32com.client.Dispatch(myRange)
</code></pre>
<p>Change the object to an numpy-array (or an list)</p>
<pre><code class="language-markdown">rng1val = np.array(list(rng1.Value))
</code></pre>
<p>Return the sum of the range (to excel later)</p>
<pre><code class="language-markdown">return rng1val.sum()
</code></pre>
<p>Part of the code in the main-section</p>
<pre><code class="language-markdown">if __name__ == &quot;__main__&quot;:
</code></pre>
<p>Register the library (when the program is started ⇒ the Library is registered in Windows)</p>
<pre><code class="language-markdown">win32com.server.register.UseCommandLine(PythonObjectLibrary)
</code></pre>
<p><br>Part in Excel</p>
<pre><code class="language-markdown">(in the Visual Basic Editor under Development Tools)
# Definition of the f1-function - now the user can use the function &quot;f1&quot; in excel
Function f1(x As Long, y As Long)
    f1 = VBA.CreateObject(&quot;Python.ObjectLibrary&quot;).f1(x, y)
End Function
# Definition of the f2-function - now the user can use the function &quot;f2&quot; in excel
Function f2(x As Range)
    f2 = VBA.CreateObject(&quot;Python.ObjectLibrary&quot;).f2(x)
End Function
</code></pre>
<hr />
<h2 id="module---flask-zappa-aws---making-an-api">MODULE - FLASK, ZAPPA, AWS - making an API</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>create basic api in flask</p>
<pre><code class="language-markdown">https://nordicapis.com/how-to-create-an-api-from-a-dataset-using-python-and-flask/
</code></pre>
<p>create basic api in flask, deploy to AWS with zappa and setup on Rapidapi</p>
<pre><code class="language-markdown">https://pythonforundergradengineers.com/deploy-serverless-web-app-aws-lambda-zappa.html#what-is-zappa
</code></pre>
<p>create basic api in flask, deploy to AWS with zappa and</p>
<pre><code class="language-markdown">https://towardsdatascience.com/develop-and-sell-a-python-api-from-start-to-end-tutorial-9a038e433966
</code></pre>
<p><br>Import the module</p>
<pre><code class="language-markdown">import flask
</code></pre>
<p>Creates a Flask application</p>
<pre><code class="language-markdown">app = flask.Flask(__name__)
</code></pre>
<p>Runs the program in debug mode (no reset necessary when changing a line of code)</p>
<pre><code class="language-markdown">app.config[&quot;DEBUG&quot;] = True
</code></pre>
<p>&quot;/&quot; indicates where the result in the url will output - GET will read data (POST for writing data)</p>
<pre><code class="language-markdown">@app.route('/', methods=['GET'])
</code></pre>
<p>Runs the application</p>
<pre><code class="language-markdown">app.run()
</code></pre>
<p><br>Outputs a List with a dict to the server / url</p>
<pre><code class="language-markdown">@app.route('/api/v1/resources/books/all', methods=['GET'])	# Data will available at: http://127.0.0.1:5000/api/v1/resources/books/all
def api_all():
    return jsonify(books)	    # Converts and returns the list in JSON-Flask-format
app.run()
# results are available under http://127.0.0.1:5000/api/v1/resources/books/all
</code></pre>
<p><br>Filtering data</p>
<pre><code class="language-markdown">@app.route('/api/v1/resources/books', methods=['GET'])
def api_id():
    if 'id' in request.args:					# Check if an ID was provided as part of the URL
        id = int(request.args['id'])			# If ID is provided, assign it to a variable
    else: return &quot;Error: No id field provided&quot;	# If no ID is provided, display an error in the browser.
    for book in books:							# Loop through the data and match results that fit the requested ID
        if book['id'] == id: results.append(book)
    return jsonify(results)						# Use the jsonify function from Flask to convert our list of - Python dictionaries to the JSON format
app.run()
# results are available under http://127.0.0.1:5000/api/v1/resources/books?id=1
</code></pre>
<p><br>Check if API is called from the right access-place (like rapidapi.com)</p>
<pre><code class="language-markdown">(key is provided from the platform - eg. here from rapidapi.com)
    if &quot;e6e45ed0-55e5-11eb-963e-ffe9fcdce080&quot; not in request.headers:
        return &quot;Error: Wrong API-Call - use www.rapidapi.com for calling the API!&quot;
</code></pre>
<p><br>Using zappa and deploying to AWS (zappa is only working in a virtual environment)</p>
<pre><code class="language-markdown">pip install zappa											=&gt; Install module
=&gt; Create file and insert the credentials from AWS (creation see second link above)
create file credentials in &quot;%UserProfile%\.aws
	[default]
	aws_access_key_id = XXXXXXXXXXXXXXXXXXXXXXXXXX
	aws_secret_access_key = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
virtualenv xyz									# Create an virtual environment
xyz\Scripts\activate							# Activate virtual environment
go back to folder xyz and install all necessary modules with pip install
pip list										# Check if everything is installed in the folder
zappa init (when virutal environement is activated!)		# Create zappa_settings.json File (press return at any prompt)
    &quot;dev&quot;: {
		&quot;app_function&quot;: &quot;app.app&quot;,				# Name of the py-file
		&quot;aws_region&quot;: &quot;eu-central-1&quot;,			# Nearest aws-region
        &quot;profile_name&quot;: &quot;default&quot;,				# Same as in aws-credentials at &quot;%UserProfile%/.aws/credentials
        &quot;project_name&quot;: &quot;apicheck&quot;,
        &quot;runtime&quot;: &quot;python3.7&quot;,					# Automatic generated
        &quot;s3_bucket&quot;: &quot;zappa-gsoln7zyl&quot;			# Automatic generated
    }
pip freeze &gt; requirements.txt					# Create requirements.txt for all installed modules in the virtual environment
zappa deploy dev (when virutal environement is activated!)	# Deploy everything to AWS (when ended with link everything worked fine) (otherwise 502 error - often a module is missing)
	eg. https://xnujiyxsb1.execute-api.eu-central-1.amazonaws.com/dev/api/v1/incstat?ticker=FB
		https://xnujiyxsb1.execute-api.eu-central-1.amazonaws.com/dev/api/v1/summary?ticker=CAT
		https://xnujiyxsb1.execute-api.eu-central-1.amazonaws.com/dev/api/v1/profile?ticker=FB
zappa update dev (when virutal environement is activated! and actual directory is correct where the py-file is!)	# Update deployment on AWS (when something changed in the pyhton-program)
zappa status									# Show actual status
zappa tail										# Show actual loggin (in error cases)
zappa undeploy dev								# Undeploy everything on AWS
</code></pre>
<p><br>AWS part</p>
<pre><code class="language-markdown">see the APIs under AWS Api Geteway =&gt; region on the upper right site has to be the same as in the zappa_settings.json file#
check API-access
	select API (under API Gateway and APIs)
	click on second ANY link
	click Test (on the left side)
	select Method Get
	input path example under {proxy} eg. api/v1/incstat?ticker=FB
	click Test Button (at the bottom)
</code></pre>
<hr />
<h2 id="module---flask-heroku-gunicorn----making-an-api">MODULE - FLASK, heroku, GUNICORN  - making an API</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://stackabuse.com/deploying-a-flask-application-to-heroku/">https://stackabuse.com/deploying-a-flask-application-to-heroku/</a></p>
<p>ongoing deployment / update</p>
<pre><code class="language-markdown">git init (when .git is not in the folder of the api)
git add .
git commit -m &quot;upd&quot;
heroku login -i
heroku git:remote -a financerapidapi (name of the app on heroku)
git push heroku main
</code></pre>
<hr />
<h2 id="module---fastpi-uvicorn---making-an-app">MODULE - FASTPI, UVICORN - making an app</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://www.youtube.com/watch?v=OFnOEIyqSRg&amp;list=PLvzuUVysUFOuoRna8KhschkVVUo2E2g6G">https://www.youtube.com/watch?v=OFnOEIyqSRg&amp;list=PLvzuUVysUFOuoRna8KhschkVVUo2E2g6G</a>
see Python-Diverse - TradingApp<br>
import module</p>
<pre><code class="language-markdown">from fastapi import FastAPI
</code></pre>
<p>start reloading app (refreshed automatically)</p>
<pre><code class="language-markdown">uvicorn main:app --reload
</code></pre>
<p>for rendering the html-page</p>
<pre><code class="language-markdown">jinja2 templates
</code></pre>
<p><a href="https://fastapi.tiangolo.com/advanced/templates/">https://fastapi.tiangolo.com/advanced/templates/</a>
<br>framework for formatting (like bootstrap)</p>
<pre><code class="language-markdown">semantic-ui.com
</code></pre>
<p><a href="https://semantic-ui.com/introduction/advanced-usage">https://semantic-ui.com/introduction/advanced-usage</a>
<br>for html-templates which can be used in several other html-files</p>
<pre><code class="language-markdown">layouts.html
</code></pre>
<p><a href="https://www.tradingview.com/widget/advanced-chart/">https://www.tradingview.com/widget/advanced-chart/</a>
<br>for interactive candlebars on the webpage</p>
<pre><code class="language-markdown">javascript-code
</code></pre>
<p><br>simplest route</p>
<pre><code class="language-markdown">app = FastAPI()
@app.get(&quot;/&quot;)
def index():
  return {&quot;message&quot;: &quot;hello world!&quot;}
</code></pre>
<hr />
<h2 id="module---icecream---print-for-debugging">MODULE - ICECREAM - print for debugging</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Imort icecream</p>
<pre><code class="language-markdown">from icecream import ic
</code></pre>
<p>Show value of the variable in the form: ic| var1: 20</p>
<pre><code class="language-markdown">ic(var1)
</code></pre>
<p>Show when command is reached: ic| icecream_example.py:5 in func() at 01:44:20.394 (line / file / time)</p>
<pre><code class="language-markdown">ic()
</code></pre>
<p>Set Context Output ⇒ also shows line / file / time</p>
<pre><code class="language-markdown">ic.configureOutput(includeContext=True)
</code></pre>
<hr />
<h2 id="module---ta-lib---technical-analysis-of-financial-market">MODULE - TA-LIB - technical analysis of financial market</h2>
<p><a href="#python">jump to top...</a><br><br>
Documentation: <a href="https://mrjbq7.github.io/ta-lib/">https://mrjbq7.github.io/ta-lib/</a></p>
<p><br>Installation</p>
<pre><code class="language-markdown">Download whl file from here: https://www.lfd.uci.edu/~gohlke/pythonlibs/#ta-lib
(with corresponding python version (eg. cp39) and os (eg. adm64)
then: pip install *.whl (eg. pip install TA_Lib-0.4.19-cp39-cp39-win_amd64.whl)
then: pip install TA-Lib
</code></pre>
<hr />
<h2 id="module---yfinance---date-from-yahoo-finance">MODULE - YFINANCE - date from Yahoo Finance</h2>
<p><a href="#python">jump to top...</a><br><br>
Docu and examples: <a href="https://aroussi.com/post/python-yahoo-finance">https://aroussi.com/post/python-yahoo-finance</a><br>
Installation (yfinance as yf not working - problems with pyinstaller)</p>
<pre><code class="language-markdown">import yfinance
</code></pre>
<p>Read data for ticker yahoo finance ticker symbol</p>
<pre><code class="language-markdown">dataYF = yf.Ticker(ticker)
</code></pre>
<p>Summary info for stock / cryptopcoin</p>
<pre><code class="language-markdown">dataYF.info
</code></pre>
<p>Price data as dataframe from/to-date</p>
<pre><code class="language-markdown">yf.download(ticker,&quot;2020-01-01&quot;,&quot;2021-03-31))
</code></pre>
<p>Intraday price data as dataframe for 1 month and 60 minute interval</p>
<pre><code class="language-markdown">dataYF.history(period=&quot;1mo&quot;,interval=&quot;60m&quot;)
</code></pre>
<p>Intraday price data as dataframe for 1 day and 2 minute interval</p>
<pre><code class="language-markdown">dataYF.history(period=&quot;1d&quot;,interval=&quot;2m&quot;)
</code></pre>
<p>Financial data</p>
<pre><code class="language-markdown">dataYF.financials
</code></pre>
<p>Dividends (date and amount)</p>
<pre><code class="language-markdown">dataYF.dividends
</code></pre>
<p>Splits (date and split-factor)</p>
<pre><code class="language-markdown">dataYF.splits
</code></pre>
<p>Percent major holders</p>
<pre><code class="language-markdown">dataYF.major_holders
</code></pre>
<p>Biggest Insitutional holders</p>
<pre><code class="language-markdown">dataYF.institutional_holders
</code></pre>
<p>Balance Sheet Data</p>
<pre><code class="language-markdown">dataYF.balance_sheet
</code></pre>
<p>Cashflow Data</p>
<pre><code class="language-markdown">dataYF.cashflow
</code></pre>
<p>Earnings Data (Revenue, Income)</p>
<pre><code class="language-markdown">dataYF.earnings
</code></pre>
<p>Sustainability Informations (palm oile, military, adult, etc.)</p>
<pre><code class="language-markdown">dataYF.sustainability
</code></pre>
<p>Recommendations from different agencies</p>
<pre><code class="language-markdown">dataYF.recommendations
</code></pre>
<p>Calendar data</p>
<pre><code class="language-markdown">dataYF.calendar
</code></pre>
<p>ISIN-Number</p>
<pre><code class="language-markdown">dataYF.isin
</code></pre>
<hr />
<h2 id="module---plotly---data-visualization">MODULE - PLOTLY - data visualization</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>installation</p>
<pre><code class="language-markdown">pip install plotly
</code></pre>
<p>examples of graphing libraries</p>
<pre><code class="language-markdown">https://plotly.com/python/
</code></pre>
<p>see example for candlestick-chart</p>
<pre><code class="language-markdown">Python-Diverses / Plotly / example.py
</code></pre>
<hr />
<h2 id="module---django---framework-for-webdevelopment">MODULE - DJANGO - framework for webdevelopment</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Video Training</p>
<pre><code class="language-markdown">https://www.youtube.com/watch?v=F5mRW0jo-U4&amp;t=5043s
</code></pre>
<p>Example</p>
<pre><code class="language-markdown">C:\Users\Polzi\Documents\DEV\Python-Diverses\Django
</code></pre>
<p>installation</p>
<pre><code class="language-markdown">pip install django
</code></pre>
<p>create a blank django project</p>
<pre><code class="language-markdown">django-admin startproject pjName
</code></pre>
<p>run django server (start site on <a href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a>)</p>
<pre><code class="language-markdown">python manage.py runserver
</code></pre>
<p>settings.py in django-folder</p>
<pre><code class="language-markdown">  BASE_DIR =&gt; directory of the django-project
  SECRET_KEY =&gt; individual key from django-project
  DEBUG =&gt; should be set to False in production
  INSTALLED_APPS =&gt; componente / pieces of the django-project
  DATABASES =&gt; database of the django-project
</code></pre>
<p>python manage.py startapp products</p>
<pre><code class="language-markdown">  # create a new app / component
  models.py =&gt; create models and link to the database
  add &quot;products&quot; to INSTALLED_APPS in settings.py
</code></pre>
<p><br>create superuser (eg. for login to /admin app/component)</p>
<pre><code class="language-markdown">python manage.py createsuperuser
</code></pre>
<p>prepeare migrations (when anything changed in the apps)</p>
<pre><code class="language-markdown">python manage.py makemigrations
</code></pre>
<p>migrate all changes</p>
<pre><code class="language-markdown">python manage.py migrate
</code></pre>
<p>now products can created in the /admin-page</p>
<pre><code class="language-markdown">add this: from .models import Product in admin.py of the products app / component
</code></pre>
<p>open django-sheel (eg. create products from the shell )</p>
<pre><code class="language-markdown">python manage.py shell
</code></pre>
<p>overview builtins</p>
<pre><code class="language-markdown">https://docs.djangoproject.com/en/4.0/ref/templates/builtins/
</code></pre>
<p>include html in an html-page (navbar.html)</p>
<pre><code class="language-markdown">{% include &quot;navbar.html&quot; %}
</code></pre>
<p>extend html-page (base.html)</p>
<pre><code class="language-markdown">{% extends &quot;base.html&quot;  %}
</code></pre>
<p>replace this block content</p>
<pre><code class="language-markdown">{% block content %} xyz {% endblock %}
</code></pre>
<p>add 2 to the value</p>
<pre><code class="language-markdown">{{ x|add:&quot;2&quot; }}
</code></pre>
<p>if statement</p>
<pre><code class="language-markdown">{{ if x in lst }}
</code></pre>
<p>elif statement</p>
<pre><code class="language-markdown">{{ elif x == 3 }}
</code></pre>
<p>else statement</p>
<pre><code class="language-markdown">{{ else }}
</code></pre>
<p>close if statement</p>
<pre><code class="language-markdown">{{ end if }}
</code></pre>
<p>capitalize first letter</p>
<pre><code class="language-markdown">{{ x|capfirst }}
</code></pre>
<p>uppercase whole string</p>
<pre><code class="language-markdown">{{ x|upper }}
</code></pre>
<p>capitalize and upper the whole string</p>
<pre><code class="language-markdown">{{ x|capfirst|upper }}
</code></pre>
<p><br>add a new module / component</p>
<pre><code class="language-markdown">- python manage.py startapp products    # create &quot;products&quot; folder
- create class in models.py of the products-folder
- import and register at admin-site in admin.py of the products-folder
- add products to INSTALLED_APPs in settings.py of the project-folder
</code></pre>
<p><br>add a new website</p>
<pre><code class="language-markdown"># create &quot;pages&quot; folder
  - python manage.py startapp pages
# eg. function with HttpResponse to output html-code
# for that function import is necessary with &quot;from django.http import HttpResponse&quot;
  - add view in views.py of the pages-folder
- add pages to INSTALLED_APPS in settings.py of the project-folder
# import view with &quot;from pages.views import homeView&quot;
# set path with eg. &quot;path('', homeView, name=&quot;home&quot;)&quot;
  - add pages/view in urls.py fo the project-folder
</code></pre>
<p><br>request and show page/view</p>
<pre><code class="language-markdown"># in urls.py the requests are stored
  eg. path('contact/', contactView)
# and in the views.py is the html-code stored
  eg. def contactView(*args, **kwargs):
        return HttpResponse(&quot;&lt;h1&gt;Contacts!&lt;/h1&gt;&quot;)
</code></pre>
<p><br>using templates</p>
<pre><code class="language-markdown"># render the page in views.py
  eg. def contactView(request, *args, **kwargs):
        return render(request, &quot;contact.html&quot;, {})
# create a folder eg. &quot;templates&quot; and put all html-pages in it
  eg. about.html, contact.html, home.html
# change DIRS in TEMPLATES in settings.py
  eg. to 'DIRS': [os.path.join(BASE_DIR, &quot;templates&quot;)],
</code></pre>
<p><br>extends: template Inheritance</p>
<pre><code class="language-markdown"># create base-html
  eg. &lt;h1&gt;This is a navbar&lt;/h1&gt;
      {% block content %}
        replace me
      {% endblock %}
# inside the about-html
  eg. {% extends &quot;base.html&quot;  %}
      {% block content %}
        &lt;h1&gt;About&lt;/h1&gt;
        &lt;p&gt;This is a template&lt;/p&gt;
      {% endblock %}
# &quot;replace me&quot; will get replace by the info from about-html from the block content
</code></pre>
<p><br>include: something in html</p>
<pre><code class="language-markdown">{% include &quot;navbar.html&quot; %}
</code></pre>
<p><br>render data in html</p>
<pre><code class="language-markdown"># render html-page with dictionary
  define myContext as Dictionary
  myContext = {
    &quot;myText&quot;: &quot;This is about me&quot;,
    &quot;myNumber&quot;: 123,
    &quot;myList&quot;: [123, 4242, 12313]
  }
  eg. return render(request, &quot;about.html&quot;, myContext)
# access this dict in the html-page
  eg. {{ myText }}, {{ myNumber }}
</code></pre>
<p><br>for loop when rendering</p>
<pre><code class="language-markdown"># get myList from Dictionary in views.py
  {% for mySubItem in myList %}
    &lt;li&gt;{{ forloop.counter }} - {{ mySubItem }}&lt;/li&gt;
  {% endfor %}
</code></pre>
<hr />
<h2 id="dolt---databases-like-repos">DOLT - Databases like Repos</h2>
<p><a href="#python">jump to top...</a><br><br>
<a href="https://www.dolthub.com/blog/2020-02-03-dolt-and-dolthub-getting-started/">https://www.dolthub.com/blog/2020-02-03-dolt-and-dolthub-getting-started/</a>
Install on windows with msi-file from here: <a href="https://github.com/dolthub/dolt/releases">https://github.com/dolthub/dolt/releases</a>
<br>Config Mail</p>
<pre><code class="language-markdown">dolt config --global --add user.email YOU@DOMAIN.COM
</code></pre>
<p>Config Name</p>
<pre><code class="language-markdown">dolt config --global --add user.name &quot;YOUR NAME&quot;
</code></pre>
<p>Login and the key</p>
<pre><code class="language-markdown">dolt login
</code></pre>
<p>Clone DB-Repos</p>
<pre><code class="language-markdown">dolt clone dolthub/baseball-databank
</code></pre>
<p>Show tables in db</p>
<pre><code class="language-markdown">dolt ls
</code></pre>
<p>Read column description for table</p>
<pre><code class="language-markdown">dolt sql -q &quot;describe Salaries&quot;
</code></pre>
<p>Run some query on the table</p>
<pre><code class="language-markdown">dolt sql -q &quot;SELECT * FROM Salaries&quot;
</code></pre>
<p>Write query to table</p>
<pre><code class="language-markdown">dolt sql -r csv -q &quot;SELECT * FROM Salaries&quot; &gt; salary-hr.csv
</code></pre>
<hr />
<h2 id="pyinstaller-inno-setup-compiler---generate-python-programs-to-executables">PYINSTALLER, INNO SETUP COMPILER - generate python programs to executables</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>Installation</p>
<pre><code class="language-markdown">pip install pyinstaller
</code></pre>
<p>Generate the bundle in a subdirectory called dist.</p>
<pre><code class="language-markdown">pyinstaller prg.py
</code></pre>
<p>Generate only one file</p>
<pre><code class="language-markdown">pyinstaller --onefile prg.py
</code></pre>
<p>Generate only one file (to get for sure the pyinstaller from the actual env)</p>
<pre><code class="language-markdown">python -m pyinstaller --onefile prg.py
</code></pre>
<p>add this when some modules are not found</p>
<pre><code class="language-markdown">--copy-metadata pandas_ta
</code></pre>
<p>When some modules are making problems - sometimes this helps</p>
<pre><code class="language-markdown">--hidden-import=pymssql
</code></pre>
<p>when there is a depreciating warning from matlib</p>
<pre><code class="language-markdown">--exclude-module matplotlib
</code></pre>
<p>Generate file with icon</p>
<pre><code class="language-markdown">--icon=app.ico
</code></pre>
<p>Generating under mac os sometimes only work with this params</p>
<pre><code class="language-markdown">--hidden-import=pkg_resources.py2_warn
</code></pre>
<p>Generating under mac os sometimes only work with this params</p>
<pre><code class="language-markdown">--hidden-import=pkg_resources.py2_warn
</code></pre>
<p>Collect data for specific python module</p>
<pre><code class="language-markdown">--collect-data moduleXY
</code></pre>
<p><br>Open this file to start the python-program</p>
<pre><code class="language-markdown">prg.exe
</code></pre>
<p>only working with import yfinance (not with import yfinance as yf)</p>
<pre><code class="language-markdown">yfinance module
</code></pre>
<p><br>Problems with some added python modules (eg. pycountry)</p>
<pre><code class="language-markdown">https://groups.google.com/g/pyinstaller/c/OYhJdeZ9010/m/32g3-T8XBAAJ
Create hook-file hook-pycountry.py with content:
	from PyInstaller.utils.hooks import copy_metadata, collect_data_files
	datas = copy_metadata(&quot;pycountry&quot;) + collect_data_files(&quot;pycountry&quot;)
Compile Program with
	pyinstaller --onefile --exclude-module matplotlib --additional-hooks-dir=. TestPyCountry.py
</code></pre>
<p><br>Problems with path when executing from py and exe</p>
<pre><code class="language-markdown">config_name = 'creds.json'                                    # Define the config file name
</code></pre>
<p><br>Determine if application is a script file or frozen exe</p>
<pre><code class="language-markdown">if getattr(sys, 'frozen', False):                             # Get path when starting as executable
    application_path = os.path.dirname(sys.executable)
elif __file__:                                                # Get path when running from IDE as py-file
    application_path = os.path.dirname(__file__)
config_path = os.path.join(application_path, config_name)     # Final Config Path
</code></pre>
<p><br>Using Inno Setup Compiler for creating a setup.exe for all files</p>
<pre><code class="language-markdown">https://jrsoftware.org/isdl.php
- Application Information =&gt; provide application informations (appName, appVersion, publisher, website)
- Application Files =&gt; select application main executable file and add all necessary folder and files
- Application File Association =&gt; no selection
- Application Documentation =&gt; select files which should be shown before / after the installation
- Setup Languages =&gt; select which languages should be included during installation
- Save installation script
- Final setup.exe is stored in the &quot;Output&quot;-folder
</code></pre>
<hr />
<h2 id="pythonanywhere">PYTHONANYWHERE</h2>
<p><a href="#python">jump to top...</a><br><br>
<br>install python modules in specific version / environment</p>
<pre><code class="language-markdown">pip3.7 install --user --upgrade selenium
</code></pre>
<hr />
<h2 id="heroku---run-python-scripts-in-the-cloud">HEROKU - run python scripts in the cloud</h2>
<p><a href="#python">jump to top...</a><br><br>
Instruction: <a href="https://dev.to/josylad/how-to-deploy-a-python-script-or-bot-to-heroku-in-5-minutes-9dp">https://dev.to/josylad/how-to-deploy-a-python-script-or-bot-to-heroku-in-5-minutes-9dp</a>
<br>New ⇒ Create new app ⇒ give name with only lowercases</p>
<pre><code class="language-markdown">on Heroku: create App
</code></pre>
<p>Setting ⇒ Add buildpack ⇒ choose python</p>
<pre><code class="language-markdown">on Heroku: set python build path
</code></pre>
<p>Create Procfile with 2 lines ⇒ web: python appname.py, worker: python appname.py</p>
<pre><code class="language-markdown">in App-folder: create Procfile
</code></pre>
<p>Create or Copy the requirements.txt ⇒ eg. pip freeze&gt; requirements.txt</p>
<pre><code class="language-markdown">in App-folder: create requirements.txt
</code></pre>
<p>when there is not git-structure yet</p>
<pre><code class="language-markdown">in App-folder: git init
</code></pre>
<p>like xlwings, openpyxl, pywin32</p>
<pre><code class="language-markdown">delete not possible modules	in cloud
</code></pre>
<p>login to heroku (login page opens in the browser)</p>
<pre><code class="language-markdown">heroku login
</code></pre>
<p>connect to the heroku app</p>
<pre><code class="language-markdown">heroku git:remote -a HEROKU_APP_NAME
</code></pre>
<p>add files (like in git)</p>
<pre><code class="language-markdown">git add .
</code></pre>
<p>commit files (like in git</p>
<pre><code class="language-markdown">git commit -am &quot;msg&quot;
</code></pre>
<p>push the files to heroku for build (try master instead of main when not working)</p>
<pre><code class="language-markdown">git push heroku main
</code></pre>
<p>in Resources deselect both (otherwise the program will run more times per day)</p>
<pre><code class="language-markdown">on Heroku: deselect web + worker
</code></pre>
<p>Heroku Scheduler for scheduling the app, Papertrail for logs</p>
<pre><code class="language-markdown">on Heroku: add Add-ons
</code></pre>
<p>Schedule the app run times</p>
<pre><code class="language-markdown">on Heroku / Scheduler
</code></pre>
<p>Show which dynos are running currently</p>
<pre><code class="language-markdown">heroku ps -a appName
</code></pre>
<p>run the app / script which is hosted on heroku (only possible when no dyno is running)</p>
<pre><code class="language-markdown">heroku run -a &lt;appName&gt; python &lt;prg.py&gt;
</code></pre>
<p>see all running dynos</p>
<pre><code class="language-markdown">heroku ps -a &lt;appName&gt;
</code></pre>
<p>stop the running dyno with name &quot;scheduler.6436&quot;</p>
<pre><code class="language-markdown">heroku ps:stop scheduler.6436 -a &lt;appN&gt;
</code></pre>
<p><br>using TA-Lib on heroku</p>
<pre><code class="language-markdown">remove TA-Lib from requirtements.text
Described here: https://stackoverflow.com/questions/43453953/how-to-install-python-library-in-heroku
GitDoku: https://github.com/numrut/heroku-buildpack-python-talib
use this commands instead:
heroku buildpacks:add --index 1 heroku/python
heroku buildpacks:add --index 2 numrut/ta-lib
schedule the running time with addon Heroku Scheduler
</code></pre>
